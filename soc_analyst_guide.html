<!-- ********************************************************************** -->
<!--                                                                        -->
<!--  soc_analyst_guide.html                            TTTTTTTT SSSSSSS II -->
<!--                                                       TT    SS      II -->
<!--  By: st93642@students.tsi.lv                          TT    SSSSSSS II -->
<!--                                                       TT         SS II -->
<!--  Created: Jan 26 2026 21:06 st93642                   TT    SSSSSSS II -->
<!--  Updated: Jan 29 2026 10:22 st93642                                    -->
<!--                                                                        -->
<!--   Transport and Telecommunication Institute - Riga, Latvia             -->
<!--                       https://tsi.lv                                   -->
<!-- ********************************************************************** -->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOC Analyst Guide - SIEM and Log Analysis Cheatsheet</title>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --success-color: #2ecc71;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --text-color: #333;
            --text-light: #fff;
            --code-bg: #282c34;
            --code-text: #abb2bf;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            overflow: visible;
        }

        .header {
            background: linear-gradient(135deg, var(--dark-color) 0%, var(--secondary-color) 100%);
            color: var(--text-light);
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .layout {
            display: flex;
            min-height: 100%;
        }

        .sidebar-toggle {
            display: none;
            background: var(--primary-color);
            color: var(--text-light);
            border: none;
            padding: 12px 16px;
            margin: 0;
            width: 100%;
            font-size: 16px;
            cursor: pointer;
        }

        .sidebar {
            width: 240px;
            background-color: var(--light-color);
            padding: 20px;
            border-right: 3px solid var(--primary-color);
            position: sticky;
            top: 20px;
            align-self: flex-start;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
            z-index: 100;
        }

        .navigation {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .nav-btn {
            padding: 10px 16px;
            background-color: var(--primary-color);
            color: var(--text-light);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 15px;
            transition: all 0.3s;
            text-decoration: none;
            display: block;
            text-align: left;
            position: relative;
        }

        .nav-btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .nav-btn.active {
            background-color: var(--success-color);
            font-weight: bold;
            box-shadow: 0 3px 10px rgba(46, 204, 113, 0.4);
        }

        .nav-btn.active::before {
            content: '‚ñ∂';
            position: absolute;
            left: 5px;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        .content {
            padding: 40px;
            flex: 1;
        }

        .section {
            margin-bottom: 50px;
            padding: 30px;
            background-color: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid var(--primary-color);
        }

        .section h2 {
            color: var(--dark-color);
            margin-bottom: 20px;
            font-size: 2em;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }

        .section h3 {
            color: var(--secondary-color);
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .section h4 {
            color: var(--text-color);
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .section p {
            margin-bottom: 15px;
            line-height: 1.8;
        }

        .query-box {
            background-color: var(--code-bg);
            color: var(--code-text);
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
            overflow-x: auto;
            border-left: 4px solid var(--success-color);
        }

        .query-box code {
            color: var(--code-text);
            display: block;
            white-space: pre-wrap;
        }

        .description {
            background-color: #e8f4f8;
            padding: 10px 15px;
            border-radius: 5px;
            margin-bottom: 10px;
            border-left: 3px solid var(--primary-color);
        }

        .tip {
            background-color: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid var(--warning-color);
        }

        .tip strong {
            color: var(--warning-color);
        }

        .important {
            background-color: #f8d7da;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid var(--danger-color);
        }

        .important strong {
            color: var(--danger-color);
        }

        ul, ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .table-container {
            overflow-x: auto;
            margin: 20px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        th {
            background-color: var(--primary-color);
            color: var(--text-light);
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #ddd;
        }

        tr:hover {
            background-color: #f5f5f5;
        }

        .footer {
            background-color: var(--dark-color);
            color: var(--text-light);
            padding: 20px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .content {
                padding: 20px;
            }

            .section {
                padding: 20px;
            }

            .layout {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                display: none;
                border-right: none;
                border-bottom: 3px solid var(--primary-color);
                position: static;
                max-height: none;
            }

            .sidebar.open {
                display: block;
            }

            .sidebar-toggle {
                display: block;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è SOC Analyst Guide</h1>
            <p>SIEM Query Cheatsheets & Log Analysis Guide</p>
        </div>

        <div class="layout">
            <button class="sidebar-toggle" onclick="document.querySelector('.sidebar').classList.toggle('open')">‚ò∞ Menu</button>
            <div class="sidebar">
                <div class="navigation">
                    <a href="#intro" class="nav-btn">Introduction</a>
                    <a href="#career-path" class="nav-btn">SOC Career Path</a>
                    <a href="#job-hunting" class="nav-btn">Job Hunting & Interviews</a>
                    <a href="#soc-roles" class="nav-btn">SOC Roles Deep Dive</a>
                    <a href="#splunk" class="nav-btn">Splunk Queries</a>
                    <a href="#elastic" class="nav-btn">Elastic Queries</a>
                    <a href="#sentinel" class="nav-btn">Microsoft Sentinel</a>
                    <a href="#cloud-security" class="nav-btn">Cloud Security</a>
                    <a href="#soc-automation" class="nav-btn">SOC Automation & SOAR</a>
                    <a href="#ai-for-soc" class="nav-btn">AI & ChatGPT for SOC</a>
                    <a href="#linux" class="nav-btn">Linux Log Analysis</a>
                    <a href="#detection-engineering" class="nav-btn">Detection Engineering</a>
                    <a href="#intrusion-detection" class="nav-btn">Intrusion Detection</a>
                    <a href="#incident-response" class="nav-btn">Incident Response</a>
                    <a href="#threat-hunting" class="nav-btn">Threat Hunting</a>
                    <a href="#tools-techniques" class="nav-btn">Tools & Techniques</a>
                    <a href="#career-development" class="nav-btn">Career Development</a>
                    <a href="#best-practices" class="nav-btn">Best Practices</a>
                </div>
            </div>

            <div class="content">
            <!-- Introduction Section -->
            <div id="intro" class="section">
                <h2>üìñ Introduction</h2>
                
                <h3>What is a Security Operations Center (SOC)?</h3>
                <p>A Security Operations Center (SOC) is a centralized unit within an organization that employs people, processes, and technology to continuously monitor, detect, analyze, and respond to cybersecurity incidents. SOC analysts serve as the first line of defense against cyber threats, utilizing Security Information and Event Management (SIEM) systems as their primary investigative tool.</p>
                
                <h3>The Role of SIEM in Security Operations</h3>
                <p>SIEM systems aggregate and correlate log data from diverse sources across an organization's IT infrastructure, including:</p>
                <ul>
                    <li><strong>Network devices:</strong> Firewalls, routers, switches, intrusion detection/prevention systems (IDS/IPS)</li>
                    <li><strong>Endpoints:</strong> Workstations, servers, mobile devices with security agents</li>
                    <li><strong>Applications:</strong> Web servers, databases, custom business applications</li>
                    <li><strong>Security tools:</strong> Antivirus, endpoint detection and response (EDR), data loss prevention (DLP)</li>
                    <li><strong>Cloud services:</strong> AWS CloudTrail, Azure Activity Logs, Google Cloud Audit Logs</li>
                </ul>
                <p>By normalizing and indexing this data, SIEM platforms enable real-time security monitoring, historical analysis, and compliance reporting through sophisticated query languages and correlation rules.</p>
                
                <h3>Fundamental Concepts in Log Analysis</h3>
                <h4>Log Structure and Parsing</h4>
                <p>Logs are structured or semi-structured records of events that occur within systems. Understanding log anatomy is critical:</p>
                <ul>
                    <li><strong>Timestamp:</strong> When the event occurred (essential for temporal correlation)</li>
                    <li><strong>Source:</strong> Which system or component generated the event</li>
                    <li><strong>Event Type/Code:</strong> Classification of the event (e.g., Windows Event ID 4625 for failed logon)</li>
                    <li><strong>Severity Level:</strong> Importance indicator (informational, warning, error, critical)</li>
                    <li><strong>Message/Details:</strong> Descriptive information about the event</li>
                    <li><strong>Contextual Fields:</strong> User, IP address, process name, file path, etc.</li>
                </ul>
                
                <h4>The Cybersecurity Kill Chain</h4>
                <p>SOC analysts use frameworks like the Cyber Kill Chain to understand attack progression:</p>
                <ol>
                    <li><strong>Reconnaissance:</strong> Attacker gathers information about the target</li>
                    <li><strong>Weaponization:</strong> Creation of malicious payload</li>
                    <li><strong>Delivery:</strong> Transmission of weapon to target (email, web, USB)</li>
                    <li><strong>Exploitation:</strong> Execution of code on victim system</li>
                    <li><strong>Installation:</strong> Persistence mechanism establishment</li>
                    <li><strong>Command & Control (C2):</strong> Remote access channel establishment</li>
                    <li><strong>Actions on Objectives:</strong> Data exfiltration, destruction, or other malicious activities</li>
                </ol>
                <p>Each phase generates distinct log signatures that analysts can detect through SIEM queries.</p>
                
                <h3>Query Language Paradigms</h3>
                <p>Different SIEM platforms employ distinct query languages optimized for their underlying data storage:</p>
                <ul>
                    <li><strong>Splunk SPL (Search Processing Language):</strong> Pipeline-based language using the pipe operator (|) to chain search commands</li>
                    <li><strong>Elastic KQL/Lucene:</strong> Kibana Query Language for simple searches, Lucene syntax for complex queries, and DSL for advanced aggregations</li>
                    <li><strong>Microsoft Sentinel KQL (Kusto Query Language):</strong> Declarative language similar to SQL, optimized for Azure Data Explorer backend</li>
                </ul>
                <p>While syntax varies, the analytical approach remains consistent: filter, aggregate, correlate, and visualize security events to identify anomalous behavior.</p>
                
                <h3>How to Use This Guide</h3>
                <p>This comprehensive guide is structured to support both learning and operational reference:</p>
                <ol>
                    <li><strong>Understand the Theory:</strong> Each section begins with conceptual foundations before presenting practical queries</li>
                    <li><strong>Start with the Incident Flow:</strong> Use your SIEM (Splunk/Elastic/Sentinel) to triage alerts according to established playbooks</li>
                    <li><strong>Apply Platform-Specific Queries:</strong> Leverage the detailed query examples to validate and enrich findings during investigations</li>
                    <li><strong>Correlate with System-Level Analysis:</strong> Use Linux terminal commands for deeper visibility when SIEM data alone is insufficient</li>
                    <li><strong>Follow Best Practices:</strong> Apply the methodology section for systematic documentation, tuning, and post-incident activities</li>
                    <li><strong>Adapt and Customize:</strong> Modify queries to fit your organization's specific data sources, naming conventions, and use cases</li>
                </ol>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Academic Context:</strong> This guide bridges theoretical security concepts with practical implementation. Each query is accompanied by its underlying detection logic, potential false positives, and evasion considerations. Understanding the "why" behind each query is as important as knowing the "how."
                </div>
                
                <div class="tip">
                    <strong>üí° Learning Tip:</strong> For maximum benefit, practice these queries in a controlled lab environment before deploying in production. Consider using datasets like Security Onion, BOTS (Boss of the SOC), or custom test data to develop proficiency without impacting live security monitoring.
                </div>
            </div>

            <!-- SOC Career Path Section -->
            <div id="career-path" class="section">
                <h2>üéØ SOC Analyst Career Path</h2>
                
                <h3>The SOC Career Outlook</h3>
                <p>The cybersecurity field continues to experience unprecedented growth, with the SOC analyst role serving as a critical entry point into the security profession. According to industry projections, cybersecurity jobs are expected to grow significantly faster than most other occupations, with hundreds of thousands of positions remaining unfilled annually.</p>
                
                <h3>SOC Career Trajectory</h3>
                <p>A typical career progression in Security Operations follows this path:</p>
                
                <h4>Entry Level: SOC Analyst (Tier 1)</h4>
                <ul>
                    <li><strong>Primary Responsibilities:</strong> Alert triage, initial incident investigation, basic log analysis, documentation</li>
                    <li><strong>Required Skills:</strong> Basic networking knowledge, log analysis fundamentals, SIEM query basics</li>
                    <li><strong>Typical Salary Range:</strong> $50,000 - $75,000 (varies by location and organization)</li>
                    <li><strong>Time in Role:</strong> 1-2 years before promotion consideration</li>
                    <li><strong>Key Success Factors:</strong> Attention to detail, documentation quality, ability to follow playbooks, asking good questions</li>
                </ul>
                
                <h4>Mid Level: Senior SOC Analyst (Tier 2)</h4>
                <ul>
                    <li><strong>Primary Responsibilities:</strong> Complex incident investigation, playbook development, mentoring Tier 1 analysts, escalation handling</li>
                    <li><strong>Required Skills:</strong> Advanced log correlation, understanding of attack frameworks (MITRE ATT&CK), threat intelligence analysis</li>
                    <li><strong>Typical Salary Range:</strong> $75,000 - $100,000</li>
                    <li><strong>Time in Role:</strong> 2-4 years before advancing to specialized roles</li>
                    <li><strong>Key Success Factors:</strong> Deep technical knowledge, independent problem solving, effective communication with stakeholders</li>
                </ul>
                
                <h4>Advanced Specializations</h4>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Role</th>
                                <th>Focus Area</th>
                                <th>Salary Range</th>
                                <th>Key Skills</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Incident Responder (Tier 3)</strong></td>
                                <td>Active threat containment and remediation</td>
                                <td>$100,000 - $140,000</td>
                                <td>Forensics, malware analysis, emergency response coordination</td>
                            </tr>
                            <tr>
                                <td><strong>Threat Hunter</strong></td>
                                <td>Proactive threat discovery</td>
                                <td>$100,000 - $145,000</td>
                                <td>Hypothesis development, advanced analytics, threat intelligence</td>
                            </tr>
                            <tr>
                                <td><strong>SOC Engineer</strong></td>
                                <td>SIEM/security tool optimization</td>
                                <td>$95,000 - $135,000</td>
                                <td>Scripting (Python, PowerShell), detection engineering, architecture design</td>
                            </tr>
                            <tr>
                                <td><strong>SOC Manager</strong></td>
                                <td>Team leadership and operations</td>
                                <td>$110,000 - $160,000</td>
                                <td>People management, metrics reporting, budget management, vendor relations</td>
                            </tr>
                            <tr>
                                <td><strong>Detection Engineer</strong></td>
                                <td>Custom detection logic creation</td>
                                <td>$105,000 - $150,000</td>
                                <td>Advanced SIEM queries, SOAR automation, false positive reduction</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>Essential Certifications for SOC Analysts</h3>
                <h4>Entry-Level Certifications</h4>
                <ul>
                    <li><strong>CompTIA Security+:</strong> Foundation-level security knowledge, highly recognized entry certification</li>
                    <li><strong>CompTIA CySA+ (Cybersecurity Analyst):</strong> Focuses specifically on security analytics and threat detection</li>
                    <li><strong>GIAC Security Essentials (GSEC):</strong> Broad security knowledge covering hands-on defensive techniques</li>
                    <li><strong>Splunk Core Certified User:</strong> Platform-specific knowledge for Splunk SIEM</li>
                </ul>
                
                <h4>Advanced Certifications</h4>
                <ul>
                    <li><strong>GIAC Certified Intrusion Analyst (GCIA):</strong> Deep dive into network traffic analysis and intrusion detection</li>
                    <li><strong>GIAC Certified Incident Handler (GCIH):</strong> Comprehensive incident response methodology</li>
                    <li><strong>Certified Information Systems Security Professional (CISSP):</strong> Industry gold standard for senior security professionals</li>
                    <li><strong>GIAC Certified Forensic Analyst (GCFA):</strong> Digital forensics and advanced incident response</li>
                    <li><strong>Offensive Security Certified Professional (OSCP):</strong> Valuable for understanding attacker mindset</li>
                    <li><strong>Certified Information Security Manager (CISM):</strong> For those moving into management roles</li>
                </ul>
                
                <h4>Cloud and Specialized Certifications</h4>
                <ul>
                    <li><strong>AWS Certified Security - Specialty:</strong> Cloud security for AWS environments</li>
                    <li><strong>Microsoft Certified: Azure Security Engineer Associate:</strong> Azure-focused security</li>
                    <li><strong>CrowdStrike Certified Falcon Administrator (CCFA):</strong> EDR platform expertise</li>
                    <li><strong>Splunk Enterprise Security Certified Admin:</strong> Advanced SIEM administration</li>
                </ul>
                
                <h3>Building Your SOC Career: Practical Steps</h3>
                
                <h4>1. Establish a Strong Foundation</h4>
                <ul>
                    <li><strong>Learn Networking Fundamentals:</strong> Understand TCP/IP, OSI model, common protocols (HTTP/HTTPS, DNS, SMB, RDP)</li>
                    <li><strong>Master Operating Systems:</strong> Gain proficiency in Windows (Event Logs, PowerShell), Linux (syslog, bash scripting), and basic macOS</li>
                    <li><strong>Understand Security Concepts:</strong> CIA triad, authentication vs authorization, encryption basics, common attack vectors</li>
                    <li><strong>Get Hands-On:</strong> Build a home lab using VirtualBox/VMware, deploy Security Onion or Splunk, practice with vulnerable VMs</li>
                </ul>
                
                <h4>2. Develop Technical Proficiency</h4>
                <ul>
                    <li><strong>SIEM Mastery:</strong> Learn SPL (Splunk), KQL (Azure Sentinel), or Lucene/DSL (Elastic). Practice query writing daily</li>
                    <li><strong>Scripting Skills:</strong> Python for automation, PowerShell for Windows administration, Bash for Linux operations</li>
                    <li><strong>Log Analysis:</strong> Learn to parse and interpret logs from firewalls, web servers, endpoints, and cloud services</li>
                    <li><strong>Threat Intelligence:</strong> Understand IOCs (IPs, domains, hashes), MITRE ATT&CK framework, threat actor TTPs</li>
                </ul>
                
                <h4>3. Gain Practical Experience</h4>
                <ul>
                    <li><strong>CTF Competitions:</strong> Participate in Boss of the SOC (BOTS), CyberDefenders, TryHackMe, HackTheBox</li>
                    <li><strong>Home Lab Projects:</strong> Set up Active Directory, simulate attacks with Kali Linux, practice detection and response</li>
                    <li><strong>Internships:</strong> Seek SOC internships, even unpaid opportunities provide invaluable real-world experience</li>
                    <li><strong>Open Source Contribution:</strong> Contribute to Sigma rules repository, Security Onion community, MISP threat intelligence</li>
                </ul>
                
                <h4>4. Professional Networking</h4>
                <ul>
                    <li><strong>LinkedIn Presence:</strong> Maintain an active profile showcasing projects, certifications, and learnings</li>
                    <li><strong>Attend Conferences:</strong> BSides events (low cost), SANS conferences, RSA, Black Hat (or follow virtually)</li>
                    <li><strong>Join Communities:</strong> Reddit (r/cybersecurity, r/AskNetsec), Discord servers, local cybersecurity meetups</li>
                    <li><strong>Mentorship:</strong> Find mentors through LinkedIn, professional organizations, or alumni networks</li>
                </ul>
                
                <h4>5. Resume and Interview Preparation</h4>
                <ul>
                    <li><strong>Resume Optimization:</strong> Use Applicant Tracking System (ATS)-friendly format, include keywords from job descriptions</li>
                    <li><strong>Quantify Achievements:</strong> "Analyzed 500+ security alerts weekly" vs "Performed alert triage"</li>
                    <li><strong>Showcase Projects:</strong> GitHub portfolio, personal security blog, documented lab projects</li>
                    <li><strong>Technical Interview Prep:</strong> Practice explaining SIEM queries, incident response scenarios, threat analysis</li>
                    <li><strong>Behavioral Questions:</strong> Prepare STAR method responses (Situation, Task, Action, Result)</li>
                </ul>
                
                <h3>Alternative Entry Paths into SOC</h3>
                <ul>
                    <li><strong>IT Support/Help Desk:</strong> Transition from IT support by obtaining Security+ and demonstrating security interest</li>
                    <li><strong>Network Administration:</strong> Leverage networking knowledge to move into security monitoring</li>
                    <li><strong>Military/Government:</strong> Military cybersecurity roles (25D, 1B4X1) provide excellent training and clearance</li>
                    <li><strong>Career Pivot:</strong> Professionals from any field can transition through bootcamps, self-study, and certifications</li>
                    <li><strong>Academic Path:</strong> Degree in cybersecurity, computer science, or related field with security focus</li>
                </ul>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Reality Check:</strong> Breaking into SOC analysis is competitive but achievable. Most entry-level positions require 0-2 years of experience and 1-2 certifications (Security+, CySA+). Focus on demonstrable skills through labs, CTFs, and projects rather than collecting certifications without practical application. Persistence is key‚Äîexpect to apply to 50-100+ positions.
                </div>
                
                <div class="tip">
                    <strong>üí° Career Tip:</strong> The SOC operates 24/7/365. Be prepared for shift work, including nights, weekends, and holidays, especially in entry-level roles. Many organizations offer shift differential pay. After 1-2 years, opportunities for day shift or remote work typically increase.
                </div>
            </div>

            <!-- Job Hunting & Interview Preparation Section -->
            <div id="job-hunting" class="section">
                <h2>üíº Job Hunting & Interview Preparation</h2>
                
                <h3>Networking and Professional Connections</h3>
                <p>Building a strong professional network is crucial for finding opportunities in cybersecurity. Word of mouth and personal connections often lead to job opportunities before they're publicly posted.</p>
                
                <h4>Conferences and Meetups</h4>
                <ul>
                    <li><strong>DEF CON:</strong> The premier hacking conference held annually in Las Vegas. Recruiters actively seek talent here. Consider volunteering to meet more people and make deeper connections. DEF CON Groups meet monthly in local areas.</li>
                    <li><strong>BSides:</strong> Community-driven security conferences held in many cities. Tickets are affordable or free for volunteers, providing excellent networking opportunities.</li>
                    <li><strong>2600 Meetings:</strong> Hacker culture meetups with deep roots in the community. These gatherings offer insights into hacker culture and networking with like-minded individuals.</li>
                    <li><strong>OWASP Chapters:</strong> Open Web Application Security Project hosts local chapters worldwide focused on improving software security.</li>
                    <li><strong>Hackerspaces/Makerspaces:</strong> Local meetups for tinkering, learning, and building presentation skills in a show-and-tell format.</li>
                </ul>
                
                <div class="tip">
                    <strong>üí° Networking Tip:</strong> Always bring a notepad to write down contact information. Follow up within 24 hours after meeting someone new. Share your resume and express interest in staying connected.
                </div>
                
                <h3>Resume and Application Strategy</h3>
                
                <h4>Resume Best Practices for SOC Analysts</h4>
                <ul>
                    <li><strong>Format:</strong> Keep it to 1-2 pages maximum. Use a clean, professional template with consistent formatting.</li>
                    <li><strong>Skills Section:</strong> List relevant technologies (SIEM platforms, EDR tools, scripting languages) prominently near the top.</li>
                    <li><strong>Quantify Achievements:</strong> Instead of "Investigated security alerts," write "Triaged 50+ daily security alerts with 95% accuracy in threat classification."</li>
                    <li><strong>Projects and Labs:</strong> Include hands-on projects like CTF competitions, home lab setups, or contributions to open-source security projects.</li>
                    <li><strong>Certifications:</strong> List relevant certifications (Security+, CySA+, CEH) in a dedicated section.</li>
                    <li><strong>Tailor for Each Job:</strong> Customize your resume for each application by incorporating keywords from the job description.</li>
                </ul>
                
                <h4>Common SOC Analyst Job Titles</h4>
                <ul>
                    <li>Security Analyst</li>
                    <li>SOC Analyst (Tier 1/2/3)</li>
                    <li>Cybersecurity Analyst</li>
                    <li>Information Security Analyst</li>
                    <li>Threat Detection Analyst</li>
                    <li>Incident Response Analyst</li>
                    <li>Security Operations Analyst</li>
                </ul>
                
                <h3>Job Search Resources</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Platform</th>
                                <th>Focus</th>
                                <th>Best For</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>LinkedIn</td>
                                <td>Professional networking</td>
                                <td>Building connections, recruiter outreach</td>
                            </tr>
                            <tr>
                                <td>Indeed</td>
                                <td>Job aggregator</td>
                                <td>Wide range of positions, salary information</td>
                            </tr>
                            <tr>
                                <td>Dice</td>
                                <td>Tech-focused</td>
                                <td>IT and cybersecurity specific roles</td>
                            </tr>
                            <tr>
                                <td>CyberSecJobs.com</td>
                                <td>Cybersecurity only</td>
                                <td>Specialized security positions</td>
                            </tr>
                            <tr>
                                <td>ClearanceJobs.com</td>
                                <td>Government/cleared positions</td>
                                <td>Defense contractors, government agencies</td>
                            </tr>
                            <tr>
                                <td>Company Career Pages</td>
                                <td>Direct applications</td>
                                <td>Applying directly to desired companies</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>Interview Preparation</h3>
                
                <h4>Common Technical Questions</h4>
                <ul>
                    <li><strong>What is the difference between a vulnerability and an exploit?</strong><br>
                    A vulnerability is a weakness in a system that could be exploited. An exploit is the actual code or technique used to take advantage of that vulnerability.</li>
                    
                    <li><strong>Explain the CIA Triad.</strong><br>
                    Confidentiality (protecting data from unauthorized access), Integrity (ensuring data accuracy and trustworthiness), and Availability (ensuring systems and data are accessible when needed).</li>
                    
                    <li><strong>What is the difference between IDS and IPS?</strong><br>
                    IDS (Intrusion Detection System) monitors and alerts on suspicious activity. IPS (Intrusion Prevention System) can actively block or prevent detected threats.</li>
                    
                    <li><strong>Walk me through how you would investigate a phishing email.</strong><br>
                    Check sender authenticity, analyze email headers, examine links/attachments safely, check for similar emails to other users, determine if any users clicked/opened attachments, contain affected systems if compromised.</li>
                    
                    <li><strong>What is SIEM and why is it important?</strong><br>
                    Security Information and Event Management - centralized platform that collects, correlates, and analyzes security logs from across the environment to detect threats and support investigations.</li>
                    
                    <li><strong>Describe the steps of incident response.</strong><br>
                    Preparation, Identification, Containment, Eradication, Recovery, Lessons Learned (following NIST framework).</li>
                    
                    <li><strong>What ports are commonly targeted by attackers?</strong><br>
                    22 (SSH), 23 (Telnet), 80/443 (HTTP/HTTPS), 3389 (RDP), 445 (SMB), 1433 (SQL Server), 3306 (MySQL).</li>
                </ul>
                
                <h4>Behavioral Questions</h4>
                <ul>
                    <li><strong>Tell me about a time you had to learn a new technology quickly.</strong></li>
                    <li><strong>Describe a situation where you worked under pressure.</strong></li>
                    <li><strong>How do you stay current with cybersecurity trends?</strong></li>
                    <li><strong>Give an example of when you had to explain a technical concept to a non-technical person.</strong></li>
                    <li><strong>Tell me about a time you made a mistake and how you handled it.</strong></li>
                </ul>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Interview Tip:</strong> Use the STAR method (Situation, Task, Action, Result) when answering behavioral questions. Prepare 3-5 stories from your experience that demonstrate problem-solving, teamwork, and technical skills.
                </div>
                
                <h3>Application Volume and Persistence</h3>
                <p>Breaking into cybersecurity requires persistence. Expect to apply to 50-100+ positions. Don't be discouraged by rejections‚Äîthey're part of the process. Focus on:</p>
                <ul>
                    <li><strong>Quality Applications:</strong> Tailor each application rather than mass-applying.</li>
                    <li><strong>Follow-up:</strong> Send thank-you emails after interviews and politely follow up on application status.</li>
                    <li><strong>Continuous Learning:</strong> Use time between applications to work on labs, earn certifications, and build skills.</li>
                    <li><strong>Feedback:</strong> When possible, ask for feedback after rejections to improve future applications.</li>
                    <li><strong>Entry Points:</strong> Consider help desk, IT support, or junior IT roles as stepping stones if direct SOC entry is challenging.</li>
                </ul>
                
                <div class="tip">
                    <strong>üí° Career Accelerator:</strong> Create a portfolio website showcasing your projects, write-ups from CTF competitions, and technical blog posts. This demonstrates initiative and technical capability beyond what a resume can show.
                </div>
            </div>

            <!-- SOC Roles Deep Dive Section -->
            <div id="soc-roles" class="section">
                <h2>üë• SOC Roles: Comprehensive Analysis</h2>
                
                <h3>SOC Analyst (Tier 1) - The First Line of Defense</h3>
                
                <h4>Core Responsibilities</h4>
                <ul>
                    <li><strong>Alert Triage:</strong> Review security alerts from SIEM, IDS/IPS, EDR, and other security tools</li>
                    <li><strong>Initial Investigation:</strong> Determine if alerts represent true security incidents or false positives</li>
                    <li><strong>Documentation:</strong> Create detailed incident tickets with evidence, timeline, and initial findings</li>
                    <li><strong>Escalation:</strong> Identify incidents requiring Tier 2/3 investigation and escalate appropriately</li>
                    <li><strong>Communication:</strong> Notify stakeholders of confirmed incidents per established procedures</li>
                    <li><strong>Playbook Execution:</strong> Follow standard operating procedures (SOPs) for common incident types</li>
                </ul>
                
                <h4>Daily Workflow</h4>
                <ol>
                    <li><strong>Shift Handoff (15-30 min):</strong> Review handoff notes from previous shift, understand ongoing incidents, review any new alerts or priorities</li>
                    <li><strong>Queue Review (continuous):</strong> Monitor alert queue in SIEM/ticketing system, prioritize by severity and age</li>
                    <li><strong>Alert Investigation (4-6 hours):</strong> Investigate each alert using established playbooks, document findings in ticketing system</li>
                    <li><strong>Status Updates (hourly for critical):</strong> Update tickets with investigation progress, communicate with Tier 2 on escalated incidents</li>
                    <li><strong>End of Shift Handoff (15-30 min):</strong> Brief incoming shift on status of all open incidents, highlight urgent items</li>
                    <li><strong>Administrative Tasks (1-2 hours):</strong> Training, tool familiarization, process improvement suggestions</li>
                </ol>
                
                <h4>Essential Skills and Knowledge</h4>
                <ul>
                    <li><strong>Technical:</strong> Basic networking (TCP/IP, DNS, HTTP), Windows/Linux fundamentals, log interpretation, SIEM query basics</li>
                    <li><strong>Analytical:</strong> Pattern recognition, attention to detail, logical reasoning, ability to follow complex procedures</li>
                    <li><strong>Soft Skills:</strong> Written communication, time management, stress management, collaborative mindset</li>
                    <li><strong>Tools:</strong> SIEM platforms (Splunk, Elastic, Sentinel), ticketing systems (ServiceNow, Jira), basic scripting (helpful but not required)</li>
                </ul>
                
                <h4>Common Challenges</h4>
                <ul>
                    <li><strong>Alert Fatigue:</strong> High volume of false positives can lead to desensitization</li>
                    <li><strong>Knowledge Gaps:</strong> Steep learning curve with unfamiliar technologies and attack vectors</li>
                    <li><strong>Shift Work:</strong> Adjusting to night shifts, weekends, and holidays</li>
                    <li><strong>Pressure:</strong> Time-sensitive investigations during active incidents</li>
                </ul>
                
                <h3>Senior SOC Analyst (Tier 2) - The Deep Investigator</h3>
                
                <h4>Core Responsibilities</h4>
                <ul>
                    <li><strong>Advanced Investigation:</strong> Deep-dive analysis of escalated incidents, correlation across multiple data sources</li>
                    <li><strong>Threat Hunting:</strong> Proactive searches for indicators of compromise (IOCs) and advanced persistent threats (APTs)</li>
                    <li><strong>Detection Engineering:</strong> Create and tune SIEM correlation rules, reduce false positives</li>
                    <li><strong>Mentorship:</strong> Guide Tier 1 analysts, review their work, provide training and feedback</li>
                    <li><strong>Playbook Development:</strong> Document investigation procedures, create runbooks for new threat types</li>
                    <li><strong>Tool Evaluation:</strong> Test new security tools, provide recommendations to management</li>
                </ul>
                
                <h4>Advanced Skills Required</h4>
                <ul>
                    <li><strong>Log Correlation:</strong> Ability to pivot across multiple log sources (firewall, proxy, EDR, authentication logs)</li>
                    <li><strong>Attack Framework Mastery:</strong> Deep understanding of MITRE ATT&CK, Cyber Kill Chain</li>
                    <li><strong>Scripting:</strong> Python, PowerShell for automation and advanced data analysis</li>
                    <li><strong>Threat Intelligence:</strong> Consuming and applying threat intelligence feeds, understanding TTPs</li>
                    <li><strong>Forensics Basics:</strong> Memory analysis, disk forensics, network packet analysis</li>
                </ul>
                
                <h3>SOC Manager - Leading the Defense</h3>
                
                <h4>Core Responsibilities</h4>
                <ul>
                    <li><strong>Team Leadership:</strong> Manage team of 5-20+ analysts, conduct performance reviews, career development</li>
                    <li><strong>Operational Excellence:</strong> Ensure 24/7 coverage, manage schedules, approve PTO, handle escalations</li>
                    <li><strong>Metrics and Reporting:</strong> Track KPIs (MTTD, MTTR, alert volume), present metrics to leadership</li>
                    <li><strong>Budget Management:</strong> Manage SOC budget, justify tool purchases, vendor contract negotiations</li>
                    <li><strong>Process Improvement:</strong> Identify inefficiencies, implement continuous improvement initiatives</li>
                    <li><strong>Stakeholder Management:</strong> Interface with IT, Legal, HR, Executive Leadership on security matters</li>
                    <li><strong>Incident Coordination:</strong> Manage major incidents, coordinate response across multiple teams</li>
                </ul>
                
                <h4>Key Success Factors</h4>
                <ul>
                    <li><strong>Soft Skills:</strong> Excellent communication, conflict resolution, empathy, diplomatic negotiation</li>
                    <li><strong>Business Acumen:</strong> Understanding of business operations, risk management, compliance requirements</li>
                    <li><strong>Technical Credibility:</strong> Maintained through hands-on involvement in complex incidents</li>
                    <li><strong>Leadership Style:</strong> Servant leadership approach, removing obstacles for team success</li>
                </ul>
                
                <h3>SOC Engineer - The Builder and Optimizer</h3>
                
                <h4>Core Responsibilities</h4>
                <ul>
                    <li><strong>SIEM Administration:</strong> Manage SIEM infrastructure, ensure high availability, perform upgrades</li>
                    <li><strong>Integration Development:</strong> Onboard new data sources, develop parsers and normalization rules</li>
                    <li><strong>Detection Logic:</strong> Create advanced correlation rules, behavioral analytics, anomaly detection</li>
                    <li><strong>Automation:</strong> Develop SOAR playbooks, automate repetitive tasks, create custom integrations</li>
                    <li><strong>Performance Tuning:</strong> Optimize query performance, manage data retention, troubleshoot ingestion issues</li>
                    <li><strong>Tool Integration:</strong> Integrate security tools (EDR, firewall, proxy, threat intelligence) with SIEM</li>
                </ul>
                
                <h4>Technical Skills Required</h4>
                <ul>
                    <li><strong>Programming:</strong> Python, PowerShell, Bash for automation and tool development</li>
                    <li><strong>SIEM Deep Expertise:</strong> Advanced SPL, KQL, or Lucene; understanding of underlying architecture</li>
                    <li><strong>API Integration:</strong> REST APIs, JSON parsing, authentication methods (OAuth, API keys)</li>
                    <li><strong>Infrastructure:</strong> Linux system administration, networking, virtualization, cloud platforms</li>
                    <li><strong>Security Knowledge:</strong> Understanding of security principles to create effective detections</li>
                </ul>
                
                <h3>Incident Responder (Tier 3) - The Crisis Manager</h3>
                
                <h4>Core Responsibilities</h4>
                <ul>
                    <li><strong>Active Containment:</strong> Isolate compromised systems, block malicious IPs/domains, disable compromised accounts</li>
                    <li><strong>Forensic Analysis:</strong> Memory forensics, disk analysis, malware reverse engineering</li>
                    <li><strong>Eradication:</strong> Remove malware, close security gaps exploited by attacker</li>
                    <li><strong>Recovery:</strong> Restore services, validate system integrity, implement additional controls</li>
                    <li><strong>Post-Incident Analysis:</strong> Root cause analysis, lessons learned, remediation recommendations</li>
                    <li><strong>Reporting:</strong> Executive briefs, detailed technical reports, regulatory notifications if required</li>
                </ul>
                
                <h4>Incident Response Life Cycle</h4>
                <ol>
                    <li><strong>Preparation:</strong> Maintain IR toolkit, updated playbooks, contact lists, legal/PR relationships</li>
                    <li><strong>Identification:</strong> Confirm security incident, assess scope and severity, activate IR team</li>
                    <li><strong>Containment:</strong> Short-term (isolate systems) and long-term (system imaging, credential rotation)</li>
                    <li><strong>Eradication:</strong> Remove threat actor presence, close vulnerabilities, strengthen defenses</li>
                    <li><strong>Recovery:</strong> Restore systems to production, enhanced monitoring, validation period</li>
                    <li><strong>Lessons Learned:</strong> Post-incident review, update playbooks, share threat intelligence</li>
                </ol>
                
                <h4>Critical Incident Response Skills</h4>
                <ul>
                    <li><strong>Pressure Performance:</strong> Clear thinking during high-stress situations, decisive action</li>
                    <li><strong>Communication:</strong> Conveying technical details to non-technical stakeholders, managing expectations</li>
                    <li><strong>Forensics:</strong> FTK, EnCase, Volatility, Wireshark, memory dump analysis</li>
                    <li><strong>Malware Analysis:</strong> Static and dynamic analysis, sandboxing, reverse engineering basics</li>
                    <li><strong>Legal Awareness:</strong> Evidence handling, chain of custody, legal hold procedures</li>
                </ul>
                
                <h3>Threat Hunter - The Proactive Defender</h3>
                
                <h4>Core Responsibilities</h4>
                <ul>
                    <li><strong>Hypothesis Development:</strong> Create hunting hypotheses based on threat intelligence, emerging threats</li>
                    <li><strong>Proactive Search:</strong> Search for IOCs, TTPs, and anomalous behavior not caught by automated detections</li>
                    <li><strong>New Detection Creation:</strong> Convert successful hunts into automated SIEM detections</li>
                    <li><strong>Threat Intelligence Analysis:</strong> Consume and analyze threat intelligence reports, apply to environment</li>
                    <li><strong>Advanced Analytics:</strong> Behavioral analysis, statistical anomaly detection, machine learning applications</li>
                </ul>
                
                <h4>Threat Hunting Methodologies</h4>
                <ul>
                    <li><strong>Intelligence-Driven:</strong> Start with specific IOC or TTP from threat intelligence</li>
                    <li><strong>Hypothesis-Driven:</strong> Develop theory based on known attack patterns, search for evidence</li>
                    <li><strong>Situational Awareness:</strong> Baseline normal behavior, hunt for deviations and anomalies</li>
                </ul>
                
                <h4>The Pyramid of Pain</h4>
                <p>Understanding what hurts adversaries most when detected:</p>
                <ol>
                    <li><strong>Hash Values (Trivial):</strong> Easily changed by modifying one byte of malware</li>
                    <li><strong>IP Addresses (Easy):</strong> Attackers can quickly change infrastructure</li>
                    <li><strong>Domain Names (Simple):</strong> Require some effort but still easily changed</li>
                    <li><strong>Network Artifacts (Annoying):</strong> HTTP user agents, C2 patterns require more effort to change</li>
                    <li><strong>Host Artifacts (Challenging):</strong> Registry keys, file paths, service names require tool modification</li>
                    <li><strong>Tools (Tough):</strong> Forcing tool replacement requires significant attacker effort</li>
                    <li><strong>TTPs (Devastating):</strong> Detecting techniques forces attackers to change entire methodology</li>
                </ol>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Critical Understanding:</strong> Each SOC role requires different skill sets. Don't expect to master all areas immediately. Most professionals specialize in 1-2 areas while maintaining working knowledge of others. Choose a path aligned with your interests: If you enjoy puzzles and deep investigation, pursue analysis/IR. If you prefer building and automation, pursue engineering. If you like strategic thinking, consider management.
                </div>
            </div>

            <!-- Splunk Section -->
            <div id="splunk" class="section">
                <h2>üîç Splunk: Enterprise SIEM Platform</h2>
                
                <h3>Splunk Architecture and Data Model</h3>
                <p>Splunk is a distributed search and analytics platform that ingests machine-generated data through Universal Forwarders or HTTP Event Collectors (HEC). Data flows through the following pipeline:</p>
                <ol>
                    <li><strong>Input Layer:</strong> Data collection via forwarders, APIs, or direct file monitoring</li>
                    <li><strong>Parsing Layer:</strong> Event breaking, timestamp extraction, and field identification</li>
                    <li><strong>Indexing Layer:</strong> Data compression and storage in time-series indexes with bloom filters for efficient retrieval</li>
                    <li><strong>Search Layer:</strong> SPL (Search Processing Language) queries execute in distributed fashion across indexers</li>
                </ol>
                <p>Understanding this architecture is crucial for query optimization and troubleshooting performance issues.</p>
                
                <h3>Search Processing Language (SPL) Fundamentals</h3>
                <p>SPL follows a pipeline model where each command transforms the result set before passing it to the next command:</p>
                <div class="query-box">
                    <code>index=main sourcetype=access_combined error
| stats count by src_ip 
| where count > 10
| sort -count</code>
                </div>
                <p><strong>Pipeline breakdown:</strong></p>
                <ul>
                    <li><strong>Line 1:</strong> Base search filters events from the "main" index with sourcetype "access_combined" containing "error"</li>
                    <li><strong>Line 2:</strong> Aggregates events by source IP, counting occurrences</li>
                    <li><strong>Line 3:</strong> Post-processing filter to show only IPs with more than 10 errors</li>
                    <li><strong>Line 4:</strong> Sort results in descending order by count</li>
                </ul>
                
                <h3>Index and Sourcetype Selection Strategy</h3>
                <p>Efficient Splunk queries always specify the index (and ideally sourcetype) to minimize the search scope:</p>
                <ul>
                    <li><strong>index=</strong> Specifies which data repository to search (e.g., security, network, windows)</li>
                    <li><strong>sourcetype=</strong> Identifies the format/parser for the data (e.g., WinEventLog:Security, syslog, firewall:cisco:asa)</li>
                    <li><strong>Time range:</strong> Default is "All time" but should be limited to relevant period (last 24h, last 7d, etc.)</li>
                </ul>
                <div class="tip">
                    <strong>üí° Performance Tip:</strong> Searches without index specification scan all indexes, dramatically increasing query time and resource consumption. Always include index= as the first filter.
                </div>

                <h3>Incident Response Methodology</h3>
                <div class="important">
                    <strong>Splunk Incident Investigation Workflow:</strong>
                    <ol>
                        <li><strong>Alert Triage:</strong> Review notable events dashboard, examining key fields (source/destination IP, username, signature name, severity level)</li>
                        <li><strong>Scope Determination:</strong> Use <code>| tstats</code> command for fast aggregation across time, index, and sourcetype to understand event volume</li>
                        <li><strong>Evidence Collection:</strong> Execute targeted queries to extract relevant events, building a timeline of attacker activity</li>
                        <li><strong>Threat Intelligence Enrichment:</strong> Apply lookups (<code>| lookup threat_intel ip AS src_ip</code>) to contextualize IOCs</li>
                        <li><strong>Response Actions:</strong> Document findings, create adaptive responses (automated blocking/quarantine), and generate reports for stakeholders</li>
                    </ol>
                </div>

                <h3>Authentication Security Analysis</h3>

                <h4>1. Failed Login Attempts (Brute Force Detection)</h4>
                <p><strong>Threat Context:</strong> Brute force attacks attempt to guess credentials through repeated login attempts. This pattern is characteristic of the "Exploitation" phase in the Cyber Kill Chain.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Aggregate Windows Security Event ID 4625 (failed logon) by source IP and username, filtering for accounts exceeding a threshold.
                </div>
                <div class="query-box">
                    <code>index=security sourcetype=WinEventLog:Security EventCode=4625
| stats count by src_ip, user
| where count > 5
| sort -count</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>EventCode=4625:</strong> Windows logs failed authentication attempts with this ID</li>
                    <li><strong>stats count by src_ip, user:</strong> Aggregates by source and target, revealing attack patterns</li>
                    <li><strong>where count > 5:</strong> Threshold should be tuned based on baseline (consider legitimate typos)</li>
                </ul>
                <p><strong>False Positive Considerations:</strong> Legitimate users forgetting passwords, misconfigured services, time synchronization issues. Adjust threshold based on organizational behavior.</p>
                <p><strong>Evasion Techniques:</strong> Attackers may use slow brute force (low-and-slow), distributed sources (botnets), or credential stuffing with valid username/password pairs.</p>

                <h4>2. Successful Logins After Failed Attempts</h4>
                <p><strong>Threat Context:</strong> A successful login (EventCode 4624) immediately following multiple failures strongly indicates credential compromise or successful brute force.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Use transaction command to correlate temporally related authentication events for the same user within a 30-minute window.
                </div>
                <div class="query-box">
                    <code>index=security (EventCode=4625 OR EventCode=4624)
| transaction user maxspan=30m
| search EventCode=4625 EventCode=4624
| stats count by user, src_ip</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>transaction user maxspan=30m:</strong> Groups events for the same user within 30 minutes into transactions</li>
                    <li><strong>search EventCode=4625 EventCode=4624:</strong> Filters transactions containing BOTH failed and successful logins</li>
                    <li><strong>Temporal window:</strong> 30 minutes is default; adjust based on typical attack speed vs. legitimate retry patterns</li>
                </ul>
                <p><strong>Alternative Approach:</strong> Consider using <code>| streamstats</code> or <code>| eventstats</code> for real-time detection rather than batch processing.</p>
                <p><strong>Investigation Next Steps:</strong> Examine source IP geolocation, compare against user's typical login locations, check for subsequent lateral movement or privilege escalation.</p>

                <h4>3. Privilege Escalation Detection</h4>
                <p><strong>Threat Context:</strong> Privilege escalation is a critical phase where attackers elevate their access rights. Windows Event ID 4672 logs whenever special privileges are assigned to a new logon.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Monitor privilege assignment events, focusing on unusual frequency or logon types (especially Type 3: Network, Type 10: RemoteInteractive).
                </div>
                <div class="query-box">
                    <code>index=security EventCode=4672
| stats count by user, Logon_Type
| where count > 10</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>EventCode=4672:</strong> Special privileges assigned to new logon (SeSecurityPrivilege, SeBackupPrivilege, SeDebugPrivilege)</li>
                    <li><strong>Logon_Type field:</strong> Reveals how privilege was obtained (2=Interactive, 3=Network, 4=Batch, 5=Service, 10=RemoteInteractive)</li>
                    <li><strong>Baseline awareness:</strong> Administrator accounts will trigger this frequently; focus on user accounts or service accounts</li>
                </ul>
                <p><strong>Enhanced Detection:</strong> Cross-reference with Event ID 4673 (privileged service called) and 4674 (privileged operation attempted) for complete privilege abuse timeline.</p>
                <p><strong>MITRE ATT&CK Mapping:</strong> T1078 (Valid Accounts), T1068 (Exploitation for Privilege Escalation)</p>

                <h4>4. Data Exfiltration Detection</h4>
                <p><strong>Threat Context:</strong> Data exfiltration represents the final objective phase where attackers transmit stolen data to external infrastructure. Large outbound transfers, especially to unusual destinations, warrant investigation.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Analyze firewall or proxy logs for high-volume outbound connections to non-RFC1918 addresses, aggregating by source, destination, and user.
                </div>
                <div class="query-box">
                    <code>index=network sourcetype=firewall action=allowed
| eval bytes_mb=bytes/1024/1024
| where bytes_mb > 100 AND NOT (dest_ip="10.*" OR dest_ip="192.168.*")
| stats sum(bytes_mb) as total_mb by src_ip, dest_ip, user
| sort -total_mb</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>eval bytes_mb:</strong> Converts raw byte counts to megabytes for human readability</li>
                    <li><strong>NOT (dest_ip="10.*" OR dest_ip="192.168.*"):</strong> Excludes internal RFC1918 addresses (also consider 172.16.0.0/12)</li>
                    <li><strong>Threshold of 100MB:</strong> Should be adjusted based on organization's normal file transfer patterns</li>
                </ul>
                <p><strong>Advanced Considerations:</strong></p>
                <ul>
                    <li>Attackers may use DNS tunneling, ICMP tunneling, or steganography to evade detection</li>
                    <li>Consider protocol analysis: large HTTPS uploads, unusual port usage</li>
                    <li>Temporal patterns: transfers during off-hours are more suspicious</li>
                    <li>Baseline each user/system's typical outbound data volume</li>
                </ul>
                <p><strong>Complementary Queries:</strong> Correlate with DLP (Data Loss Prevention) alerts, examine file access logs (EventCode 4663), check for archive creation (.zip, .7z, .rar) before transfer.</p>

                <h4>5. Malware Detection via Process Creation</h4>
                <p><strong>Threat Context:</strong> Attackers frequently use PowerShell and Command Prompt for fileless malware, living-off-the-land techniques, and remote code execution. Event ID 4688 logs process creation when command-line auditing is enabled.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Search for encoded PowerShell commands, web download functions, or execution operators that suggest malicious script execution.
                </div>
                <div class="query-box">
                    <code>index=windows EventCode=4688
| search (process_name="*powershell.exe*" OR process_name="*cmd.exe*")
| search command_line="*-enc*" OR command_line="*downloadstring*" OR command_line="*invoke-expression*"
| stats count by host, user, process_name, command_line</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>-enc or -EncodedCommand:</strong> Base64-encoded PowerShell payload (common obfuscation technique)</li>
                    <li><strong>downloadstring:</strong> .NET method to download remote content (commonly used in malware droppers)</li>
                    <li><strong>invoke-expression (IEX):</strong> Executes strings as PowerShell code (indicator of dynamic code execution)</li>
                </ul>
                <p><strong>Additional Malicious Patterns to Monitor:</strong></p>
                <ul>
                    <li><code>-nop -w hidden</code>: No profile, hidden window (stealth execution)</li>
                    <li><code>Start-BitsTransfer</code>: Background Intelligent Transfer Service (legitimate tool abused for download)</li>
                    <li><code>Invoke-WebRequest</code> or <code>curl</code>: Web request functions</li>
                    <li><code>mimikatz</code>, <code>sekurlsa</code>: Credential dumping tools</li>
                </ul>
                <p><strong>False Positive Mitigation:</strong> Whitelist known administrative scripts (hash-based or path-based), exclude system accounts performing legitimate automation.</p>
                <p><strong>MITRE ATT&CK Mapping:</strong> T1059.001 (PowerShell), T1027 (Obfuscated Files or Information), T1105 (Ingress Tool Transfer)</p>

                <h4>6. Network Anomaly Detection (Port Scanning)</h4>
                <p><strong>Threat Context:</strong> Port scanning is reconnaissance activity where attackers probe systems for open ports/services. High unique port counts from a single source indicate scanning tools (Nmap, Masscan).</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Use distinct count (dc) to find sources contacting an unusually high number of unique destination ports.
                </div>
                <div class="query-box">
                    <code>index=network
| stats dc(dest_port) as unique_ports, values(dest_port) as ports by src_ip
| where unique_ports > 100
| sort -unique_ports</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>dc(dest_port):</strong> Distinct count function identifies unique ports accessed</li>
                    <li><strong>values(dest_port):</strong> Lists all accessed ports for forensic analysis</li>
                    <li><strong>Threshold of 100 ports:</strong> Legitimate systems rarely contact >100 ports; adjust based on network profile</li>
                </ul>
                <p><strong>Scan Types and Detection:</strong></p>
                <ul>
                    <li><strong>Horizontal scan:</strong> Many hosts, few ports (add dest_ip distinct count)</li>
                    <li><strong>Vertical scan:</strong> Few hosts, many ports (current query)</li>
                    <li><strong>Slow scan:</strong> May evade detection; consider longer time windows</li>
                </ul>
                <p><strong>MITRE ATT&CK Mapping:</strong> T1046 (Network Service Scanning)</p>

                <h4>7. Web Application Attacks (SQLi & XSS Detection)</h4>
                <p><strong>Threat Context:</strong> Web applications are frequent attack vectors. SQL Injection (SQLi) manipulates database queries, while Cross-Site Scripting (XSS) injects malicious JavaScript into web pages.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Pattern match URI parameters for common SQLi and XSS syntax, correlating with HTTP response codes.
                </div>
                <div class="query-box">
                    <code>index=web sourcetype=access_combined
| search (uri="*union*select*" OR uri="*script*" OR uri="*exec*" OR uri="*drop*table*")
| stats count by src_ip, uri, status
| sort -count</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>union*select:</strong> SQL UNION-based injection attempt</li>
                    <li><strong>script:</strong> Potential XSS payload (e.g., &lt;script&gt;alert()&lt;/script&gt;)</li>
                    <li><strong>exec, drop*table:</strong> SQL command injection patterns</li>
                    <li><strong>Status code correlation:</strong> 200 (success) may indicate vulnerability, 403/500 suggests blocking</li>
                </ul>
                <p><strong>Enhanced Detection Patterns:</strong></p>
                <ul>
                    <li>Add: <code>OR uri="*' OR '1'='1*"</code> (authentication bypass)</li>
                    <li>Add: <code>OR uri="*../..%2F*"</code> (directory traversal)</li>
                    <li>Add: <code>OR uri="*cmd=*"</code> (OS command injection)</li>
                    <li>Consider URL-decoded analysis: <code>| eval uri_decoded=urldecode(uri)</code></li>
                </ul>
                <p><strong>False Positives:</strong> Legitimate application features, security scanners, penetration tests. Whitelist authorized security testing.</p>
                <p><strong>MITRE ATT&CK Mapping:</strong> T1190 (Exploit Public-Facing Application)</p>

                <h4>8. Time-Based Analysis (Temporal Pattern Detection)</h4>
                <p><strong>Threat Context:</strong> Visualizing event distribution over time reveals attack patterns, identifies peak attack periods, and helps establish baselines for anomaly detection.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Create time-series visualization of failed login attempts, segmented by user.
                </div>
                <div class="query-box">
                    <code>index=security EventCode=4625
| timechart span=1h count by user</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>timechart:</strong> Automatically bins events by time and creates statistical summary</li>
                    <li><strong>span=1h:</strong> One-hour buckets; adjust based on analysis needs (5m for real-time, 1d for trends)</li>
                    <li><strong>count by user:</strong> Creates separate time series for each user (limit 10 by default)</li>
                </ul>
                <p><strong>Analytical Insights:</strong></p>
                <ul>
                    <li><strong>Spikes:</strong> Sudden increases suggest automated attacks</li>
                    <li><strong>Periodic patterns:</strong> May indicate scheduled tasks or persistent threats</li>
                    <li><strong>Off-hours activity:</strong> Events outside business hours warrant investigation</li>
                    <li><strong>Comparison:</strong> Use <code>timechart ... by user limit=0</code> to aggregate all users</li>
                </ul>
                <p><strong>Advanced Visualization:</strong> Combine with <code>| predict</code> for machine learning-based anomaly detection or <code>| baseline</code> for statistical deviation analysis.</p>

                <h4>9. User Behavior Analytics (Impossible Travel Detection)</h4>
                <p><strong>Threat Context:</strong> Compromised credentials are often used from multiple geographic locations. Users appearing from multiple IPs simultaneously or from geographically distant locations in short time periods indicate account compromise.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Identify users authenticating from an anomalous number of distinct source IPs within the analysis timeframe.
                </div>
                <div class="query-box">
                    <code>index=security EventCode=4624
| stats count, dc(src_ip) as unique_ips, values(src_ip) as ips by user
| where unique_ips > 5
| sort -unique_ips</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>dc(src_ip):</strong> Distinct count of source IPs per user</li>
                    <li><strong>values(src_ip):</strong> Lists all IPs for manual review</li>
                    <li><strong>Threshold of 5:</strong> Depends on user role (executives travel, remote workers VPN); tune per user/department</li>
                </ul>
                <p><strong>Enhanced Detection with Geolocation:</strong></p>
                <div class="query-box">
                    <code>index=security EventCode=4624
| iplocation src_ip
| stats dc(Country) as countries, values(Country) as country_list by user
| where countries > 2</code>
                </div>
                <p><strong>Impossible Travel Detection:</strong> Calculate geographic distance and time delta between consecutive logins to detect physically impossible travel scenarios.</p>
                <p><strong>MITRE ATT&CK Mapping:</strong> T1078 (Valid Accounts), T1133 (External Remote Services)</p>

                <h4>10. Threat Intelligence Integration</h4>
                <p><strong>Threat Context:</strong> External threat intelligence feeds provide context about known malicious infrastructure (C2 servers, malware distribution sites, scanning hosts). Integrating these feeds enriches security events with actionable threat data.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Use Splunk lookups to match network destinations against threat intelligence databases, filtering for confirmed threats.
                </div>
                <div class="query-box">
                    <code>index=network
| lookup threat_intel_ips ip as dest_ip OUTPUT threat_level, category
| where isnotnull(threat_level)
| stats count by src_ip, dest_ip, threat_level, category</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>lookup threat_intel_ips:</strong> References CSV lookup table containing known bad IPs</li>
                    <li><strong>OUTPUT threat_level, category:</strong> Enriches events with threat severity and classification</li>
                    <li><strong>isnotnull(threat_level):</strong> Filters only events matching threat intelligence</li>
                </ul>
                <p><strong>Threat Intelligence Sources:</strong></p>
                <ul>
                    <li><strong>Commercial feeds:</strong> Recorded Future, CrowdStrike, Anomali (high fidelity, subscription-based)</li>
                    <li><strong>Open source:</strong> AlienVault OTX, AbuseIPDB, EmergingThreats (free but may have higher false positives)</li>
                    <li><strong>Government feeds:</strong> CISA, FBI InfraGard (sector-specific intelligence)</li>
                </ul>
                <p><strong>Lookup Table Maintenance:</strong> Implement automated updates (daily/hourly) via scripts or Splunk apps. Monitor feed freshness and accuracy.</p>
                <p><strong>Bidirectional Analysis:</strong> Also check source IPs (<code>lookup ... ip as src_ip</code>) to detect compromised internal hosts.</p>

                <div class="tip">
                    <strong>üí° Splunk Performance Optimization:</strong>
                    <ul>
                        <li><strong>Testing:</strong> Use <code>| head 100</code> to limit results during query development</li>
                        <li><strong>Field selection:</strong> Use <code>| fields src_ip, dest_ip, user</code> to return only necessary fields</li>
                        <li><strong>Fast mode:</strong> Enable in search bar for preliminary analysis (disables field discovery)</li>
                        <li><strong>tstats:</strong> Use <code>| tstats</code> instead of stats for accelerated data models (10-1000x faster)</li>
                        <li><strong>Summary indexing:</strong> Pre-compute frequently used aggregations</li>
                        <li><strong>Subsearches:</strong> Use sparingly; often <code>join</code> or <code>lookup</code> is more efficient</li>
                    </ul>
                </div>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Operational Considerations:</strong> Always validate queries in a test environment before deploying as scheduled searches or alerts. Monitor search resource usage (CPU, memory) and set appropriate scheduling priorities. Document query purpose, data sources, and expected results for knowledge transfer.
                </div>
            </div>

            <!-- Elastic Section -->
            <div id="elastic" class="section">
                <h2>üîé Elastic (ELK Stack): Open Source Security Analytics</h2>
                
                <h3>Elastic Stack Architecture</h3>
                <p>The Elastic Stack (formerly ELK Stack) is a collection of open-source tools for searching, analyzing, and visualizing log data in real-time:</p>
                <ul>
                    <li><strong>Elasticsearch:</strong> Distributed search and analytics engine built on Apache Lucene, storing data as JSON documents in inverted indices</li>
                    <li><strong>Logstash:</strong> Server-side data processing pipeline that ingests, transforms, and forwards data to Elasticsearch</li>
                    <li><strong>Kibana:</strong> Visualization and exploration interface providing dashboards, query builders, and investigation tools</li>
                    <li><strong>Beats:</strong> Lightweight data shippers (Filebeat, Metricbeat, Packetbeat, Winlogbeat) deployed on endpoints</li>
                </ul>
                <p>Elastic Security (formerly SIEM) adds pre-built detection rules, timeline analysis, case management, and threat intelligence integration.</p>
                
                <h3>Elastic Common Schema (ECS)</h3>
                <p>ECS is a standardized field naming convention ensuring consistent data structure across diverse sources:</p>
                <ul>
                    <li><strong>@timestamp:</strong> Event occurrence time (ISO 8601 format)</li>
                    <li><strong>event.*:</strong> Event metadata (category, action, outcome, type)</li>
                    <li><strong>user.*:</strong> User identity (name, id, domain)</li>
                    <li><strong>source/destination.*:</strong> Network endpoints (ip, port, geo)</li>
                    <li><strong>process.*:</strong> Process details (name, pid, command_line, parent)</li>
                    <li><strong>file.*:</strong> File operations (path, name, hash)</li>
                </ul>
                <p>ECS compliance enables seamless integration of diverse data sources and correlation across security events.</p>
                
                <h3>Query Languages in Elastic</h3>
                
                <h4>Kibana Query Language (KQL)</h4>
                <p>KQL is a simplified query syntax for Kibana's Discover and Dashboard interfaces:</p>
                <div class="query-box">
                    <code>event.action: "login" AND user.name: "admin" AND NOT event.outcome: "success"</code>
                </div>
                <p><strong>KQL Features:</strong></p>
                <ul>
                    <li><strong>Field:value syntax:</strong> Simple equality matching with automatic field type handling</li>
                    <li><strong>Wildcard support:</strong> <code>process.name: "powershell*"</code> or <code>url.path: "/api/*/user"</code></li>
                    <li><strong>Boolean operators:</strong> AND, OR, NOT (case-sensitive)</li>
                    <li><strong>Range queries:</strong> <code>bytes: &gt;= 1000 AND bytes: &lt; 10000</code></li>
                    <li><strong>Nested field access:</strong> Automatically handles nested objects</li>
                </ul>
                
                <h4>Elasticsearch Query DSL (Domain Specific Language)</h4>
                <p>DSL is a JSON-based query language for programmatic API access with advanced capabilities:</p>
                <ul>
                    <li><strong>Full-text search:</strong> Analyzed text matching with relevance scoring</li>
                    <li><strong>Aggregations:</strong> Statistical analysis, grouping, and bucketing</li>
                    <li><strong>Scripting:</strong> Custom logic using Painless scripting language</li>
                    <li><strong>Geospatial queries:</strong> Location-based filtering and distance calculations</li>
                </ul>
                
                <h3>Incident Response Workflow</h3>
                <div class="important">
                    <strong>Elastic Security Investigation Methodology:</strong>
                    <ol>
                        <li><strong>Alert Triage:</strong> Open alert in Security ‚Üí Detection Engine, inspect rule logic and matched fields</li>
                        <li><strong>Contextual Pivoting:</strong> Use "View in Discover" to explore related events with automatic filters (source/destination, user, host)</li>
                        <li><strong>Query Refinement:</strong> Access raw DSL via "Inspect" ‚Üí "Request" to understand underlying query, modify, and rerun</li>
                        <li><strong>Timeline Construction:</strong> Build investigation timeline with evidence panels, annotate findings, and correlate events</li>
                        <li><strong>Response Actions:</strong> Isolate compromised hosts via Endpoint Security integration, disable user accounts, create cases for tracking</li>
                        <li><strong>Threat Hunting:</strong> Leverage Machine Learning jobs and anomaly detection for proactive threat discovery</li>
                    </ol>
                </div>

                <h3>Detection Queries</h3>

                <h4>1. Failed Authentication Detection</h4>
                <p><strong>Threat Context:</strong> Failed authentication events are primary indicators of credential-based attacks (brute force, password spraying, credential stuffing).</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Query authentication failure events from the last hour, aggregating by username to identify targeted accounts.
                </div>
                <div class="query-box">
                    <code>GET /logs-*/_search
{
  "query": {
    "bool": {
      "must": [
        { "match": { "event.action": "authentication_failure" }}
      ],
      "filter": [
        { "range": { "@timestamp": { "gte": "now-1h" }}}
      ]
    }
  },
  "aggs": {
    "by_user": {
      "terms": { "field": "user.name.keyword", "size": 10 }
    }
  }
}</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>bool query:</strong> Combines multiple query clauses (must, filter, should, must_not)</li>
                    <li><strong>match:</strong> Full-text search on analyzed fields</li>
                    <li><strong>filter context:</strong> Range query in filter (cached, no scoring) for performance</li>
                    <li><strong>terms aggregation:</strong> Groups results by user.name.keyword (non-analyzed field for exact matching)</li>
                    <li><strong>Index pattern /logs-*/_search:</strong> Searches all indices matching the pattern</li>
                </ul>
                <p><strong>ECS Compliance:</strong> Uses standard ECS fields (event.action, @timestamp, user.name) ensuring compatibility with diverse data sources.</p>

                <h4>2. Brute Force Attack Detection</h4>
                <p><strong>Threat Context:</strong> Brute force attacks generate high volumes of authentication failures from the same source, attempting to compromise accounts through credential guessing.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Aggregate authentication failures by source IP with nested aggregation counting attempts, revealing attack sources.
                </div>
                <div class="query-box">
                    <code>GET /logs-*/_search
{
  "query": {
    "bool": {
      "must": [
        { "match": { "event.outcome": "failure" }},
        { "match": { "event.category": "authentication" }}
      ]
    }
  },
  "aggs": {
    "by_source_ip": {
      "terms": { "field": "source.ip", "size": 20 },
      "aggs": {
        "failed_count": { "value_count": { "field": "event.outcome" }}
      }
    }
  },
  "size": 0
}</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>Multiple must clauses:</strong> Both conditions must be satisfied (AND logic)</li>
                    <li><strong>event.category: authentication:</strong> ECS category for all auth-related events</li>
                    <li><strong>Nested aggregations:</strong> Sub-aggregation counts failures per IP</li>
                    <li><strong>size: 0:</strong> Returns only aggregation results, not individual documents (performance optimization)</li>
                </ul>
                <p><strong>Advanced Analysis:</strong> Enhance with <code>"min_doc_count": 5</code> parameter in terms aggregation to show only IPs exceeding threshold.</p>
                <p><strong>Visualization:</strong> Create Kibana heatmap showing attack intensity over time, or geographic map showing attacker locations.</p>

                <h4>3. Network Connection Monitoring</h4>
                <p><strong>Threat Context:</strong> Monitoring outbound connections identifies C2 communications, data exfiltration, and lateral movement to external infrastructure.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Filter network flows excluding RFC1918 private addresses, aggregating external destinations.
                </div>
                <div class="query-box">
                    <code>GET /network-*/_search
{
  "query": {
    "bool": {
      "must": [
        { "match": { "event.action": "network_flow" }}
      ],
      "must_not": [
        { "prefix": { "destination.ip": "10." }},
        { "prefix": { "destination.ip": "192.168." }},
        { "prefix": { "destination.ip": "172." }}
      ]
    }
  },
  "aggs": {
    "top_destinations": {
      "terms": { "field": "destination.ip", "size": 50 }
    }
  }
}</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>must_not clause:</strong> Exclusion logic for filtering internal traffic</li>
                    <li><strong>prefix match:</strong> Efficient filtering for IP ranges (consider 172.16-31 for full RFC1918 compliance)</li>
                    <li><strong>Limitation:</strong> Also exclude multicast (224.0.0.0/4), loopback (127.0.0.0/8), and link-local (169.254.0.0/16)</li>
                </ul>
                <p><strong>Enhanced Detection:</strong> Add geolocation aggregation and filter for unexpected countries, or integrate with threat intelligence.</p>
                <p><strong>MITRE ATT&CK:</strong> T1071 (Application Layer Protocol), T1041 (Exfiltration Over C2 Channel)</p>

                <h4>4. Process Execution Monitoring</h4>
                <p><strong>Threat Context:</strong> Malicious PowerShell usage is prevalent in modern attacks for remote code execution, credential harvesting, and living-off-the-land techniques.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Use wildcard matching on process command lines to identify encoded commands and web-based payload delivery.
                </div>
                <div class="query-box">
                    <code>GET /endpoint-*/_search
{
  "query": {
    "bool": {
      "must": [
        { "match": { "event.category": "process" }}
      ],
      "should": [
        { "wildcard": { "process.command_line": "*powershell*-enc*" }},
        { "wildcard": { "process.command_line": "*invoke-expression*" }},
        { "wildcard": { "process.command_line": "*downloadstring*" }}
      ],
      "minimum_should_match": 1
    }
  }
}</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>should clause with minimum_should_match:</strong> OR logic requiring at least one pattern to match</li>
                    <li><strong>wildcard:</strong> Pattern matching with * (any characters); case-sensitive by default</li>
                    <li><strong>Performance consideration:</strong> Wildcards on analyzed text fields are expensive; use .keyword suffix for exact matching</li>
                </ul>
                <p><strong>Additional Suspicious Patterns:</strong> <code>bypass</code>, <code>-nop -w hidden</code>, <code>FromBase64String</code>, <code>Net.WebClient</code></p>
                <p><strong>MITRE ATT&CK:</strong> T1059.001 (PowerShell), T1027 (Obfuscated Files or Information)</p>

                <h4>5. File Modification Detection</h4>
                <p><strong>Threat Context:</strong> Modifications to critical system files indicate privilege escalation, persistence mechanisms, or system compromise.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Monitor file modification events on critical system paths across Windows and Linux systems.
                </div>
                <div class="query-box">
                    <code>GET /endpoint-*/_search
{
  "query": {
    "bool": {
      "must": [
        { "match": { "event.category": "file" }},
        { "match": { "event.action": "modification" }}
      ],
      "should": [
        { "wildcard": { "file.path": "*/etc/passwd" }},
        { "wildcard": { "file.path": "*/etc/shadow" }},
        { "wildcard": { "file.path": "*\\Windows\\System32\\*" }}
      ],
      "minimum_should_match": 1
    }
  }
}</code>
                </div>
                <p><strong>Critical Paths to Monitor:</strong></p>
                <ul>
                    <li><strong>Linux:</strong> /etc/passwd, /etc/shadow, /etc/sudoers, /etc/crontab, ~/.ssh/authorized_keys</li>
                    <li><strong>Windows:</strong> C:\Windows\System32\*, Registry hives (SAM, SYSTEM), startup folders</li>
                    <li><strong>Application:</strong> Web server roots, database files, application configurations</li>
                </ul>
                <p><strong>File Integrity Monitoring (FIM):</strong> Combine with hash comparison (file.hash.sha256) to detect unauthorized modifications.</p>
                <p><strong>MITRE ATT&CK:</strong> T1078 (Valid Accounts), T1547 (Boot or Logon Autostart Execution)</p>

                <h4>6. Web Application Attack Detection</h4>
                <p><strong>Threat Context:</strong> Web applications are exposed attack surfaces vulnerable to injection attacks that can lead to data breaches.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Use regular expressions to pattern-match common SQLi and XSS payloads in URLs.
                </div>
                <div class="query-box">
                    <code>GET /web-*/_search
{
  "query": {
    "bool": {
      "should": [
        { "regexp": { "url.full": ".*union.*select.*" }},
        { "regexp": { "url.full": ".*&lt;script&gt;.*" }},
        { "regexp": { "url.full": ".*exec.*" }}
      ],
      "minimum_should_match": 1
    }
  },
  "aggs": {
    "by_source_ip": {
      "terms": { "field": "source.ip", "size": 20 }
    }
  }
}</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>regexp:</strong> Supports full regular expression syntax (more powerful but slower than wildcard)</li>
                    <li><strong>.*:</strong> Matches any characters (equivalent to * in wildcard)</li>
                    <li><strong>Case sensitivity:</strong> Elasticsearch regexes are case-sensitive by default</li>
                </ul>
                <p><strong>Enhanced Patterns:</strong></p>
                <ul>
                    <li><strong>SQLi:</strong> <code>' OR '1'='1</code>, <code>; DROP TABLE</code>, <code>UNION ALL SELECT</code></li>
                    <li><strong>XSS:</strong> <code>&lt;iframe&gt;</code>, <code>javascript:</code>, <code>onerror=</code></li>
                    <li><strong>Command Injection:</strong> <code>; ls</code>, <code>| cat /etc/passwd</code></li>
                </ul>
                <p><strong>Correlation:</strong> Match with HTTP response codes (200 = possible success, 500 = error, 403 = blocked)</p>
                <p><strong>MITRE ATT&CK:</strong> T1190 (Exploit Public-Facing Application)</p>

                <h4>7. DNS Tunneling Detection</h4>
                <p><strong>Threat Context:</strong> DNS tunneling abuses DNS protocol to exfiltrate data or establish C2 channels, bypassing traditional firewall rules that allow DNS traffic.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Analyze DNS query patterns using aggregations to identify domains with suspicious characteristics (high query volume, many unique subdomains).
                </div>
                <div class="query-box">
                    <code>GET /dns-*/_search
{
  "query": {
    "bool": {
      "must": [
        { "match": { "dns.type": "query" }}
      ]
    }
  },
  "aggs": {
    "by_domain": {
      "terms": { 
        "field": "dns.question.name.keyword", 
        "size": 100,
        "order": { "query_count": "desc" }
      },
      "aggs": {
        "query_count": { "value_count": { "field": "dns.question.name.keyword" }},
        "unique_subdomains": { "cardinality": { "field": "dns.question.name.keyword" }}
      }
    }
  }
}</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>Nested aggregations:</strong> Count total queries AND unique subdomain count per domain</li>
                    <li><strong>cardinality aggregation:</strong> Approximate distinct count (uses HyperLogLog algorithm)</li>
                    <li><strong>order parameter:</strong> Sorts buckets by nested aggregation value</li>
                </ul>
                <p><strong>DNS Tunneling Indicators:</strong></p>
                <ul>
                    <li><strong>High query volume:</strong> Hundreds or thousands of queries to same domain</li>
                    <li><strong>Unusual subdomain patterns:</strong> Long, random-looking subdomains (encoded data)</li>
                    <li><strong>Request/response size:</strong> Unusually large TXT records or response sizes</li>
                    <li><strong>Query frequency:</strong> Regular, automated patterns</li>
                </ul>
                <p><strong>Advanced Detection:</strong> Use Elasticsearch ML anomaly detection on query length, entropy, and frequency patterns.</p>
                <p><strong>MITRE ATT&CK:</strong> T1071.004 (Application Layer Protocol: DNS), T1048.003 (Exfiltration Over Alternative Protocol: DNS)</p>

                <h4>8. Time-Series Anomaly Detection</h4>
                <p><strong>Threat Context:</strong> Temporal analysis reveals attack patterns, identifies peak activity periods, and establishes behavioral baselines.</p>
                <div class="query-box">
                    <code>GET /logs-*/_search
{
  "query": {
    "range": { "@timestamp": { "gte": "now-24h" }}
  },
  "aggs": {
    "events_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "fixed_interval": "1h"
      },
      "aggs": {
        "by_category": {
          "terms": { "field": "event.category" }
        }
      }
    }
  },
  "size": 0
}</code>
                </div>
                <p><strong>Advanced Capabilities:</strong></p>
                <ul>
                    <li><strong>date_histogram:</strong> Time-based bucketing (minute, hour, day intervals)</li>
                    <li><strong>Moving averages:</strong> Add pipeline aggregations for trend analysis</li>
                    <li><strong>Percentile aggregations:</strong> Identify outliers statistically</li>
                    <li><strong>Machine Learning:</strong> Elastic ML can automatically detect anomalies in time-series data</li>
                </ul>

                <div class="tip">
                    <strong>üí° Elastic Performance Best Practices:</strong>
                    <ul>
                        <li><strong>Index patterns:</strong> Use specific index patterns (/logs-2024.01.*/) instead of wildcards when possible</li>
                        <li><strong>Keyword fields:</strong> Use .keyword suffix for aggregations and exact matching</li>
                        <li><strong>Filter context:</strong> Place range queries in filter clause for caching</li>
                        <li><strong>Size parameter:</strong> Set "size": 0 when only aggregations are needed</li>
                        <li><strong>Scroll API:</strong> Use for large result sets (>10,000 documents)</li>
                        <li><strong>Index lifecycle management:</strong> Implement hot-warm-cold architecture for cost optimization</li>
                    </ul>
                </div>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Elastic Security Integration:</strong> Leverage Elastic Security's pre-built detection rules based on MITRE ATT&CK framework. These rules are continuously updated by Elastic's threat research team and provide high-fidelity detections with minimal tuning required. Customize rules to match your environment and disable noisy detections.
                </div>
            </div>

            <!-- Microsoft Sentinel Section -->
            <div id="sentinel" class="section">
                <h2>üõ∞Ô∏è Microsoft Sentinel: Cloud-Native SIEM</h2>
                
                <h3>Microsoft Sentinel Architecture and Azure Integration</h3>
                <p>Microsoft Sentinel is a cloud-native Security Information and Event Management (SIEM) and Security Orchestration, Automation, and Response (SOAR) solution built on Azure's scalable infrastructure. Unlike traditional on-premises SIEM solutions, Sentinel leverages Azure's compute and storage capabilities, enabling elastic scaling and pay-as-you-go pricing models.</p>
                
                <h4>Core Components</h4>
                <ul>
                    <li><strong>Log Analytics Workspace:</strong> The data storage foundation where all security logs are ingested. Uses columnar storage optimized for fast queries across petabytes of data.</li>
                    <li><strong>Data Connectors:</strong> Pre-built integrations for Azure services, Microsoft 365, third-party security solutions, and generic formats (Syslog, CEF, REST API).</li>
                    <li><strong>Analytics Engine:</strong> Rule-based detection system supporting scheduled queries, Microsoft security alerts, ML-based anomaly detection, and fusion correlation.</li>
                    <li><strong>Incident Management:</strong> Centralized case management with investigation graph, entity behavior analytics (UEBA), and automated response playbooks.</li>
                    <li><strong>Workbooks:</strong> Interactive dashboards built on Azure Monitor providing visualization and threat context for investigations.</li>
                    <li><strong>Hunting Queries:</strong> Proactive threat hunting repository with community-driven KQL queries aligned to MITRE ATT&CK.</li>
                </ul>
                
                <h4>Azure Integration Benefits</h4>
                <ul>
                    <li><strong>Native Integration:</strong> Zero-configuration connectivity to Azure AD, Azure resources, Microsoft 365, and Defender suite</li>
                    <li><strong>Elastic Scalability:</strong> Automatically handles ingestion spikes without infrastructure management</li>
                    <li><strong>Global Availability:</strong> Deploy across Azure regions for compliance and data residency requirements</li>
                    <li><strong>Cost Efficiency:</strong> Pay only for data ingested; leverage commitment tiers and data retention policies</li>
                    <li><strong>AI/ML Capabilities:</strong> Built-in machine learning for anomaly detection, user/entity behavior analytics (UEBA), and threat intelligence matching</li>
                </ul>
                
                <h3>Kusto Query Language (KQL) Fundamentals</h3>
                <p>KQL is a read-only query language designed for fast data exploration across massive datasets. Unlike SQL, KQL is optimized for time-series data and follows a tabular data model where each table represents a specific log source.</p>
                
                <h4>KQL Syntax Structure</h4>
                <div class="query-box">
                    <code>// Basic KQL query structure
TableName                           // Start with a table
| where TimeGenerated > ago(1h)    // Filter rows (WHERE clause)
| extend NewField = Field1 + Field2 // Add calculated columns
| project Field1, Field2, NewField  // Select columns to display
| summarize Count=count() by Field1 // Aggregate data
| order by Count desc               // Sort results
| take 100                          // Limit output</code>
                </div>
                
                <h4>Key KQL Operators</h4>
                <ul>
                    <li><strong>where:</strong> Filters rows based on conditions (similar to SQL WHERE)</li>
                    <li><strong>project:</strong> Selects specific columns (similar to SQL SELECT)</li>
                    <li><strong>extend:</strong> Adds calculated columns without removing existing ones</li>
                    <li><strong>summarize:</strong> Aggregates data (count, sum, avg, min, max, make_set, make_list)</li>
                    <li><strong>join:</strong> Combines data from multiple tables (inner, leftouter, rightouter, fullouter)</li>
                    <li><strong>parse:</strong> Extracts structured data from strings using patterns</li>
                    <li><strong>mv-expand:</strong> Expands multi-value fields into separate rows</li>
                    <li><strong>ago():</strong> Time function for relative time ranges (ago(1h), ago(7d))</li>
                    <li><strong>bin():</strong> Buckets time values for time-series analysis</li>
                </ul>
                
                <h4>KQL String Matching Operators</h4>
                <ul>
                    <li><strong>==</strong> (equals), <strong>!=</strong> (not equals): Case-sensitive exact match</li>
                    <li><strong>=~</strong> (equals), <strong>!~</strong> (not equals): Case-insensitive exact match</li>
                    <li><strong>contains:</strong> Case-insensitive substring search</li>
                    <li><strong>has:</strong> Case-insensitive whole word search (faster than contains)</li>
                    <li><strong>startswith, endswith:</strong> Prefix/suffix matching</li>
                    <li><strong>matches regex:</strong> Regular expression pattern matching</li>
                    <li><strong>has_any, has_all:</strong> Efficient multi-value matching</li>
                </ul>
                
                <div class="tip">
                    <strong>üí° KQL Performance Optimization:</strong>
                    <ul>
                        <li><strong>Filter early:</strong> Place time filters (where TimeGenerated) at the beginning of queries</li>
                        <li><strong>Use "has" over "contains":</strong> "has" searches whole words and is indexed</li>
                        <li><strong>Project before summarize:</strong> Reduce data volume before aggregations</li>
                        <li><strong>Leverage materialized views:</strong> Pre-compute frequently accessed aggregations</li>
                        <li><strong>Avoid "search *":</strong> Specify table names explicitly for better performance</li>
                    </ul>
                </div>
                
                <h3>Data Connectors Overview</h3>
                <p>Data connectors are the ingestion pipelines that populate Sentinel's Log Analytics workspace. Understanding connector types is essential for data availability and troubleshooting.</p>
                
                <h4>Connector Categories</h4>
                <ul>
                    <li><strong>Service-to-Service (Microsoft):</strong> Azure AD, Microsoft 365 Defender, Azure Activity, Azure Firewall - enabled with one-click authentication</li>
                    <li><strong>Agent-Based:</strong> Log Analytics agent for Windows/Linux servers, Azure Monitor Agent (AMA) for modern deployments</li>
                    <li><strong>API-Based:</strong> Third-party integrations via REST APIs (AWS, GCP, Okta, ServiceNow)</li>
                    <li><strong>Syslog/CEF:</strong> Network devices, security appliances using Common Event Format over Syslog</li>
                    <li><strong>Custom Logs:</strong> Data Collector API for proprietary log formats and custom applications</li>
                </ul>
                
                <h4>Common Data Tables and Their Sources</h4>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Table Name</th>
                                <th>Data Source</th>
                                <th>Key Fields</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>SecurityEvent</strong></td>
                                <td>Windows Security Event Logs</td>
                                <td>EventID, Account, Computer, Activity</td>
                            </tr>
                            <tr>
                                <td><strong>SigninLogs</strong></td>
                                <td>Azure AD Sign-in Events</td>
                                <td>UserPrincipalName, IPAddress, AppDisplayName, ResultType</td>
                            </tr>
                            <tr>
                                <td><strong>AuditLogs</strong></td>
                                <td>Azure AD Administrative Changes</td>
                                <td>OperationName, Result, InitiatedBy, TargetResources</td>
                            </tr>
                            <tr>
                                <td><strong>OfficeActivity</strong></td>
                                <td>Microsoft 365 Audit Logs</td>
                                <td>Operation, UserId, ClientIP, Workload</td>
                            </tr>
                            <tr>
                                <td><strong>DeviceProcessEvents</strong></td>
                                <td>Microsoft Defender for Endpoint</td>
                                <td>DeviceName, ProcessCommandLine, AccountName, SHA256</td>
                            </tr>
                            <tr>
                                <td><strong>CommonSecurityLog</strong></td>
                                <td>Firewalls, Proxies (CEF format)</td>
                                <td>DeviceVendor, DeviceAction, SourceIP, DestinationIP</td>
                            </tr>
                            <tr>
                                <td><strong>Syslog</strong></td>
                                <td>Linux/Unix Systems</td>
                                <td>Computer, Facility, SeverityLevel, SyslogMessage</td>
                            </tr>
                            <tr>
                                <td><strong>AzureActivity</strong></td>
                                <td>Azure Resource Manager Operations</td>
                                <td>OperationName, Caller, ResourceGroup, ActivityStatus</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Data Connector Health Monitoring:</strong> Regularly verify connector status in the Data Connectors page. Missing data can indicate agent failures, authentication issues, or API quota limits. Use the Heartbeat table to monitor agent connectivity and the _LogOperation table to track ingestion errors.
                </div>

                <h3>Incident Investigation Workflow</h3>
                <p>Step-by-step guide for investigating alerts and hunting threats in Microsoft Sentinel using KQL, workbooks, and incident tools.</p>

                <h4>Incident Response Lifecycle in Sentinel</h4>
                <p>Sentinel's incident management follows the NIST Cybersecurity Framework's incident response phases:</p>
                <ol>
                    <li><strong>Detection:</strong> Analytics rules correlate events and generate alerts; multiple related alerts coalesce into a single incident</li>
                    <li><strong>Triage:</strong> Review incident severity (Informational, Low, Medium, High), entities involved, and automated investigation results</li>
                    <li><strong>Investigation:</strong> Use investigation graph to visualize relationships; pivot to logs for detailed forensics</li>
                    <li><strong>Containment:</strong> Execute playbooks for automated response (disable accounts, isolate devices)</li>
                    <li><strong>Remediation:</strong> Apply fixes and restore normal operations</li>
                    <li><strong>Post-Incident:</strong> Document findings, update detection rules, conduct lessons learned</li>
                </ol>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Sentinel Incident Playbook - Step-by-Step:</strong>
                    <ol>
                        <li><strong>Incident Overview:</strong> Review entities (accounts, hosts, IPs), evidence timeline, severity assignment, and alert grouping logic</li>
                        <li><strong>Investigation Graph:</strong> Expand entities to visualize related alerts, processes, network connections, and file activities; identify lateral movement paths</li>
                        <li><strong>View in Logs:</strong> Pivot to KQL queries with entity context pre-populated; run targeted investigations (queries below)</li>
                        <li><strong>Workbooks Analysis:</strong> Open Identity/Endpoint/Email workbooks scoped to incident entities for contextual pivots</li>
                        <li><strong>Automated Response:</strong> Trigger Logic Apps playbooks for containment (account disable, device isolation via Defender, ticket creation)</li>
                        <li><strong>Documentation:</strong> Update incident with timeline, root cause analysis, MITRE ATT&CK tactics/techniques, actions taken, and lessons learned</li>
                    </ol>
                </div>

                <h3>Investigation Portal Navigation</h3>
                <p><strong>Best Practices for Efficient Incident Handling:</strong></p>
                <ol>
                    <li><strong>Incidents Dashboard:</strong> Navigate to <em>Incidents</em> blade ‚Üí filter by status (New, Active, Closed), severity, and assignment; use bulk operations for efficiency</li>
                    <li><strong>Incident Details:</strong> Select incident ‚Üí review <em>Full Details</em> pane showing alert count, entity mapping, and incident timeline</li>
                    <li><strong>Evidence & Response:</strong> Examine correlated alerts, bookmarked logs, and automated investigation results; assign owner and adjust severity based on findings</li>
                    <li><strong>Investigation Graph:</strong> Click <em>Investigate</em> ‚Üí expand entity nodes to reveal relationships; right-click entities for contextual queries</li>
                    <li><strong>Logs Pivot:</strong> Use <em>View in Logs</em> button to transition to Log Analytics with entity filters pre-applied; modify timeframes and add custom filters</li>
                    <li><strong>Workbooks:</strong> Access <em>Workbooks</em> gallery ‚Üí select domain-specific workbooks (Identity & Access, Insider Threat, Threat Intelligence); filter by incident entities</li>
                    <li><strong>Playbook Execution:</strong> Trigger manual or automated playbooks from incident actions menu; monitor execution in Logic Apps run history</li>
                </ol>
                
                <div class="tip">
                    <strong>üí° Investigation Graph Tips:</strong>
                    <ul>
                        <li>Use <strong>Related Alerts</strong> to identify if the same attacker targeted multiple systems</li>
                        <li><strong>Timeline view</strong> reveals the attack sequence and dwell time</li>
                        <li><strong>Entity insights</strong> provide UEBA scores, historical behavior, and threat intelligence matches</li>
                        <li><strong>Bookmarks</strong> allow you to save interesting queries and findings for reporting</li>
                    </ul>
                </div>

                <h3>KQL Investigation Query Library</h3>
                <p>The following queries are organized by investigation scenario and aligned with MITRE ATT&CK framework techniques. Each query includes detection logic, expected results, and tuning recommendations.</p>

                <h4>1. Agent Health and Data Coverage</h4>
                <p><strong>Investigation Context:</strong> Before investigating security incidents, verify that data sources are operational. Missing logs can create blind spots where attacker activity goes undetected.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Query the Heartbeat table to identify agents that haven't reported recently. Healthy agents send heartbeats every 30 seconds; anything older than 1 hour indicates potential issues.
                </div>
                <div class="query-box">
<code>// Identify agents with missing heartbeats (potential coverage gaps)
Heartbeat
| summarize LastHeartbeat = max(TimeGenerated) by Computer, OSType, Category
| where LastHeartbeat < ago(1h)
| extend TimeSinceLastBeat = now() - LastHeartbeat
| project Computer, OSType, Category, LastHeartbeat, TimeSinceLastBeat
| order by TimeSinceLastBeat desc</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>summarize max():</strong> Finds the most recent heartbeat for each computer, handling duplicate entries</li>
                    <li><strong>where LastHeartbeat < ago(1h):</strong> Filters to agents silent for over 1 hour (adjust threshold based on environment)</li>
                    <li><strong>extend TimeSinceLastBeat:</strong> Calculates time delta for prioritization</li>
                    <li><strong>Category field:</strong> Indicates agent type (Direct Agent, Azure VM, Azure Security Center)</li>
                </ul>
                <p><strong>Troubleshooting Steps:</strong></p>
                <ul>
                    <li><strong>Network issues:</strong> Verify firewall rules allow TCP 443 to *.ods.opinsights.azure.com</li>
                    <li><strong>Agent service:</strong> Check if HealthService (Windows) or omsagent (Linux) is running</li>
                    <li><strong>Authentication:</strong> Validate workspace ID and key configuration</li>
                    <li><strong>Disk space:</strong> Agents fail when disk is full; check /var/opt/microsoft/omsagent (Linux) or C:\Program Files\Microsoft Monitoring Agent (Windows)</li>
                </ul>
                <p><strong>MITRE ATT&CK:</strong> T1562.001 (Impair Defenses: Disable or Modify Tools) - Attackers may stop monitoring agents</p>

                <h4>2. Brute Force Detection: Failed-to-Successful Authentication (Azure AD)</h4>
                <p><strong>Threat Context:</strong> Password spray and credential stuffing attacks generate numerous failed authentication attempts before eventually succeeding with valid credentials. This pattern (failures followed by success from the same IP) indicates a successful compromise.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Use time-windowed aggregation to identify IPs or users with multiple failures followed by a successful login within a short timeframe (15 minutes).
                </div>
                <div class="query-box">
<code>// Detect successful logins after multiple failures (brute force indicators)
let threshold = 5;             // Minimum failed attempts
let timeWindow = 15m;          // Time window for correlation
SigninLogs
| where TimeGenerated > ago(24h)
| extend ResultDescription = iif(ResultType == "0", "Success", "Failure")
| project TimeGenerated, UserPrincipalName, IPAddress, ResultType, ResultDescription, Location, AppDisplayName
| summarize 
    FailureCount = countif(ResultType != "0"), 
    SuccessCount = countif(ResultType == "0"),
    Applications = make_set(AppDisplayName),
    Locations = make_set(Location)
    by bin(TimeGenerated, timeWindow), UserPrincipalName, IPAddress
| where FailureCount >= threshold and SuccessCount > 0
| project TimeGenerated, UserPrincipalName, IPAddress, FailureCount, SuccessCount, Applications, Locations
| order by FailureCount desc</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>let statements:</strong> Define variables for easy threshold tuning without modifying query logic</li>
                    <li><strong>ResultType == "0":</strong> Azure AD uses 0 for success; non-zero codes indicate specific failure reasons</li>
                    <li><strong>bin(TimeGenerated, timeWindow):</strong> Creates time buckets for aggregation; prevents correlation across unrelated timeframes</li>
                    <li><strong>countif():</strong> Conditional counting within summarize operation</li>
                    <li><strong>make_set():</strong> Aggregates unique values into an array; useful for seeing which apps/locations were involved</li>
                </ul>
                <p><strong>Investigation Steps:</strong></p>
                <ul>
                    <li><strong>IP Reputation:</strong> Check IPAddress against threat intelligence feeds (VirusTotal, AbuseIPDB)</li>
                    <li><strong>Geolocation:</strong> Verify if Location matches user's typical access patterns</li>
                    <li><strong>Account Review:</strong> Check if UserPrincipalName has been compromised before or has privileged access</li>
                    <li><strong>Failure Codes:</strong> Add ResultType to project to see specific failure reasons (50126=invalid password, 50053=locked account)</li>
                </ul>
                <p><strong>False Positives:</strong></p>
                <ul>
                    <li>Users genuinely forgetting passwords and retrying</li>
                    <li>Automated scripts with incorrect credentials that eventually succeed</li>
                    <li>VPN reconnections generating multiple authentication attempts</li>
                </ul>
                <p><strong>Tuning Recommendations:</strong> Adjust threshold (currently 5) based on baseline. Create exception list for service accounts and known automation.</p>
                <p><strong>MITRE ATT&CK:</strong> T1110.003 (Brute Force: Password Spraying), T1110.004 (Brute Force: Credential Stuffing)</p>

                <h4>3. Suspicious PowerShell Execution (Defender for Endpoint)</h4>
                <p><strong>Threat Context:</strong> PowerShell is a powerful administration tool frequently abused by attackers for execution, lateral movement, and data exfiltration. Encoded commands, download cradles, and reflection-based execution are strong indicators of malicious activity.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Search process creation events for PowerShell with suspicious command-line arguments commonly used in attacks.
                </div>
                <div class="query-box">
<code>// Detect malicious PowerShell patterns (encoding, web downloads, reflective loading)
DeviceProcessEvents
| where TimeGenerated > ago(1d)
| where FileName =~ "powershell.exe" or FileName =~ "pwsh.exe"
| where ProcessCommandLine has_any (
    "-enc", "-encodedcommand",           // Base64 encoded commands
    "DownloadString", "DownloadFile",     // Web download cradles
    "Invoke-Expression", "IEX",           // Dynamic code execution
    "Invoke-WebRequest", "iwr",           // HTTP requests
    "Net.WebClient",                      // .NET web client
    "FromBase64String",                   // Decoding operations
    "Reflection.Assembly",                // Reflective loading
    "-nop", "-noprofile",                 // Stealth options
    "-w hidden", "-windowstyle hidden",   // Hidden window
    "bypass"                              // Execution policy bypass
)
| project TimeGenerated, DeviceName, AccountName, FileName, ProcessCommandLine, InitiatingProcessFileName, InitiatingProcessCommandLine
| order by TimeGenerated desc</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>=~ operator:</strong> Case-insensitive comparison; PowerShell can be invoked as powershell.exe, POWERSHELL.EXE, etc.</li>
                    <li><strong>has_any():</strong> Efficient multi-pattern matching; optimized for performance compared to multiple OR conditions</li>
                    <li><strong>InitiatingProcess fields:</strong> Shows parent process that launched PowerShell; helps identify if started by Office documents, browsers, or other suspicious sources</li>
                </ul>
                <p><strong>Attack Patterns Detected:</strong></p>
                <ul>
                    <li><strong>-enc / -encodedcommand:</strong> Base64 encoding obfuscates malicious payloads; decode with: <code>[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String("base64_string"))</code></li>
                    <li><strong>DownloadString + IEX:</strong> Fileless malware pattern; downloads and executes scripts in memory without touching disk</li>
                    <li><strong>Reflection.Assembly:</strong> Reflective PE injection; loads .NET assemblies directly into memory to evade antivirus</li>
                    <li><strong>-noprofile -windowstyle hidden:</strong> Stealth flags indicating attempt to avoid detection</li>
                </ul>
                <p><strong>Investigation Steps:</strong></p>
                <ul>
                    <li><strong>Decode commands:</strong> Extract Base64 strings and decode to reveal true intent</li>
                    <li><strong>Network analysis:</strong> If DownloadString detected, query DeviceNetworkEvents for destination URLs and IPs</li>
                    <li><strong>File analysis:</strong> Check if InitiatingProcess is a document (Excel, Word) indicating macro-based attack</li>
                    <li><strong>Lateral movement:</strong> Search for same AccountName executing PowerShell on other devices</li>
                </ul>
                <p><strong>False Positives:</strong> Legitimate administration scripts may use some patterns (DownloadString for updates, -noprofile for automation). Whitelist known administrative accounts and script hashes.</p>
                <p><strong>MITRE ATT&CK:</strong> T1059.001 (Command and Scripting Interpreter: PowerShell), T1027 (Obfuscated Files or Information), T1620 (Reflective Code Loading)</p>

                <h4>4. Large Outbound Data Transfers (Data Exfiltration)</h4>
                <p><strong>Threat Context:</strong> After achieving objectives, attackers exfiltrate sensitive data to external destinations. Large data transfers to non-corporate IPs, especially outside business hours, indicate potential data theft.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Aggregate firewall/proxy logs to identify sources generating unusually large outbound traffic volumes to external destinations.
                </div>
                <div class="query-box">
<code>// Identify potential data exfiltration based on high-volume outbound transfers
let threshold = 500;  // MB threshold
CommonSecurityLog
| where TimeGenerated > ago(24h) 
| where DeviceAction =~ "ALLOW" or DeviceAction =~ "ACCEPT"
| extend TotalBytes = coalesce(SentBytes, 0) + coalesce(ReceivedBytes, 0)
| extend BytesMB = toreal(TotalBytes) / 1024 / 1024
| where BytesMB > threshold
| where not(ipv4_is_private(DestinationIP))  // Exclude internal RFC1918 addresses
| summarize 
    TotalMB = sum(BytesMB),
    ConnectionCount = count(),
    FirstSeen = min(TimeGenerated),
    LastSeen = max(TimeGenerated),
    Ports = make_set(DestinationPort)
    by SourceIP, DestinationIP, DeviceVendor
| extend Duration = LastSeen - FirstSeen
| project SourceIP, DestinationIP, TotalMB, ConnectionCount, Duration, Ports, DeviceVendor, FirstSeen, LastSeen
| order by TotalMB desc</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>coalesce():</strong> Returns first non-null value; handles missing byte count fields gracefully</li>
                    <li><strong>ipv4_is_private():</strong> Built-in function identifying RFC1918 addresses (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16); filters out legitimate internal traffic</li>
                    <li><strong>make_set(DestinationPort):</strong> Collects unique ports used; helps identify protocols (443=HTTPS, 22=SSH/SCP, 3389=RDP)</li>
                    <li><strong>Duration calculation:</strong> Time span between first and last connection; prolonged connections suggest sustained exfiltration</li>
                </ul>
                <p><strong>Exfiltration Indicators:</strong></p>
                <ul>
                    <li><strong>Cloud storage services:</strong> High uploads to AWS S3, Azure Blob, Dropbox, Google Drive (may need to parse DestinationHostName)</li>
                    <li><strong>Unusual ports:</strong> Data exfiltration over DNS (port 53), SSH (port 22), or custom ports</li>
                    <li><strong>Off-hours activity:</strong> Large transfers outside business hours when legitimate bulk operations are unlikely</li>
                    <li><strong>Repeated small transfers:</strong> Modify to detect frequency patterns with bin() for slow-and-steady exfiltration</li>
                </ul>
                <p><strong>Investigation Steps:</strong></p>
                <ul>
                    <li><strong>Source identification:</strong> Determine if SourceIP is a workstation, server, or IoT device; correlate with asset inventory</li>
                    <li><strong>Destination reputation:</strong> Check DestinationIP against threat intelligence; identify hosting provider and geolocation</li>
                    <li><strong>User context:</strong> Join with authentication logs to identify which user account was active on SourceIP during exfiltration window</li>
                    <li><strong>Baseline comparison:</strong> Compare current volume to historical baseline for the source system</li>
                </ul>
                <p><strong>False Positives:</strong> Legitimate cloud backups, software updates, media streaming servers, database replication. Whitelist known backup destinations and service accounts.</p>
                <p><strong>MITRE ATT&CK:</strong> T1048 (Exfiltration Over Alternative Protocol), T1041 (Exfiltration Over C2 Channel)</p>

                <h4>5. Anomalous Authentication: Rare Logon Locations (Azure AD)</h4>
                <p><strong>Threat Context:</strong> Attackers using stolen credentials typically authenticate from geographical locations inconsistent with user's normal behavior. Detecting authentications from new or rare countries/cities can reveal account compromise.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Compare historical login locations (7-day baseline) against recent activity (last 24 hours) to identify new geographical sources.
                </div>
                <div class="query-box">
<code>// Detect logins from rare or new geographic locations
let baseline_period = 7d;
let detection_period = 1d;
let historical_locations = SigninLogs
    | where TimeGenerated between (ago(baseline_period) .. ago(detection_period))
    | where ResultType == "0"  // Only successful logins
    | extend Country = tostring(LocationDetails.countryOrRegion)
    | summarize HistoricalCount = count() by UserPrincipalName, Country;
SigninLogs
| where TimeGenerated > ago(detection_period)
| where ResultType == "0"
| extend Country = tostring(LocationDetails.countryOrRegion)
| extend City = tostring(LocationDetails.city)
| summarize RecentCount = count(), IPAddresses = make_set(IPAddress) by UserPrincipalName, Country, City
| join kind=leftanti (historical_locations) on UserPrincipalName, Country
| where RecentCount > 0
| project UserPrincipalName, Country, City, RecentCount, IPAddresses
| order by RecentCount desc</code>
                </div>
                <p><strong>Query Analysis:</strong></p>
                <ul>
                    <li><strong>let with subquery:</strong> Creates reusable dataset for baseline comparison; improves performance by calculating once</li>
                    <li><strong>between operator:</strong> Defines precise time range excluding overlap with detection window</li>
                    <li><strong>tostring(LocationDetails.countryOrRegion):</strong> Extracts nested JSON field; LocationDetails is a dynamic type requiring explicit casting</li>
                    <li><strong>leftanti join:</strong> Returns records from left table with NO match in right table; effectively finds new locations</li>
                </ul>
                <p><strong>Enhanced Detection Variants:</strong></p>
                <ul>
                    <li><strong>Impossible travel:</strong> Calculate distance/time between consecutive logins; flag if travel speed exceeds 500 mph</li>
                    <li><strong>Risk score integration:</strong> Include RiskLevelDuringSignIn and RiskLevelAggregated fields from SigninLogs</li>
                    <li><strong>Device consistency:</strong> Add DeviceDetail.deviceId to detect same account from new device in new location</li>
                    <li><strong>VPN detection:</strong> Some VPNs are legitimate; correlate with known VPN ranges or UserAgent strings</li>
                </ul>
                <p><strong>Investigation Steps:</strong></p>
                <ul>
                    <li><strong>User verification:</strong> Contact user to confirm if travel or VPN usage is legitimate</li>
                    <li><strong>IP analysis:</strong> Check IPAddresses for known VPN providers, hosting providers, or Tor exit nodes</li>
                    <li><strong>Access patterns:</strong> Review AppDisplayName to see which services were accessed (anomalous app access increases suspicion)</li>
                    <li><strong>Session revocation:</strong> If confirmed compromise, revoke all active sessions via Azure AD or execute playbook</li>
                </ul>
                <p><strong>False Positives:</strong> Business travel, VPN usage, remote work from new locations. Implement user-specific baselines and travel notification system.</p>
                <p><strong>MITRE ATT&CK:</strong> T1078 (Valid Accounts), T1133 (External Remote Services)</p>

                <h4>6. Privilege Escalation Detection (Windows Security Events)</h4>
                <p><strong>Threat Context:</strong> Attackers elevate privileges to gain administrative control. Monitoring sensitive Windows Event IDs reveals privilege changes, security group modifications, and credential theft attempts.</p>
                <div class="query-box">
<code>// Monitor privilege escalation activities
SecurityEvent
| where TimeGenerated > ago(24h)
| where EventID in (
    4672,  // Special privileges assigned to new logon
    4673,  // Privileged service called
    4674,  // Privileged operation attempted
    4688,  // Process creation (with command line)
    4732,  // Member added to security-enabled local group
    4756   // Member added to security-enabled universal group
)
| extend AccountType = case(
    EventID == 4672, "Privileged Logon",
    EventID == 4732 or EventID == 4756, "Group Modification",
    EventID == 4688, "Process Creation",
    "Privileged Operation"
)
| project TimeGenerated, Computer, Account, EventID, AccountType, Activity, Process, CommandLine
| order by TimeGenerated desc</code>
                </div>
                <p><strong>Key Event IDs:</strong></p>
                <ul>
                    <li><strong>4672:</strong> Special privileges assigned (includes SeDebugPrivilege, often abused for process injection)</li>
                    <li><strong>4688:</strong> Process creation with command line; detects privilege escalation tools (mimikatz, PsExec)</li>
                    <li><strong>4732/4756:</strong> User added to privileged groups (Administrators, Domain Admins)</li>
                    <li><strong>4673:</strong> Sensitive privilege use (e.g., SeBackupPrivilege for reading arbitrary files)</li>
                </ul>
                <p><strong>MITRE ATT&CK:</strong> T1068 (Exploitation for Privilege Escalation), T1134 (Access Token Manipulation)</p>

                <div class="tip">
                    <strong>üí° Sentinel Hunting Best Practices:</strong>
                    <ul>
                        <li><strong>Time optimization:</strong> Start with narrow time ranges (1h, 6h) before expanding to 24h or 7d</li>
                        <li><strong>Hypothesis-driven:</strong> Begin with MITRE ATT&CK technique and work backward to log sources</li>
                        <li><strong>Bookmark findings:</strong> Save interesting queries and results for future reference and reporting</li>
                        <li><strong>Use workbooks:</strong> Pre-built workbooks provide contextualized views faster than custom queries</li>
                        <li><strong>Threat intelligence:</strong> Integrate ThreatIntelligenceIndicator table with queries using join operations</li>
                        <li><strong>Automation:</strong> Convert validated hunting queries to scheduled analytics rules</li>
                    </ul>
                </div>


                <h3>Advanced Hunting and Detection Engineering</h3>
                <p>Proactive threat hunting goes beyond alerts to discover unknown threats lurking in your environment.</p>
                
                <h4>Hunting Workflow</h4>
                <ol>
                    <li><strong>Hypothesis Development:</strong> Based on threat intelligence, recent breaches, or anomaly observations, formulate a threat hypothesis (e.g., "Are there lateral movement attempts in our environment?")</li>
                    <li><strong>Query Construction:</strong> Navigate to <em>Hunting</em> blade ‚Üí select relevant queries from Microsoft's curated library or write custom KQL</li>
                    <li><strong>Data Exploration:</strong> Run queries against last 24 hours initially; expand timeframe if patterns require longer baselines</li>
                    <li><strong>Result Analysis:</strong> Review results ‚Üí add entity mappings if missing ‚Üí bookmark suspicious findings</li>
                    <li><strong>Incident Creation:</strong> For true positives, create new incident or link to existing incident</li>
                    <li><strong>Rule Operationalization:</strong> Convert validated hunts to scheduled analytics rules with appropriate suppression</li>
                </ol>
                
                <h4>Analytics Rule Types</h4>
                <ul>
                    <li><strong>Scheduled:</strong> KQL queries run at intervals (every 5m to 14 days); most common rule type for custom detections</li>
                    <li><strong>Microsoft Security:</strong> Automatically converts alerts from Microsoft Defender, Azure Defender, and other Microsoft security products into Sentinel incidents</li>
                    <li><strong>Fusion:</strong> ML-powered correlation engine that links multiple low/medium severity signals into high-confidence incidents</li>
                    <li><strong>ML Behavior Analytics:</strong> Uses machine learning models to detect anomalies (impossible travel, anomalous login patterns)</li>
                    <li><strong>Threat Intelligence:</strong> Matches IoCs from TI feeds against logs (IPs, domains, file hashes)</li>
                </ul>
                
                <h4>Detection Rule Best Practices</h4>
                <ul>
                    <li><strong>Entity mapping:</strong> Always map to entities (Account, Host, IP, FileHash, URL) for investigation graph population</li>
                    <li><strong>Alert enrichment:</strong> Include context in alert descriptions using dynamic variables (e.g., {{UserPrincipalName}} attempted suspicious action)</li>
                    <li><strong>Suppression:</strong> Use alert grouping to prevent 1000 alerts for same incident; group by entity or custom field</li>
                    <li><strong>Threshold tuning:</strong> Start conservative (high threshold) then lower as false positives are managed</li>
                    <li><strong>Query optimization:</strong> Rules have 10-minute query timeout; optimize using techniques from earlier section</li>
                    <li><strong>MITRE tagging:</strong> Tag rules with ATT&CK techniques for coverage tracking and reporting</li>
                </ul>

                <h3>Automation and Orchestration with Playbooks</h3>
                <p>Sentinel playbooks are Azure Logic Apps workflows that automate response actions, enrichment, and notifications.</p>
                
                <h4>Common Playbook Use Cases</h4>
                <ul>
                    <li><strong>Automated Enrichment:</strong> Query threat intelligence APIs (VirusTotal, IPinfo, DomainTools) and add results as comments</li>
                    <li><strong>Containment Actions:</strong> Disable compromised Azure AD accounts, isolate devices via Defender, block IPs in firewall</li>
                    <li><strong>Ticket Integration:</strong> Automatically create ServiceNow/Jira tickets for High severity incidents</li>
                    <li><strong>Notification:</strong> Send Teams/Slack messages or emails to on-call analysts</li>
                    <li><strong>Data Collection:</strong> Trigger Defender live response to collect forensic artifacts</li>
                </ul>
                
                <h4>Triggering Playbooks</h4>
                <ul>
                    <li><strong>Automation rules:</strong> Set conditions (severity=High, tag=VIP) to automatically run playbooks on incident creation</li>
                    <li><strong>Manual execution:</strong> Run playbooks on-demand from incident actions menu</li>
                    <li><strong>Alert-based:</strong> Configure analytics rules to trigger specific playbooks when alerts fire</li>
                </ul>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Playbook Security Considerations:</strong>
                    <ul>
                        <li><strong>Least privilege:</strong> Assign minimum required permissions to Sentinel managed identity</li>
                        <li><strong>Approval gates:</strong> Add human approval steps for destructive actions (account deletion, device isolation)</li>
                        <li><strong>Error handling:</strong> Implement try-catch logic to prevent playbook failures from breaking response workflows</li>
                        <li><strong>Audit logging:</strong> All playbook executions are logged; review regularly for unauthorized usage</li>
                    </ul>
                </div>

                <h3>Data Onboarding and Management</h3>
                
                <h4>Log Onboarding Checklist</h4>
                <ol>
                    <li><strong>Connector Configuration:</strong> Navigate to <em>Data Connectors</em> ‚Üí verify status shows <strong>Connected</strong> for all critical sources (M365, Defender, Azure AD, firewalls, EDR)</li>
                    <li><strong>Data Validation:</strong> Query each table (SecurityEvent, SigninLogs, etc.) to confirm logs are flowing; check TimeGenerated for recent data</li>
                    <li><strong>Analytics Rule Enablement:</strong> Enable out-of-the-box rules relevant to new data sources; map entities correctly; tune thresholds</li>
                    <li><strong>Retention Configuration:</strong> Set interactive retention (default 90 days) and archive retention (up to 7 years) per table based on compliance requirements</li>
                    <li><strong>Cost Management:</strong> Configure daily ingestion caps; monitor costs in <em>Usage and Estimated Costs</em>; implement data collection rules to filter noisy logs</li>
                    <li><strong>Health Monitoring:</strong> Create alert for data connector failures; schedule regular reviews of Heartbeat and _LogOperation tables</li>
                    <li><strong>Smoke Testing:</strong> Generate test events (failed logins, EICAR file, firewall allow) and confirm detection in <em>Logs</em> and <em>Incidents</em></li>
                </ol>
                
                <h4>Data Retention and Cost Optimization</h4>
                <ul>
                    <li><strong>Interactive vs. Archive:</strong> Interactive retention (searchable via Log Analytics) is expensive; use archive for compliance-only data</li>
                    <li><strong>Basic Logs:</strong> Lower-cost tier for verbose logs (firewall, web proxy); limited query capabilities but significant cost savings</li>
                    <li><strong>Transformation Rules:</strong> Filter/transform data at ingestion to reduce volume (e.g., drop debug-level events)</li>
                    <li><strong>Table-level settings:</strong> Configure retention per table; don't pay for 90-day retention on low-value logs</li>
                    <li><strong>Commitment tiers:</strong> Pre-purchase ingestion capacity for 30-50% discount if volume is predictable</li>
                </ul>

                <h3>Incident Closure and Documentation</h3>
                <p>Proper incident closure ensures organizational learning and continuous improvement.</p>
                
                <h4>Closure Workflow</h4>
                <ol>
                    <li><strong>Timeline Documentation:</strong> Summarize chronological sequence: initial detection, lateral movement, containment actions, and eradication</li>
                    <li><strong>Root Cause Analysis:</strong> Identify initial access vector and vulnerabilities exploited; document how detection could be improved</li>
                    <li><strong>Impact Assessment:</strong> Define scope (number of systems, data accessed, users affected) and business impact</li>
                    <li><strong>Actions Taken:</strong> List all response actions with timestamps (accounts disabled, devices isolated, passwords reset)</li>
                    <li><strong>MITRE ATT&CK Mapping:</strong> Tag incident with observed tactics and techniques; improves threat landscape understanding</li>
                    <li><strong>Evidence Preservation:</strong> Link to bookmarked queries, screenshots, and exported logs for legal/compliance requirements</li>
                    <li><strong>Lessons Learned:</strong> Document what went well and what needs improvement; create follow-up tasks for detection gaps</li>
                    <li><strong>Status Update:</strong> Set closure classification (True Positive, False Positive, Benign Positive) and add detailed closure notes</li>
                </ol>
                
                <h4>Post-Incident Improvement Actions</h4>
                <ul>
                    <li><strong>Rule tuning:</strong> Adjust thresholds or add exclusions if false positive; create new rules for detection gaps</li>
                    <li><strong>Playbook updates:</strong> Enhance automation based on manual steps performed during investigation</li>
                    <li><strong>Threat intelligence:</strong> Add identified IoCs to watchlists or threat intelligence platform</li>
                    <li><strong>Workbook enhancements:</strong> Add visualizations or panels that would have accelerated investigation</li>
                    <li><strong>Training:</strong> Share findings with SOC team; update runbooks and standard operating procedures</li>
                </ul>
                
                <div class="tip">
                    <strong>üí° Sentinel Resources:</strong>
                    <ul>
                        <li><strong>Content Hub:</strong> Browse and install solution packages with pre-built rules, workbooks, and playbooks for specific technologies</li>
                        <li><strong>Repositories:</strong> Sentinel community GitHub (Azure/Azure-Sentinel) contains 800+ hunting queries and detection rules</li>
                        <li><strong>Notebooks:</strong> Jupyter notebooks for advanced hunting and investigation with Python and KQL</li>
                        <li><strong>MSSP capabilities:</strong> Multi-tenant architecture for managed security service providers</li>
                        <li><strong>API access:</strong> Automate incident management and query execution via REST API</li>
                    </ul>
                </div>
            </div>


            <!-- Cloud Security for SOC Section -->
            <div id="cloud-security" class="section">
                <h2>‚òÅÔ∏è Cloud Security for SOC Analysts</h2>
                
                <h3>Introduction to Cloud Security</h3>
                <p>Cloud adoption has accelerated dramatically, driven by digital transformation, work-from-home models, and the need for scalability. As organizations migrate to the cloud, SOC analysts must understand cloud-specific security challenges, tools, and incident response procedures.</p>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Key Insight:</strong> Simply migrating applications to the cloud doesn't automatically improve security or reduce costs. Effective cloud security requires understanding cloud service models, shared responsibility models, and cloud-native security tools.
                </div>
                
                <h3>Cloud Service Models</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Model</th>
                                <th>Provider Manages</th>
                                <th>Customer Manages</th>
                                <th>Examples</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>SaaS</strong> (Software as a Service)</td>
                                <td>Everything: Infrastructure, platform, applications</td>
                                <td>User access, data, configurations</td>
                                <td>Gmail, Salesforce, Office 365</td>
                            </tr>
                            <tr>
                                <td><strong>PaaS</strong> (Platform as a Service)</td>
                                <td>Infrastructure, OS, middleware</td>
                                <td>Applications, data, runtime</td>
                                <td>Azure App Services, Google App Engine</td>
                            </tr>
                            <tr>
                                <td><strong>IaaS</strong> (Infrastructure as a Service)</td>
                                <td>Physical infrastructure, networking, virtualization</td>
                                <td>OS, applications, data, security controls</td>
                                <td>AWS EC2, Azure VMs, Google Compute Engine</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>Cloud Deployment Models</h3>
                <ul>
                    <li><strong>Public Cloud:</strong> Multi-tenant environment accessible to all, managed by provider (AWS, Azure, GCP). Pay-per-use model with shared resources.</li>
                    <li><strong>Private Cloud:</strong> Dedicated environment for a single organization, offering enhanced security and control but higher costs.</li>
                    <li><strong>Community Cloud:</strong> Shared infrastructure for organizations with common requirements (e.g., government agencies, healthcare).</li>
                    <li><strong>Hybrid Cloud:</strong> Combination of public and private clouds, allowing segregation of sensitive data while leveraging public cloud benefits.</li>
                    <li><strong>Multi-Cloud:</strong> Use of multiple cloud providers to avoid vendor lock-in and optimize for specific services.</li>
                </ul>
                
                <h3>Cloud Security Challenges</h3>
                
                <h4>Common Risks in Cloud Computing</h4>
                <ul>
                    <li><strong>Shared Responsibility Confusion:</strong> Misunderstanding who (provider vs. customer) is responsible for specific security controls.</li>
                    <li><strong>Limited Cloud Security Expertise:</strong> Traditional security skills don't directly translate to cloud environments.</li>
                    <li><strong>Misconfigurations:</strong> Public S3 buckets, overly permissive IAM policies, unsecured storage accounts (leading cause of cloud breaches).</li>
                    <li><strong>Identity and Access Management (IAM) Complexity:</strong> Managing permissions across numerous cloud services and accounts.</li>
                    <li><strong>Inadequate Visibility:</strong> Traditional network security tools may not work in dynamic cloud environments.</li>
                    <li><strong>Data Residency and Compliance:</strong> Ensuring data is stored in compliant regions and meets regulatory requirements.</li>
                    <li><strong>Shadow IT:</strong> Unauthorized cloud services used by employees without IT/Security knowledge.</li>
                </ul>
                
                <h3>Cloud Security Tooling</h3>
                
                <h4>Cloud Security Posture Management (CSPM)</h4>
                <p>CSPM tools continuously monitor cloud environments for misconfigurations, compliance violations, and security risks.</p>
                <ul>
                    <li><strong>Key Features:</strong> Configuration scanning, compliance mapping (CIS, PCI-DSS, HIPAA), automated remediation recommendations</li>
                    <li><strong>Use Cases:</strong> Detecting public S3 buckets, identifying overly permissive IAM roles, ensuring encryption is enabled</li>
                    <li><strong>Examples:</strong> Prisma Cloud, Microsoft Defender for Cloud, AWS Security Hub, Wiz, Orca Security</li>
                </ul>
                
                <h4>Cloud Access Security Broker (CASB)</h4>
                <p>CASB solutions sit between users and cloud services, providing visibility and control over cloud application usage.</p>
                <ul>
                    <li><strong>Key Features:</strong> Shadow IT discovery, data loss prevention (DLP), threat protection, compliance enforcement</li>
                    <li><strong>Use Cases:</strong> Monitoring SaaS usage, preventing sensitive data uploads, detecting anomalous user behavior</li>
                    <li><strong>Examples:</strong> Microsoft Defender for Cloud Apps, Netskope, Zscaler, McAfee MVISION Cloud</li>
                </ul>
                
                <h4>Cloud Workload Protection Platform (CWPP)</h4>
                <p>CWPP protects workloads (VMs, containers, serverless) across hybrid and multi-cloud environments.</p>
                <ul>
                    <li><strong>Key Features:</strong> Vulnerability management, runtime protection, behavioral monitoring, container security</li>
                    <li><strong>Use Cases:</strong> Securing EC2 instances, protecting Docker containers, serverless function security</li>
                    <li><strong>Examples:</strong> Palo Alto Prisma Cloud, Aqua Security, Sysdig, Trend Micro Cloud One</li>
                </ul>
                
                <h4>Cloud Infrastructure Entitlement Management (CIEM)</h4>
                <p>CIEM tools manage and govern cloud identities, permissions, and entitlements to prevent privilege escalation and unauthorized access.</p>
                <ul>
                    <li><strong>Key Features:</strong> Least privilege enforcement, permission analytics, unused permission detection, just-in-time access</li>
                    <li><strong>Use Cases:</strong> Identifying overprivileged accounts, removing unused permissions, detecting privilege escalation attempts</li>
                    <li><strong>Examples:</strong> Ermetic, CloudKnox (now Microsoft Entra Permissions Management), Sonrai Security</li>
                </ul>
                
                <h3>Cloud-Specific Incident Response</h3>
                
                <h4>Incident Response Considerations in the Cloud</h4>
                <ul>
                    <li><strong>Ephemeral Resources:</strong> Cloud resources can be terminated quickly, destroying evidence. Implement automated snapshotting and logging.</li>
                    <li><strong>API-Driven Investigations:</strong> Use cloud provider APIs and CLI tools (AWS CLI, Azure CLI, gcloud) for investigation and forensics.</li>
                    <li><strong>Cloud-Native Logs:</strong> Leverage CloudTrail (AWS), Azure Activity Logs, GCP Cloud Logging for audit trails and activity monitoring.</li>
                    <li><strong>Shared Responsibility:</strong> Understand that you cannot access provider-level logs or infrastructure. Focus on what you control.</li>
                    <li><strong>Multi-Account Strategies:</strong> Isolate compromised accounts, use AWS Organizations or Azure Management Groups for containment.</li>
                </ul>
                
                <h4>Common Cloud Attack Vectors</h4>
                <ul>
                    <li><strong>Compromised IAM Credentials:</strong> Stolen access keys, compromised service principals leading to unauthorized access</li>
                    <li><strong>Misconfigured Storage:</strong> Public S3 buckets, Azure Blob containers exposing sensitive data</li>
                    <li><strong>Privilege Escalation:</strong> Exploiting overly permissive IAM policies to gain administrative access</li>
                    <li><strong>API Abuse:</strong> Exploiting weakly secured APIs to access cloud resources</li>
                    <li><strong>Container Escapes:</strong> Breaking out of containers to access underlying host systems</li>
                    <li><strong>Serverless Injection:</strong> Injecting malicious code into serverless functions</li>
                </ul>
                
                <h4>Cloud Investigation Query Examples</h4>
                
                <h5>AWS CloudTrail - Detect Unauthorized Access Key Usage</h5>
                <div class="code-block">
                    <code>
aws cloudtrail lookup-events --lookup-attributes AttributeKey=Username,AttributeValue=SUSPICIOUS_USER --start-time 2024-01-01 --end-time 2024-01-31
                    </code>
                </div>
                
                <h5>Azure - List All Role Assignments for a User</h5>
                <div class="code-block">
                    <code>
az role assignment list --assignee user@domain.com --all
                    </code>
                </div>
                
                <h5>GCP - Query Cloud Logging for Failed Authentication</h5>
                <div class="code-block">
                    <code>
resource.type="gce_instance"
protoPayload.methodName="compute.instances.insert"
protoPayload.authenticationInfo.principalEmail="suspicious@example.com"
                    </code>
                </div>
                
                <h3>Cloud Security Certifications</h3>
                <ul>
                    <li><strong>AWS Certified Security - Specialty:</strong> Validates expertise in securing AWS workloads</li>
                    <li><strong>Microsoft Certified: Azure Security Engineer Associate:</strong> Demonstrates Azure security implementation skills</li>
                    <li><strong>Google Professional Cloud Security Engineer:</strong> Proves GCP security architecture and implementation knowledge</li>
                    <li><strong>Certified Cloud Security Professional (CCSP):</strong> Vendor-neutral cloud security certification from (ISC)¬≤</li>
                    <li><strong>Certificate of Cloud Security Knowledge (CCSK):</strong> Cloud Security Alliance's foundational cloud security certification</li>
                </ul>
                
                <div class="tip">
                    <strong>üí° Cloud Security Tip:</strong> Start with one cloud provider (AWS, Azure, or GCP) and master its security services before expanding to others. Most organizations use one primary cloud provider, making depth more valuable than breadth initially.
                </div>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Best Practice:</strong> Always assume breach in cloud environments. Implement defense-in-depth with identity-based security, encryption at rest and in transit, comprehensive logging, and automated response to security events.
                </div>
            </div>


            <!-- SOC Automation and SOAR Section -->
            <div id="soc-automation" class="section">
                <h2>ü§ñ SOC Automation and SOAR</h2>
                
                <h3>What is SOC Automation?</h3>
                <p>Security Automation, Orchestration, and Response (SOAR) refers to the machine implementation of security-related actions and workflows. Automation handles low-level repetitive tasks, while orchestration coordinates multiple automated actions across different systems to complete complex workflows.</p>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Myth Busting:</strong> Automation will NOT replace SOC analysts. Instead, it frees analysts from monotonous tasks to focus on complex analysis, threat hunting, and strategic security improvements. Automation is a force multiplier, not a replacement.
                </div>
                
                <h3>Why Automate the SOC?</h3>
                
                <h4>Key Benefits of SOC Automation</h4>
                <ul>
                    <li><strong>Reduce Analyst Fatigue:</strong> Eliminate repetitive copy-paste tasks that cause burnout and errors.</li>
                    <li><strong>Improve Response Times:</strong> Automated responses can contain threats in seconds rather than minutes or hours.</li>
                    <li><strong>Increase Consistency:</strong> Ensure the same steps are followed for similar incidents, reducing human error.</li>
                    <li><strong>Scale Operations:</strong> Handle increased alert volumes without proportionally increasing headcount.</li>
                    <li><strong>Enable Focus on High-Value Activities:</strong> Let analysts focus on threat hunting, detection engineering, and complex investigations.</li>
                    <li><strong>Improve Documentation:</strong> Automated workflows inherently document actions taken during incident response.</li>
                    <li><strong>24/7 Response Capability:</strong> Automated responses continue working after hours and on weekends.</li>
                </ul>
                
                <h4>Real-World Automation Example</h4>
                <div class="example-block">
                    <h5>Before Automation:</h5>
                    <p>Junior analyst spends hours daily handling antivirus alerts for "Potentially Unwanted Applications" (PUA). Each alert requires:</p>
                    <ol>
                        <li>Verify file was quarantined</li>
                        <li>Check if PUA or actual malware</li>
                        <li>Add notes to ticket</li>
                        <li>Close ticket</li>
                    </ol>
                    <p><strong>Result:</strong> 50+ alerts/day, no time for deeper analysis, analyst fatigue.</p>
                    
                    <h5>After Automation:</h5>
                    <p>SOAR playbook automatically:</p>
                    <ol>
                        <li>Receives PUA alert</li>
                        <li>Queries antivirus to confirm quarantine</li>
                        <li>Checks VirusTotal for file reputation</li>
                        <li>If PUA and quarantined: auto-closes with notes</li>
                        <li>If potential malware: escalates to analyst</li>
                    </ol>
                    <p><strong>Result:</strong> 45 alerts auto-resolved, 5 genuine threats escalated for investigation, analyst focuses on real threats.</p>
                </div>
                
                <h3>SOAR Platform Components</h3>
                
                <h4>Core SOAR Capabilities</h4>
                <ul>
                    <li><strong>Playbooks/Runbooks:</strong> Predefined workflows that orchestrate actions across multiple tools (SIEM, EDR, firewall, ticketing).</li>
                    <li><strong>Integrations:</strong> Connectors to security tools, threat intelligence feeds, and IT systems (200+ integrations typical).</li>
                    <li><strong>Case Management:</strong> Centralized incident tracking with evidence collection and collaboration features.</li>
                    <li><strong>Threat Intelligence Platform (TIP):</strong> Aggregates and enriches threat data from multiple sources.</li>
                    <li><strong>Reporting and Metrics:</strong> Dashboard showing time saved, mean time to respond (MTTR), automation rates.</li>
                    <li><strong>Workflow Designer:</strong> Visual drag-and-drop interface for building automation playbooks.</li>
                </ul>
                
                <h4>Popular SOAR Platforms</h4>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Platform</th>
                                <th>Strengths</th>
                                <th>Best For</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Splunk SOAR (Phantom)</strong></td>
                                <td>Extensive integrations, visual playbook builder</td>
                                <td>Splunk-centric environments</td>
                            </tr>
                            <tr>
                                <td><strong>Palo Alto Cortex XSOAR</strong></td>
                                <td>Advanced AI/ML, marketplace for playbooks</td>
                                <td>Large enterprises, complex workflows</td>
                            </tr>
                            <tr>
                                <td><strong>IBM Resilient</strong></td>
                                <td>Incident response focus, collaboration tools</td>
                                <td>Compliance-heavy industries</td>
                            </tr>
                            <tr>
                                <td><strong>Microsoft Sentinel Playbooks</strong></td>
                                <td>Azure Logic Apps integration, cloud-native</td>
                                <td>Microsoft-centric environments</td>
                            </tr>
                            <tr>
                                <td><strong>Swimlane</strong></td>
                                <td>Low-code automation, user-friendly interface</td>
                                <td>Mid-sized organizations</td>
                            </tr>
                            <tr>
                                <td><strong>Tines</strong></td>
                                <td>Modern UI, easy workflow building</td>
                                <td>Security teams wanting flexibility</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>Common SOAR Use Cases</h3>
                
                <h4>Phishing Response Automation</h4>
                <ol>
                    <li><strong>User Reports Phishing Email:</strong> Email forwarded to phishing inbox</li>
                    <li><strong>SOAR Triggers:</strong> Playbook initiates automatically</li>
                    <li><strong>Automated Actions:</strong>
                        <ul>
                            <li>Extract URLs and attachments from email</li>
                            <li>Check URL reputation (VirusTotal, URLScan)</li>
                            <li>Detonate attachment in sandbox</li>
                            <li>Search email logs for other recipients</li>
                            <li>Query EDR to see if any users clicked the link</li>
                        </ul>
                    </li>
                    <li><strong>Decision Point:</strong> If malicious, escalate and auto-quarantine; if benign, notify user and close ticket</li>
                </ol>
                
                <h4>User Account Lockout Automation</h4>
                <ol>
                    <li><strong>Alert:</strong> Multiple failed login attempts detected</li>
                    <li><strong>SOAR Actions:</strong>
                        <ul>
                            <li>Query Active Directory for account details</li>
                            <li>Check if source IPs are internal or external</li>
                            <li>Check GeoIP of source IPs</li>
                            <li>If brute force detected: automatically disable account</li>
                            <li>Send notification to user and manager</li>
                            <li>Create incident ticket with evidence</li>
                        </ul>
                    </li>
                </ol>
                
                <h4>Malware Containment</h4>
                <ol>
                    <li><strong>Alert:</strong> EDR detects malware execution</li>
                    <li><strong>SOAR Actions:</strong>
                        <ul>
                            <li>Isolate endpoint from network (via EDR)</li>
                            <li>Extract file hash and submit to sandbox</li>
                            <li>Search other endpoints for same hash</li>
                            <li>Block hash at perimeter (firewall, email gateway)</li>
                            <li>Notify analyst with enriched context</li>
                            <li>Create forensic timeline</li>
                        </ul>
                    </li>
                </ol>
                
                <h3>SOC Maturity and Automation</h3>
                
                <h4>SOC Maturity Levels</h4>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Level</th>
                                <th>Characteristics</th>
                                <th>Automation Readiness</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Level 1: Initial</strong></td>
                                <td>Ad-hoc processes, reactive, no SIEM or basic SIEM</td>
                                <td>Not ready for automation; focus on process documentation</td>
                            </tr>
                            <tr>
                                <td><strong>Level 2: Managed</strong></td>
                                <td>Documented procedures, SIEM deployed, basic alerting</td>
                                <td>Ready for simple automation (alert enrichment, ticket creation)</td>
                            </tr>
                            <tr>
                                <td><strong>Level 3: Defined</strong></td>
                                <td>Standardized workflows, multiple tools integrated, consistent response</td>
                                <td>Ready for SOAR implementation (playbooks, orchestration)</td>
                            </tr>
                            <tr>
                                <td><strong>Level 4: Quantitatively Managed</strong></td>
                                <td>Metrics-driven, continuous improvement, advanced threat detection</td>
                                <td>Advanced automation (ML-driven decisioning, self-tuning)</td>
                            </tr>
                            <tr>
                                <td><strong>Level 5: Optimizing</strong></td>
                                <td>Proactive threat hunting, predictive analytics, innovation focus</td>
                                <td>Autonomous SOC capabilities with human oversight</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>Building Your First Playbook</h3>
                
                <h4>Playbook Development Best Practices</h4>
                <ul>
                    <li><strong>Start Simple:</strong> Begin with high-volume, low-complexity tasks (e.g., ticket enrichment, alert tagging).</li>
                    <li><strong>Document Existing Process:</strong> Before automating, ensure the manual process is documented and optimized.</li>
                    <li><strong>Identify Decision Points:</strong> Determine where human judgment is required vs. where automation can decide.</li>
                    <li><strong>Build Incrementally:</strong> Add one action at a time, test thoroughly before adding more complexity.</li>
                    <li><strong>Include Error Handling:</strong> Account for API failures, timeouts, and unexpected responses.</li>
                    <li><strong>Add Logging:</strong> Ensure all automated actions are logged for audit and troubleshooting.</li>
                    <li><strong>Test in Staging:</strong> Never test playbooks in production; use test/dev environments.</li>
                    <li><strong>Measure Success:</strong> Track metrics like time saved, false positive reduction, MTTR improvement.</li>
                </ul>
                
                <h4>Example: Basic Alert Enrichment Playbook</h4>
                <div class="code-block">
                    <pre>
TRIGGER: New SIEM alert created

ACTIONS:
1. Extract IOCs (IP addresses, domains, file hashes)
2. Check IP reputation:
   - AbuseIPDB API
   - VirusTotal API
3. Check domain reputation:
   - URLScan.io
   - VirusTotal
4. Check file hash:
   - VirusTotal
   - Hybrid Analysis
5. GeoIP lookup for source IPs
6. Add all enrichment data to alert as comments
7. Tag alert with risk score based on findings
8. If high risk: escalate to Tier 2
   If low risk: auto-close with documentation

END
                    </pre>
                </div>
                
                <h3>Automation Pitfalls to Avoid</h3>
                <ul>
                    <li><strong>Over-Automation:</strong> Not everything should be automated. Complex investigations requiring context and intuition need human analysts.</li>
                    <li><strong>Automating Broken Processes:</strong> Fix inefficient processes before automating them, or you'll just do bad things faster.</li>
                    <li><strong>Lack of Oversight:</strong> Automated actions should be monitored and reviewed regularly to catch errors or drift.</li>
                    <li><strong>Insufficient Testing:</strong> Inadequate testing can lead to automated mistakes at scale (e.g., blocking legitimate users).</li>
                    <li><strong>Set-and-Forget Mentality:</strong> Playbooks need maintenance as tools, APIs, and threats evolve.</li>
                    <li><strong>Ignoring False Positives:</strong> Automation can amplify false positives if not tuned properly.</li>
                </ul>
                
                <div class="tip">
                    <strong>üí° SOAR Career Tip:</strong> Learning SOAR platforms is highly valuable. Many organizations are adopting or planning to adopt SOAR. Hands-on experience building playbooks makes you significantly more marketable. Explore free/community editions like Shuffle, TheHive, or Tines free tier.
                </div>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Remember:</strong> Automation is a tool to make analysts more effective, not to eliminate them. The goal is to let machines handle repetitive tasks so humans can focus on complex problems that require creativity, intuition, and strategic thinking.
                </div>
            </div>


            <!-- AI and ChatGPT for SOC Analysts Section -->
            <div id="ai-for-soc" class="section">
                <h2>ü§ñ AI and ChatGPT for SOC Analysts</h2>
                
                <h3>Introduction to AI in Security Operations</h3>
                <p>Large Language Models (LLMs) like ChatGPT represent a new category of tools that can assist SOC analysts with various tasks, from code analysis to documentation. However, it's crucial to understand both their capabilities and limitations, especially regarding data security and accuracy.</p>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Critical Warning:</strong> Never paste sensitive data, proprietary code, or indicators of compromise into public AI services like ChatGPT. Many organizations have policies prohibiting or restricting LLM usage. Always check your organization's acceptable use policy before using AI tools for work-related tasks.
                </div>
                
                <h3>What is ChatGPT?</h3>
                <p>ChatGPT is a Large Language Model (LLM) trained on vast amounts of internet text. It excels at natural language understanding and generation, making it useful for explanations, code analysis, and learning. However, it has important limitations:</p>
                <ul>
                    <li><strong>Training Data Cutoff:</strong> Free versions have knowledge only up to their training date (often 18-24 months old).</li>
                    <li><strong>No Real-Time Data:</strong> Cannot check current IP/domain reputation, IOCs, or live threat intelligence.</li>
                    <li><strong>Potential Inaccuracies:</strong> May confidently provide incorrect information ("hallucinations").</li>
                    <li><strong>No Context of Your Environment:</strong> Cannot know specifics about your organization's infrastructure or security posture.</li>
                </ul>
                
                <h3>Appropriate Use Cases for ChatGPT in SOC</h3>
                
                <h4>1. Code Analysis and Understanding</h4>
                <p>ChatGPT can explain what code does, making it useful for analyzing scripts found during investigations (with appropriate precautions).</p>
                
                <div class="example-block">
                    <h5>Example: PowerShell Analysis</h5>
                    <p><strong>Prompt:</strong> "What does the following PowerShell code do? Is it potentially malicious?"</p>
                    <div class="code-block">
                        <code>
powershell -nop -w hidden -encodedcommand JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgALABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACIASAA0AHMASQBBAEEAQQBBAEEAQQBBAEEAQQBBAC8A
                        </code>
                    </div>
                    <p><strong>ChatGPT Response:</strong> "This is base64-encoded PowerShell designed to evade detection. It creates a memory stream, likely to download and execute a payload. The -hidden and -nop flags are commonly used by malware to avoid user detection."</p>
                </div>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Best Practice:</strong> Only use ChatGPT for code analysis on publicly known malware samples or sanitized examples. Never paste code from active investigations that may contain proprietary information or sensitive data.
                </div>
                
                <h4>2. Learning and Skill Development</h4>
                <p>ChatGPT excels at explaining concepts, providing examples, and helping you learn new technologies.</p>
                
                <ul>
                    <li><strong>Query Examples:</strong> "Explain how NTLM authentication works" or "What is Kerberoasting and how do I detect it?"</li>
                    <li><strong>Query Building:</strong> "Write a Splunk query to find failed RDP login attempts" (then test and validate)</li>
                    <li><strong>Regex Help:</strong> "Create a regex pattern to match IPv4 addresses"</li>
                    <li><strong>Study Aid:</strong> "Generate practice questions for Security+ certification"</li>
                </ul>
                
                <h4>3. Documentation Assistance</h4>
                <ul>
                    <li><strong>Runbook Creation:</strong> "Create a template for an incident response runbook for ransomware"</li>
                    <li><strong>Report Writing:</strong> "Help me structure an incident report for executive leadership"</li>
                    <li><strong>Email Drafts:</strong> "Write a professional email explaining a security incident to affected users"</li>
                    <li><strong>Procedure Documentation:</strong> "Create a checklist for investigating phishing emails"</li>
                </ul>
                
                <h4>4. File Path and Process Analysis</h4>
                <p>ChatGPT has knowledge of common legitimate file paths and processes, making it useful for quick sanity checks.</p>
                
                <div class="example-block">
                    <h5>Example: File Path Verification</h5>
                    <p><strong>Prompt:</strong> "Is C:\Windows\System32\svchost.exe a legitimate Windows file path?"</p>
                    <p><strong>ChatGPT:</strong> "Yes, svchost.exe in System32 is legitimate. However, malware often mimics this name in other directories (e.g., C:\Windows\svchost.exe or C:\Temp\svchost.exe). Always verify the full path."</p>
                </div>
                
                <h4>5. SIEM Query Generation (with Validation)</h4>
                <p>ChatGPT can help generate SIEM queries, but always test and validate them in your environment.</p>
                
                <div class="example-block">
                    <h5>Example: KQL Query Generation</h5>
                    <p><strong>Prompt:</strong> "Write a Microsoft Sentinel KQL query to find all successful logins from outside the United States in the last 24 hours"</p>
                    <p><strong>ChatGPT Response:</strong></p>
                    <div class="code-block">
                        <code>
SigninLogs
| where TimeGenerated > ago(24h)
| where ResultType == 0  // Successful login
| where Location !in ("US", "United States")
| project TimeGenerated, UserPrincipalName, Location, IPAddress, AppDisplayName
| order by TimeGenerated desc
                        </code>
                    </div>
                    <p><strong>Next Step:</strong> Test this query in your Sentinel environment and adjust field names as needed.</p>
                </div>
                
                <h3>Inappropriate Use Cases for ChatGPT</h3>
                <ul>
                    <li><strong>‚ùå IOC Reputation Checks:</strong> ChatGPT cannot provide current reputation data for IPs, domains, or hashes. Use VirusTotal, AbuseIPDB, URLScan.io instead.</li>
                    <li><strong>‚ùå Threat Intelligence:</strong> Cannot provide up-to-date threat intelligence or current attack campaigns. Use threat intel feeds and platforms.</li>
                    <li><strong>‚ùå Sensitive Data Analysis:</strong> Never paste logs, PII, credentials, or proprietary information into ChatGPT.</li>
                    <li><strong>‚ùå Critical Decision Making:</strong> Do not rely solely on ChatGPT for incident response decisions. Always verify with authoritative sources.</li>
                    <li><strong>‚ùå Compliance-Sensitive Work:</strong> In regulated industries (healthcare, finance), LLM usage may violate compliance requirements.</li>
                </ul>
                
                <h3>Alternative AI Tools for SOC Analysts</h3>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Tool</th>
                                <th>Purpose</th>
                                <th>Use Case</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>GitHub Copilot</strong></td>
                                <td>Code completion and generation</td>
                                <td>Writing detection rules, automation scripts, queries</td>
                            </tr>
                            <tr>
                                <td><strong>ChatGPT Plus/Enterprise</strong></td>
                                <td>Advanced LLM with plugins</td>
                                <td>Enhanced analysis, browsing capabilities (with data controls)</td>
                            </tr>
                            <tr>
                                <td><strong>Microsoft Security Copilot</strong></td>
                                <td>Security-specific AI assistant</td>
                                <td>Incident investigation, threat analysis in Microsoft ecosystem</td>
                            </tr>
                            <tr>
                                <td><strong>Google Bard/Gemini</strong></td>
                                <td>Alternative LLM</td>
                                <td>Similar to ChatGPT with Google integration</td>
                            </tr>
                            <tr>
                                <td><strong>Claude (Anthropic)</strong></td>
                                <td>LLM focused on safety</td>
                                <td>Code analysis, documentation, research</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>Best Practices for Using AI in SOC</h3>
                <ol>
                    <li><strong>Understand Data Handling:</strong> Read the terms of service. Assume anything you enter is stored and potentially used for training.</li>
                    <li><strong>Sanitize Inputs:</strong> If you must use AI for work examples, replace real IPs, domains, usernames with fictional ones.</li>
                    <li><strong>Verify Everything:</strong> Treat AI outputs as suggestions, not facts. Always verify queries, code, and explanations.</li>
                    <li><strong>Use Private/Enterprise Versions:</strong> If your organization approves AI use, opt for enterprise versions with data protection guarantees.</li>
                    <li><strong>Complement, Don't Replace:</strong> Use AI to augment your skills and speed up learning, not as a substitute for understanding.</li>
                    <li><strong>Stay Updated on Policies:</strong> Organizational policies on AI usage may change. Stay informed about acceptable use.</li>
                    <li><strong>Understand Limitations:</strong> Recognize that AI has no real-time data, can hallucinate facts, and lacks your environment's context.</li>
                </ol>
                
                <h3>Practical Exercise: Using ChatGPT Safely</h3>
                
                <div class="example-block">
                    <h5>Safe Learning Exercise</h5>
                    <p>Try these prompts with ChatGPT to enhance your SOC skills:</p>
                    <ol>
                        <li>"Explain the difference between symmetric and asymmetric encryption with examples"</li>
                        <li>"Create a study plan for learning Python for security automation"</li>
                        <li>"What are the most common MITRE ATT&CK techniques used in ransomware attacks?"</li>
                        <li>"Generate a template checklist for investigating suspicious email attachments"</li>
                        <li>"Explain how DNS tunneling works and how to detect it"</li>
                    </ol>
                    <p>These prompts help you learn without exposing sensitive organizational data.</p>
                </div>
                
                <div class="tip">
                    <strong>üí° Pro Tip:</strong> Create a personal knowledge base by saving useful ChatGPT outputs (sanitized and verified) in a personal wiki or notes app. This builds your reference library while keeping sensitive data separate.
                </div>
                
                <h3>The Future of AI in SOC</h3>
                <p>AI and machine learning will increasingly augment SOC operations:</p>
                <ul>
                    <li><strong>Advanced UEBA:</strong> ML-driven user and entity behavior analytics for anomaly detection</li>
                    <li><strong>Automated Threat Hunting:</strong> AI identifying patterns and hypotheses for human analysts</li>
                    <li><strong>Natural Language Investigations:</strong> Query SIEMs using plain English instead of query languages</li>
                    <li><strong>Predictive Security:</strong> Anticipating attacks based on pattern analysis</li>
                    <li><strong>Auto-Generated Detections:</strong> AI creating detection rules from threat intelligence</li>
                </ul>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Final Reminder:</strong> AI is a powerful tool but not a magic solution. It enhances human capability but doesn't replace the need for skilled analysts. Use AI responsibly, understand its limitations, and always prioritize data security and organizational policies.
                </div>
            </div>

            <!-- Linux Log Analysis Section -->
            <div id="linux" class="section">
                <h2>üêß Linux Log Analysis and System Forensics</h2>
                
                <h3>Linux System Administration Fundamentals</h3>
                <p>Linux systems are ubiquitous in modern infrastructure, powering web servers, databases, containers, and cloud instances. Understanding Linux logging architecture is essential for security monitoring and incident response in environments where SIEM agents may not be deployed or during forensic investigations requiring host-level analysis.</p>
                
                <h4>The Unix Philosophy and Logging</h4>
                <p>Linux follows the Unix principle of "everything is a file." Logs are text files written to <code>/var/log</code>, making them accessible through standard text processing tools (grep, awk, sed). This design enables powerful command-line analysis without specialized software, crucial during incident response when every second counts.</p>
                
                <h3>Syslog Architecture and Protocol</h3>
                <p>Syslog is the standard logging protocol on Unix-like systems, defined by RFC 5424. Understanding its architecture helps analysts locate relevant logs and interpret their contents.</p>
                
                <h4>Syslog Components</h4>
                <ul>
                    <li><strong>Facility:</strong> Categorizes the source of the message (auth, kernel, mail, cron, daemon, user, local0-7). Determines which log file receives the message.</li>
                    <li><strong>Severity:</strong> Importance level from 0 (emergency) to 7 (debug). Security events typically use levels 0-4 (emergency, alert, critical, error, warning).</li>
                    <li><strong>Timestamp:</strong> When the event occurred; critical for timeline reconstruction</li>
                    <li><strong>Hostname:</strong> Identifies the source system; essential in centralized logging environments</li>
                    <li><strong>Process/PID:</strong> Application that generated the message and its process ID</li>
                    <li><strong>Message:</strong> Descriptive text about the event</li>
                </ul>
                
                <h4>Syslog Daemons</h4>
                <ul>
                    <li><strong>rsyslog:</strong> Default on RHEL/CentOS; supports advanced filtering, templating, and remote forwarding</li>
                    <li><strong>syslog-ng:</strong> Alternative with more flexible configuration syntax; popular in security-focused environments</li>
                    <li><strong>systemd-journald:</strong> Modern logging system integrated with systemd; binary format with structured metadata</li>
                </ul>
                
                <h4>Configuration Files</h4>
                <ul>
                    <li><strong>/etc/rsyslog.conf:</strong> Main rsyslog configuration; defines routing rules (facility.severity ‚Üí destination)</li>
                    <li><strong>/etc/rsyslog.d/:</strong> Modular configuration directory; drop-in files for specific applications</li>
                    <li><strong>/etc/logrotate.conf:</strong> Log rotation settings; prevents disk exhaustion by compressing/archiving old logs</li>
                    <li><strong>/etc/logrotate.d/:</strong> Application-specific rotation rules</li>
                </ul>

                <h3>Critical Log File Locations and Purposes</h3>
                <p>Linux distributions vary in log file organization, but standard locations remain consistent. Knowing where to look is the first step in log analysis.</p>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Log File</th>
                                <th>Description</th>
                                <th>Key Information</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>/var/log/auth.log</code></td>
                                <td>Authentication logs (Debian/Ubuntu)</td>
                                <td>SSH logins, sudo usage, user authentication, PAM events</td>
                            </tr>
                            <tr>
                                <td><code>/var/log/secure</code></td>
                                <td>Authentication logs (RHEL/CentOS)</td>
                                <td>Same as auth.log; RHEL-based distributions use this name</td>
                            </tr>
                            <tr>
                                <td><code>/var/log/syslog</code></td>
                                <td>General system logs (Debian/Ubuntu)</td>
                                <td>Catch-all for system events, daemon messages, kernel logs</td>
                            </tr>
                            <tr>
                                <td><code>/var/log/messages</code></td>
                                <td>General system logs (RHEL/CentOS)</td>
                                <td>Global system messages; equivalent to syslog</td>
                            </tr>
                            <tr>
                                <td><code>/var/log/kern.log</code></td>
                                <td>Kernel messages</td>
                                <td>Hardware errors, driver issues, kernel panics, security modules (SELinux, AppArmor)</td>
                            </tr>
                            <tr>
                                <td><code>/var/log/apache2/</code></td>
                                <td>Apache web server logs</td>
                                <td>access.log (HTTP requests), error.log (server errors)</td>
                            </tr>
                            <tr>
                                <td><code>/var/log/nginx/</code></td>
                                <td>Nginx web server logs</td>
                                <td>access.log (HTTP requests), error.log (server errors)</td>
                            </tr>
                            <tr>
                                <td><code>/var/log/mysql/</code></td>
                                <td>MySQL database logs</td>
                                <td>error.log (DB errors), slow-query.log (performance issues)</td>
                            </tr>
                            <tr>
                                <td><code>/var/log/audit/audit.log</code></td>
                                <td>Linux Audit Framework (auditd)</td>
                                <td>Detailed system call auditing; file access, process execution, SELinux events</td>
                            </tr>
                            <tr>
                                <td><code>/var/log/lastlog</code></td>
                                <td>Last login information (binary)</td>
                                <td>Last login time for each user; read with 'lastlog' command</td>
                            </tr>
                            <tr>
                                <td><code>/var/log/wtmp</code></td>
                                <td>Login history (binary)</td>
                                <td>Historical login/logout records; read with 'last' command</td>
                            </tr>
                            <tr>
                                <td><code>/var/log/btmp</code></td>
                                <td>Failed login attempts (binary)</td>
                                <td>Failed login records; read with 'lastb' command</td>
                            </tr>
                            <tr>
                                <td><code>journalctl</code></td>
                                <td>systemd journal (binary)</td>
                                <td>Unified logging system; query with journalctl command</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="tip">
                    <strong>üí° Distribution Differences:</strong>
                    <ul>
                        <li><strong>Debian/Ubuntu:</strong> Use <code>/var/log/auth.log</code> and <code>/var/log/syslog</code></li>
                        <li><strong>RHEL/CentOS/Fedora:</strong> Use <code>/var/log/secure</code> and <code>/var/log/messages</code></li>
                        <li><strong>systemd-based:</strong> Modern distributions use journald; traditional logs may be symlinks or duplicates</li>
                        <li><strong>Log rotation:</strong> Archived logs are compressed with .gz extension (auth.log.1.gz)</li>
                    </ul>
                </div>

                <h3>Linux Incident Response Triage Checklist</h3>
                <p>When responding to a suspected compromise, follow systematic procedures to preserve evidence and identify the scope of the incident.</p>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Linux Forensic Triage Process:</strong>
                    <ol>
                        <li><strong>Time Synchronization:</strong> Verify system time with <code>timedatectl status</code>; incorrect time skews correlation with other logs. Check for time manipulation (indicator of anti-forensics).</li>
                        <li><strong>Authentication Review:</strong> Examine recent authentication failures in auth.log/secure; identify brute force patterns or successful logins from unexpected IPs.</li>
                        <li><strong>Persistence Mechanisms:</strong> Check crontabs (<code>/etc/crontab</code>, <code>/var/spool/cron/</code>), systemd services (<code>systemctl list-units</code>), init scripts (<code>/etc/rc*.d/</code>), and <code>/etc/rc.local</code> for malicious scheduled tasks or startup items.</li>
                        <li><strong>User Account Analysis:</strong> Review <code>/etc/passwd</code> and <code>/etc/shadow</code> for unauthorized accounts; check UID 0 accounts (root privileges); validate user group memberships in <code>/etc/group</code>.</li>
                        <li><strong>Process Inspection:</strong> List all running processes with <code>ps auxww</code> or <code>pstree -ap</code>; identify suspicious process names, arguments, or parent-child relationships; check process binary locations.</li>
                        <li><strong>Network Connections:</strong> Capture active connections with <code>ss -tulpn</code> or <code>netstat -tulpn</code>; identify unusual listening ports or connections to external IPs; document PIDs for correlation.</li>
                        <li><strong>Binary Analysis:</strong> Hash suspicious executables with <code>sha256sum</code>; upload to VirusTotal; check file metadata with <code>stat</code> and <code>file</code> commands.</li>
                        <li><strong>Web/Application Logs:</strong> Review Apache/Nginx access logs during alert timeframe; search for exploitation patterns (SQLi, directory traversal, shell uploads).</li>
                        <li><strong>Artifact Collection:</strong> Before remediation, preserve logs, bash history (<code>~/.bash_history</code>), shell configuration files (<code>~/.bashrc</code>, <code>~/.profile</code>), and suspicious binaries for forensic analysis.</li>
                        <li><strong>Memory Dump (Optional):</strong> For advanced forensics, capture volatile memory with tools like LiME before rebooting or isolating system.</li>
                    </ol>
                </div>
                
                <div class="important">
                    <strong>üîí Evidence Preservation:</strong> Never perform forensic analysis on the live system if possible. Create forensic images using dd or equivalent tools. If live analysis is necessary, document every command executed and its timestamp to maintain chain of custody. Ideally, mount filesystems read-only or use forensic distributions like SIFT or CAINE.
                </div>

                <h3>Essential Commands for Log Analysis</h3>
                <p>Linux provides powerful text processing utilities for log analysis. Mastering these commands enables rapid investigation without deploying specialized tools.</p>

                <h4>1. Log Viewing Commands</h4>
                <p><strong>Context:</strong> These commands provide different perspectives on log files: real-time monitoring, recent entries, or paginated viewing.</p>
                <div class="description">
                    <strong>Use Cases:</strong> Monitoring active intrusions (tail -f), examining recent activity (tail -n), or browsing entire log files (less).
                </div>
                <div class="query-box">
                    <code># View last 100 lines of auth.log (recent authentication events)
tail -n 100 /var/log/auth.log

# Follow log in real-time (essential for active incident monitoring)
tail -f /var/log/syslog

# View first 50 lines (useful for checking log format or file headers)
head -n 50 /var/log/messages

# View entire log with pagination (spacebar = next page, /pattern = search, q = quit)
less /var/log/syslog

# View compressed logs (rotated logs older than today)
zcat /var/log/syslog.1.gz | less

# View multiple rotated logs in chronological order
zcat /var/log/auth.log.{3,2,1}.gz | cat - /var/log/auth.log | less</code>
                </div>
                <p><strong>Command Explanations:</strong></p>
                <ul>
                    <li><strong>tail -f:</strong> "Follow" mode updates in real-time; press Ctrl+C to exit. Critical for observing ongoing attacks.</li>
                    <li><strong>less:</strong> Interactive viewer with search (/) and navigation (arrows, PgUp/PgDn); superior to more/cat for large files.</li>
                    <li><strong>zcat:</strong> Decompresses .gz files to stdout without creating temp files; efficient for searching rotated logs.</li>
                    <li><strong>Brace expansion {3,2,1}:</strong> Efficient way to list multiple files in order; expands to auth.log.3.gz auth.log.2.gz auth.log.1.gz.</li>
                </ul>
                <p><strong>Best Practices:</strong></p>
                <ul>
                    <li>Always use sudo/root when accessing system logs (permissions typically 640, root:adm)</li>
                    <li>Check log rotation schedule in /etc/logrotate.d/ to understand data retention</li>
                    <li>For investigations spanning multiple days, search rotated logs (auth.log.1.gz, auth.log.2.gz, etc.)</li>
                </ul>

                <h4>2. Search and Filter Logs with grep</h4>
                <p><strong>Context:</strong> grep (Global Regular Expression Print) is the most powerful tool for log analysis, enabling pattern matching, context extraction, and filtering.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Use grep with regular expressions and flags to rapidly locate security events across massive log files.
                </div>
                <div class="query-box">
                    <code># Search for failed SSH logins (brute force detection)
grep "Failed password" /var/log/auth.log

# Case-insensitive search (catches ERROR, error, Error)
grep -i "error" /var/log/syslog

# Show line numbers (helps correlate with other tools or documentation)
grep -n "authentication failure" /var/log/secure

# Show context: 5 lines before AND after match (reveals attack sequence)
grep -C 5 "kernel panic" /var/log/kern.log

# Show only before or after context
grep -B 10 "Out of memory" /var/log/syslog  # 10 lines before
grep -A 3 "Failed password" /var/log/auth.log  # 3 lines after

# Search multiple files with wildcard
grep "error" /var/log/*.log

# Recursive search in directory (searches all files in /var/log and subdirectories)
grep -r "connection refused" /var/log/

# Invert match: show lines NOT containing pattern (filter out noise)
grep -v "DEBUG" /var/log/application.log

# Count occurrences (quantify attack intensity)
grep -c "Failed password" /var/log/auth.log

# Multiple patterns with OR logic
grep -E "error|critical|alert" /var/log/syslog

# Extended regex for complex patterns
grep -E "192\.168\.[0-9]{1,3}\.[0-9]{1,3}" /var/log/auth.log  # Match IP addresses</code>
                </div>
                <p><strong>grep Flags Explained:</strong></p>
                <ul>
                    <li><strong>-i:</strong> Case-insensitive matching</li>
                    <li><strong>-n:</strong> Show line numbers</li>
                    <li><strong>-C N:</strong> Show N lines of context (before and after)</li>
                    <li><strong>-B N:</strong> Show N lines before match</li>
                    <li><strong>-A N:</strong> Show N lines after match</li>
                    <li><strong>-r / -R:</strong> Recursive directory search</li>
                    <li><strong>-v:</strong> Invert match (exclude lines matching pattern)</li>
                    <li><strong>-c:</strong> Count matches instead of displaying them</li>
                    <li><strong>-E:</strong> Extended regular expressions (supports +, ?, |, {}, () without escaping)</li>
                    <li><strong>-l:</strong> List filenames only (useful for finding which log files contain events)</li>
                    <li><strong>-w:</strong> Match whole words only (prevents partial matches)</li>
                    <li><strong>--color=auto:</strong> Highlights matches (recommended for alias: alias grep='grep --color=auto')</li>
                </ul>
                <p><strong>MITRE ATT&CK:</strong> T1552.004 (Unsecured Credentials: Private Keys) - grep for "BEGIN RSA PRIVATE KEY" to find exposed SSH keys</p>

                <h4>3. Failed Login Attempts Analysis (Brute Force Detection)</h4>
                <p><strong>Threat Context:</strong> SSH brute force attacks are among the most common attacks on Linux servers. Analyzing failed authentication attempts reveals attack sources and intensity.</p>
                <div class="description">
                    <strong>Detection Logic:</strong> Extract failed login entries, parse source IPs, aggregate by frequency, and sort to identify top attackers.
                </div>
                <div class="query-box">
                    <code># Count failed SSH login attempts by source IP (identifies attackers)
grep "Failed password" /var/log/auth.log | awk '{print $(NF-3)}' | sort | uniq -c | sort -rn | head -20

# Show all failed login attempts with timestamps and usernames
grep "Failed password" /var/log/auth.log | awk '{print $1, $2, $3, $(NF-5), "from", $(NF-3)}'

# Failed logins for specific user (targeted attack detection)
grep "Failed password" /var/log/auth.log | grep "for invalid user username"

# Successful logins after failures from same IP (compromised credentials)
grep -E "(Failed password|Accepted password)" /var/log/auth.log | grep "192.168.1.100"

# Comprehensive authentication analysis: failures vs successes by IP
awk '/Failed password/ {failed[$13]++} /Accepted password/ {success[$13]++} END {print "IP\t\t\tFailed\tSuccess"; for (ip in failed) print ip "\t" failed[ip] "\t" success[ip]}' /var/log/auth.log | column -t</code>
                </div>
                <p><strong>Command Breakdown:</strong></p>
                <ul>
                    <li><strong>$(NF-3):</strong> awk extracts 3rd field from end (source IP location in syslog format)</li>
                    <li><strong>sort | uniq -c:</strong> Sorts results then counts unique entries</li>
                    <li><strong>sort -rn:</strong> Sorts numerically (-n) in reverse order (-r) to show highest counts first</li>
                    <li><strong>head -20:</strong> Limits to top 20 attackers (adjust as needed)</li>
                    <li><strong>column -t:</strong> Formats output into aligned columns for readability</li>
                </ul>
                <p><strong>Mitigation Recommendations:</strong></p>
                <ul>
                    <li>Block attacking IPs with firewall: <code>iptables -A INPUT -s [IP] -j DROP</code> or <code>ufw deny from [IP]</code></li>
                    <li>Deploy fail2ban to automatically block IPs after threshold failures</li>
                    <li>Disable password authentication; use SSH keys only (PasswordAuthentication no in sshd_config)</li>
                    <li>Change default SSH port from 22 to reduce automated scanner traffic</li>
                    <li>Implement rate limiting with iptables hashlimit module</li>
                </ul>
                <p><strong>MITRE ATT&CK:</strong> T1110.001 (Brute Force: Password Guessing), T1078.003 (Valid Accounts: Local Accounts)</p>

                <h4>4. User Activity and Session Monitoring</h4>
                <p><strong>Context:</strong> Track user sessions, login history, and command execution to detect unauthorized access and insider threats.</p>
                <div class="description">
                    <strong>Investigation Purpose:</strong> Identify who accessed the system, when, from where, and what commands they executed.
                </div>
                <div class="query-box">
                    <code># Show current logged-in users with terminal and login time
who

# Detailed current user information (includes idle time and login source)
w

# Show last 20 login sessions (successful logins)
last -n 20

# Show failed login attempts (reads /var/log/btmp)
lastb -n 20

# Show login history for specific user
last username

# Show all sudo command executions (privilege escalation tracking)
grep "sudo" /var/log/auth.log | grep "COMMAND"

# Show user command history (forensic artifact)
cat /home/username/.bash_history

# Check for .bash_history tampering (timestamps using HISTTIMEFORMAT)
export HISTTIMEFORMAT='%F %T '
history

# Find recently modified files by user (data access/modification)
find /home/username -type f -mtime -1 -ls

# Check SSH authorized_keys for persistence (backdoor SSH keys)
cat /home/*/.ssh/authorized_keys
cat /root/.ssh/authorized_keys</code>
                </div>
                <p><strong>Forensic Considerations:</strong></p>
                <ul>
                    <li><strong>lastlog/wtmp/btmp:</strong> Binary files; attackers may tamper or delete. Check file integrity against backups.</li>
                    <li><strong>.bash_history:</strong> User-writable; attackers can clear with <code>history -c</code> or disable with <code>unset HISTFILE</code>. Check for suspicious gaps.</li>
                    <li><strong>Authorized_keys:</strong> Attackers add SSH keys for persistent access. Compare against known good state or user-reported keys.</li>
                    <li><strong>Sudo logs:</strong> Critical for privilege escalation detection; monitor for unusual sudo usage patterns or privilege abuse.</li>
                </ul>
                <p><strong>MITRE ATT&CK:</strong> T1136 (Create Account), T1098 (Account Manipulation), T1078 (Valid Accounts)</p>

                <h4>5. Network Connection Analysis</h4>
                <p><strong>Context:</strong> Active network connections reveal C2 channels, lateral movement, and data exfiltration in progress.</p>
                <div class="query-box">
                    <code># Show established connections with process/PID (identifies malware C2)
netstat -tupn | grep ESTABLISHED
ss -tupn | grep ESTAB  # Modern alternative (faster)

# Show all listening ports with process names (backdoor detection)
ss -tlnp
netstat -tlnp

# Show connections to/from specific IP
netstat -an | grep "192.168.1.100"
ss -an | grep "192.168.1.100"

# Monitor connections in real-time (detect new connections)
watch -n 1 'netstat -tupn | grep ESTABLISHED'

# Show firewall logs for dropped packets (blocked attack attempts)
grep "DPT=" /var/log/syslog | tail -50

# Count connections per remote IP (identify top talkers)
netstat -an | awk '/ESTABLISHED/ {print $5}' | cut -d: -f1 | sort | uniq -c | sort -rn

# Identify processes with most network activity
lsof -i -n -P | awk '{print $1}' | sort | uniq -c | sort -rn</code>
                </div>
                <p><strong>Analysis Tips:</strong></p>
                <ul>
                    <li><strong>ss vs netstat:</strong> ss is faster and more feature-rich; prefer ss on modern systems</li>
                    <li><strong>Unknown PIDs:</strong> If connection lacks PID, run as root/sudo (permission required to see all processes)</li>
                    <li><strong>Suspicious indicators:</strong> Connections to non-standard ports, foreign IPs, or from unexpected processes</li>
                    <li><strong>lsof -i:</strong> Lists files/sockets opened by processes; reveals which processes own connections</li>
                </ul>
                <p><strong>MITRE ATT&CK:</strong> T1071 (Application Layer Protocol), T1095 (Non-Application Layer Protocol), T1572 (Protocol Tunneling)</p>

                <h4>6. Process Monitoring and Analysis</h4>
                <p><strong>Context:</strong> Running processes reveal active malware, privilege escalation, and persistence mechanisms.</p>
                <div class="query-box">
                    <code># Show all processes with full command line
ps auxww

# Search for specific process (web server, potential malware)
ps aux | grep nginx

# Show process tree (reveals parent-child relationships; detects process injection)
pstree -ap

# Monitor processes in real-time with resource usage
top -c

# Better interactive process monitor (color-coded, mouse support)
htop

# Show processes by specific user (insider threat investigation)
ps -u username

# Find processes listening on network ports
lsof -i -P -n | grep LISTEN

# Show process details including open files and network connections
lsof -p [PID]

# Find processes running from suspicious locations (/tmp, /dev/shm often used by malware)
ps aux | grep -E "/tmp/|/dev/shm"

# Check for hidden processes (process ID gaps or rootkit detection)
ps aux | sort -n -k2  # Sort by PID to find gaps

# Monitor specific process in real-time
watch -n 1 'ps aux | grep [p]rocess_name'</code>
                </div>
                <p><strong>Suspicious Process Indicators:</strong></p>
                <ul>
                    <li><strong>Unusual names:</strong> Random strings, mimicking system processes with typos (systmd vs systemd)</li>
                    <li><strong>Unexpected locations:</strong> Executables in /tmp, /var/tmp, /dev/shm, or user home directories</li>
                    <li><strong>High resource usage:</strong> Cryptocurrency miners consume excessive CPU; keyloggers and scanners generate high network activity</li>
                    <li><strong>Parent-child anomalies:</strong> Web server spawning bash/nc (reverse shell); cron executing binary from /tmp</li>
                    <li><strong>Deleted binaries:</strong> Process running from deleted file (shown as "(deleted)" in lsof output) - common anti-forensics tactic</li>
                </ul>
                <p><strong>MITRE ATT&CK:</strong> T1055 (Process Injection), T1036 (Masquerading), T1496 (Resource Hijacking)</p>

                <h4>7. Web Server Log Analysis</h4>
                <p><strong>Context:</strong> Apache/Nginx logs expose web application attacks, including SQL injection, XSS, directory traversal, and shell uploads.</p>
                <div class="query-box">
                    <code># Top 10 IP addresses accessing site (identify scanners, botnets)
awk '{print $1}' /var/log/apache2/access.log | sort | uniq -c | sort -rn | head -10

# Show 404 errors (reconnaissance for hidden directories/files)
grep " 404 " /var/log/apache2/access.log | tail -50

# Show all POST requests (form submissions, potential attacks)
grep "POST" /var/log/apache2/access.log

# Analyze user agents (identify bots, scanners, attack tools)
awk -F'"' '{print $6}' /var/log/apache2/access.log | sort | uniq -c | sort -rn | head -20

# Find SQL injection attempts
grep -E "(union.*select|drop.*table|exec.*\(|select.*from|insert.*into)" -i /var/log/apache2/access.log

# Find XSS attempts (including encoded variants)
grep -E "(<script|javascript:|onerror=|onload=|%3Cscript|%3D|&#|\\x3c)" -i /var/log/apache2/access.log

# Find directory traversal attempts
grep -E "(\.\.\/|\.\.\\\\)" /var/log/apache2/access.log

# Find shell upload attempts (common webshell filenames)
grep -E "(cmd\.php|shell\.php|c99\.php|r57\.php|phpshell\.php|backdoor\.php)" -i /var/log/nginx/access.log

# Show requests to specific sensitive URL
grep "/admin" /var/log/nginx/access.log

# Count requests by hour (identify attack timeframes or DDoS)
awk '{print $4}' /var/log/apache2/access.log | cut -c 14-15 | sort | uniq -c

# Find brute force on login pages
grep "/wp-login.php\|/admin/login\|/login.php" /var/log/apache2/access.log | awk '{print $1}' | sort | uniq -c | sort -rn

# Analyze response codes by IP (200 after many 401/403 indicates successful attack)
awk '{print $1" "$9}' /var/log/apache2/access.log | sort | uniq -c | sort -rn | head -30</code>
                </div>
                <p><strong>Apache/Nginx Log Format (Common Log Format):</strong></p>
                <ul>
                    <li><strong>$1:</strong> Client IP address</li>
                    <li><strong>$4:</strong> Timestamp [day/month/year:hour:minute:second timezone]</li>
                    <li><strong>$6 (in quotes):</strong> Request method and URL</li>
                    <li><strong>$9:</strong> HTTP status code (200=success, 404=not found, 500=server error, 403=forbidden)</li>
                    <li><strong>$10:</strong> Response size in bytes</li>
                    <li><strong>Last quoted field:</strong> User-Agent string</li>
                </ul>
                <p><strong>Response Code Analysis:</strong></p>
                <ul>
                    <li><strong>200:</strong> Success - confirm if expected for attacked URL (may indicate successful exploitation)</li>
                    <li><strong>403/401:</strong> Access denied - likely WAF blocking or failed authentication</li>
                    <li><strong>404:</strong> Not found - reconnaissance activity</li>
                    <li><strong>500/503:</strong> Server errors - possible crash from exploit or DoS</li>
                </ul>
                <p><strong>MITRE ATT&CK:</strong> T1190 (Exploit Public-Facing Application), T1505.003 (Server Software Component: Web Shell)</p>

                <h4>8. System Resource and Performance Analysis</h4>
                <p><strong>Context:</strong> Resource exhaustion (CPU, memory, disk) can indicate crypto miners, DoS attacks, or system compromise.</p>
                <div class="query-box">
                    <code># Check disk space (log overflow detection)
df -h

# Show disk usage by directory (find space-consuming logs or malware)
du -sh /var/* | sort -rh | head -10

# Monitor memory usage (detect memory-resident malware)
free -h

# Show largest log files (identify logging issues or attack artifacts)
find /var/log -type f -exec ls -lh {} \; | sort -k5 -rh | head -10

# Monitor I/O statistics (detect data exfiltration or disk-based attacks)
iostat -x 5

# Monitor CPU usage per process
top -b -n 1 | head -20

# Check system load average (current, 5min, 15min)
uptime</code>
                </div>
                <p><strong>MITRE ATT&CK:</strong> T1496 (Resource Hijacking), T1499 (Endpoint Denial of Service)</p>

                <h4>9. Time-Based Log Analysis</h4>
                <p><strong>Context:</strong> Filter logs to specific time ranges to correlate with alerts or incident timelines.</p>
                <div class="query-box">
                    <code># Show logs from specific date
grep "Jan 26" /var/log/syslog

# Show logs between time range (using sed)
sed -n '/09:00:00/,/17:00:00/p' /var/log/syslog

# Show logs from last hour using awk
awk -v date="$(date --date='1 hour ago' '+%b %_d %H')" '$0 ~ date' /var/log/syslog

# Show today's auth logs
grep "$(date '+%b %e')" /var/log/auth.log

# Extract events within specific timeframe (more precise)
grep "Jan 26 14:" /var/log/auth.log | grep -E "14:(3[0-9]|4[0-5])"  # 14:30-14:45</code>
                </div>

                <h4>10. Advanced Log Analysis with awk</h4>
                <p><strong>Context:</strong> awk is a powerful text processing language ideal for extracting fields, calculating statistics, and complex filtering.</p>
                <div class="query-box">
                    <code># Extract specific fields from logs
awk '/Failed password/ {print $1, $2, $3, $11}' /var/log/auth.log

# Calculate statistics (count events)
awk '/error/ {count++} END {print "Total errors:", count}' /var/log/syslog

# Filter by multiple conditions (status code 404 AND URL contains admin)
awk '$9 == 404 && $7 ~ /admin/ {print $1, $7}' /var/log/apache2/access.log

# Sum bandwidth usage (aggregate bytes transferred)
awk '{sum+=$10} END {print "Total bytes:", sum}' /var/log/nginx/access.log

# Group and count by field (like SQL GROUP BY)
awk '{count[$1]++} END {for (ip in count) print ip, count[ip]}' /var/log/apache2/access.log | sort -k2 -rn</code>
                </div>

                <h4>11. Log Rotation and Management</h4>
                <div class="query-box">
                    <code># View logrotate configuration
cat /etc/logrotate.conf

# View application-specific rotation rules
ls -la /etc/logrotate.d/

# Manually trigger log rotation (useful after clearing disk space)
logrotate -f /etc/logrotate.conf

# Check log sizes (monitor for abnormal growth)
ls -lh /var/log/

# Archive old logs for investigation or compliance
tar -czf logs_backup_$(date +%Y%m%d).tar.gz /var/log/*.log

# Safely clear log file without breaking open file handles (preserves file descriptor)
truncate -s 0 /var/log/application.log
# Alternatively: > /var/log/application.log
# NEVER use: rm /var/log/application.log (breaks logging)</code>
                </div>

                <h4>12. systemd Journal Analysis (journalctl)</h4>
                <p><strong>Context:</strong> systemd-based distributions use journald for centralized binary logging with rich metadata and filtering capabilities.</p>
                <div class="query-box">
                    <code># View all system logs (paged output)
journalctl

# Follow logs in real-time (like tail -f)
journalctl -f

# Show logs for specific service (systemd unit)
journalctl -u ssh.service
journalctl -u apache2.service

# Show logs since last boot
journalctl -b
journalctl -b -1  # Previous boot

# Show logs for time range
journalctl --since "2026-01-26 09:00:00" --until "2026-01-26 17:00:00"
journalctl --since "1 hour ago"
journalctl --since yesterday

# Show only errors and critical messages
journalctl -p err
journalctl -p crit

# Show kernel messages (equivalent to dmesg)
journalctl -k

# Show logs with priority range
journalctl -p warning..err  # warnings and errors only

# Show logs for specific process ID
journalctl _PID=1234

# Show logs for specific user
journalctl _UID=1000

# Export to JSON for SIEM ingestion
journalctl -o json --since "1 hour ago" > logs.json

# Show disk usage of journal
journalctl --disk-usage

# Clean old journal entries (retain last 7 days)
journalctl --vacuum-time=7d

# Search journal with grep
journalctl | grep "Failed password"</code>
                </div>
                <p><strong>journalctl Priority Levels:</strong></p>
                <ul>
                    <li><strong>0 (emerg):</strong> System is unusable</li>
                    <li><strong>1 (alert):</strong> Action must be taken immediately</li>
                    <li><strong>2 (crit):</strong> Critical conditions</li>
                    <li><strong>3 (err):</strong> Error conditions</li>
                    <li><strong>4 (warning):</strong> Warning conditions</li>
                    <li><strong>5 (notice):</strong> Normal but significant condition</li>
                    <li><strong>6 (info):</strong> Informational messages</li>
                    <li><strong>7 (debug):</strong> Debug-level messages</li>
                </ul>

                <div class="tip">
                    <strong>üí° Linux Log Analysis Best Practices:</strong>
                    <ul>
                        <li><strong>Root access:</strong> Always use sudo for system logs; many logs have restrictive permissions (640 root:adm)</li>
                        <li><strong>Command chaining:</strong> Use pipes (|) to combine tools: <code>grep | awk | sort | uniq -c | sort -rn</code></li>
                        <li><strong>watch command:</strong> Monitor changing output in real-time: <code>watch -n 1 'command'</code></li>
                        <li><strong>Screen/tmux:</strong> Use terminal multiplexers for persistent sessions during investigations</li>
                        <li><strong>Aliases:</strong> Create shortcuts: <code>alias authfail='grep "Failed password" /var/log/auth.log | awk "{print \$(NF-3)}" | sort | uniq -c | sort -rn'</code></li>
                        <li><strong>Centralized logging:</strong> Forward logs to SIEM using rsyslog or syslog-ng for correlation</li>
                        <li><strong>NTP synchronization:</strong> Ensure accurate timestamps with ntpd or chronyd for timeline accuracy</li>
                        <li><strong>Log integrity:</strong> Consider AIDE or Tripwire to detect log tampering</li>
                    </ul>
                </div>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Anti-Forensics Detection:</strong> Attackers may clear logs to hide their tracks. Check for:
                    <ul>
                        <li><strong>Empty logs:</strong> Recently created logs with size 0 (check with <code>ls -la /var/log/</code>)</li>
                        <li><strong>Time gaps:</strong> Missing log entries during known activity periods</li>
                        <li><strong>Modified timestamps:</strong> Use <code>stat /var/log/auth.log</code> to check file modification times</li>
                        <li><strong>Unset history:</strong> Check if HISTFILE variable is unset or HISTSIZE=0</li>
                        <li><strong>Audit rules:</strong> Verify auditd is running and rules haven't been disabled</li>
                    </ul>
                </div>
            </div>

            <!-- Intrusion Detection Section -->
            <div id="intrusion-detection" class="section">
                <h2>üîç Intrusion Detection - Playbook & Theory</h2>
                
                <h3>What is Intrusion Detection?</h3>
                <p>Intrusion Detection Systems (IDS) are security tools that monitor network traffic and system activities to identify suspicious patterns, policy violations, and malicious behavior. IDS serves as a critical component of defense-in-depth strategies by providing real-time visibility into potential security breaches.</p>
                
                <h3>Types of Intrusion Detection Systems</h3>
                
                <h4>Network-Based IDS (NIDS)</h4>
                <p>NIDS monitors network traffic in real-time, analyzing packets to detect suspicious patterns:</p>
                <ul>
                    <li><strong>Deployment:</strong> Positioned at strategic network points (gateways, DMZ, critical subnets)</li>
                    <li><strong>Examples:</strong> Snort, Suricata, Zeek (formerly Bro)</li>
                    <li><strong>Advantages:</strong> Low impact on network performance, can monitor entire network segments</li>
                    <li><strong>Limitations:</strong> Cannot inspect encrypted traffic (HTTPS, VPN), may miss host-level attacks</li>
                </ul>
                
                <h4>Host-Based IDS (HIDS)</h4>
                <p>HIDS monitors individual hosts for suspicious activity by analyzing system logs, file integrity, and process behavior:</p>
                <ul>
                    <li><strong>Deployment:</strong> Installed on critical servers, workstations, and endpoints</li>
                    <li><strong>Examples:</strong> OSSEC, Wazuh, Tripwire</li>
                    <li><strong>Advantages:</strong> Can detect local attacks, monitors encrypted traffic at endpoint, detects file changes</li>
                    <li><strong>Limitations:</strong> Consumes host resources, must be installed on each system</li>
                </ul>
                
                <h3>Detection Methods</h3>
                
                <h4>Signature-Based Detection</h4>
                <p>Compares network traffic or system activity against a database of known attack signatures:</p>
                <div class="query-box">
                    <code># Example Snort Rule - Detecting SQL Injection
alert tcp any any -> $HOME_NET 80 (msg:"SQL Injection Attempt"; \
  content:"union"; nocase; content:"select"; nocase; \
  classtype:web-application-attack; sid:1000001; rev:1;)</code>
                </div>
                <ul>
                    <li><strong>Advantages:</strong> High accuracy for known attacks, low false positive rate</li>
                    <li><strong>Disadvantages:</strong> Cannot detect zero-day attacks, requires constant signature updates</li>
                </ul>
                
                <h4>Anomaly-Based Detection</h4>
                <p>Establishes a baseline of normal behavior and flags deviations as potential threats:</p>
                <ul>
                    <li><strong>Statistical Analysis:</strong> Monitors metrics like bandwidth usage, connection counts, protocol distributions</li>
                    <li><strong>Machine Learning:</strong> Uses algorithms to identify patterns that deviate from normal behavior</li>
                    <li><strong>Advantages:</strong> Can detect unknown attacks, adapts to environment</li>
                    <li><strong>Disadvantages:</strong> Higher false positive rate, requires training period</li>
                </ul>
                
                <h4>Protocol Analysis</h4>
                <p>Compares network traffic against protocol standards to detect violations:</p>
                <ul>
                    <li>Identifies malformed packets, protocol abuse, and evasion techniques</li>
                    <li>Examples: HTTP protocol violations, unusual DNS queries, fragmented packets</li>
                </ul>
                
                <h3>Intrusion Detection Playbook</h3>
                
                <h4>Phase 1: Alert Triage</h4>
                <p>When an IDS alert is triggered, follow this systematic approach:</p>
                <div class="description">
                    <strong>Initial Assessment (First 5 minutes):</strong>
                </div>
                <ol>
                    <li><strong>Alert Classification:</strong> Determine severity (Critical, High, Medium, Low)</li>
                    <li><strong>Context Gathering:</strong>
                        <ul>
                            <li>Source IP address (internal or external?)</li>
                            <li>Destination IP address and port</li>
                            <li>Protocol and application involved</li>
                            <li>Time of detection and duration</li>
                        </ul>
                    </li>
                    <li><strong>Quick Validation:</strong> Is this a true positive or false positive?</li>
                </ol>
                
                <div class="tip">
                    <strong>üí° Triage Tip:</strong> Not all alerts are equal. Prioritize based on:
                    <ul>
                        <li>Asset criticality (production servers > test systems)</li>
                        <li>Attack type (data exfiltration > reconnaissance)</li>
                        <li>Number of affected systems</li>
                        <li>Threat actor sophistication</li>
                    </ul>
                </div>
                
                <h4>Phase 2: Investigation</h4>
                <div class="description">
                    <strong>Deep Dive Analysis (15-30 minutes):</strong>
                </div>
                
                <p><strong>Network-Level Investigation:</strong></p>
                <ul>
                    <li><strong>PCAP Analysis:</strong> Review packet captures to understand attack mechanics</li>
                    <li><strong>Session Reconstruction:</strong> Follow TCP streams to see complete attack flow</li>
                    <li><strong>Timeline Analysis:</strong> Map out sequence of events leading to detection</li>
                </ul>
                
                <div class="query-box">
                    <code># Wireshark/tshark Commands for IDS Alert Investigation
# Extract specific conversation
tshark -r capture.pcap -q -z conv,ip

# Follow TCP stream for suspicious connection
tshark -r capture.pcap -q -z follow,tcp,ascii,0

# Filter by attacker IP
tshark -r capture.pcap -Y "ip.src == 192.168.1.100" -w filtered.pcap

# Extract HTTP objects (potential malware)
tshark -r capture.pcap --export-objects http,./extracted_files/</code>
                </div>
                
                <p><strong>Host-Level Investigation:</strong></p>
                <ul>
                    <li><strong>Process Analysis:</strong> Check for suspicious processes, parent-child relationships</li>
                    <li><strong>File System:</strong> Look for newly created files, modified binaries, unauthorized scripts</li>
                    <li><strong>Network Connections:</strong> Identify active and listening connections</li>
                    <li><strong>User Activity:</strong> Review login history, privilege escalations, account creation</li>
                </ul>
                
                <div class="query-box">
                    <code># Linux Host Investigation Commands
# Check for suspicious processes
ps auxf | grep -v "\[" | awk '{if($3>50.0) print}'

# Find recently modified files (last 24 hours)
find /home /var/www /tmp -type f -mtime -1 -ls

# Check established connections
netstat -antp | grep ESTABLISHED

# Review authentication logs
grep -i "failed\|failure\|invalid" /var/log/auth.log | tail -50

# Check for SUID binaries (privilege escalation)
find / -perm -4000 -type f 2>/dev/null</code>
                </div>
                
                <h4>Phase 3: Threat Intelligence Enrichment</h4>
                <p>Enhance your analysis with external intelligence:</p>
                <ul>
                    <li><strong>IP Reputation:</strong> Check source IPs against threat intelligence feeds (VirusTotal, AbuseIPDB, AlienVault OTX)</li>
                    <li><strong>Domain/URL Analysis:</strong> Investigate suspicious domains for malicious content</li>
                    <li><strong>File Hashing:</strong> Calculate and check file hashes against malware databases</li>
                    <li><strong>MITRE ATT&CK Mapping:</strong> Identify which tactics and techniques were used</li>
                </ul>
                
                <div class="query-box">
                    <code># Threat Intelligence Commands
# Calculate file hash
sha256sum suspicious_file.exe

# Query VirusTotal via CLI (requires API key)
curl -X POST 'https://www.virustotal.com/vtapi/v2/file/report' \
  -d apikey=YOUR_API_KEY -d resource=FILE_HASH

# WHOIS lookup for suspicious domain
whois malicious-domain.com

# DNS history
dig malicious-domain.com ANY +noall +answer</code>
                </div>
                
                <h4>Phase 4: Containment</h4>
                <p>If the investigation confirms malicious activity, take immediate containment actions:</p>
                <div class="important">
                    <strong>‚ö†Ô∏è Containment Actions:</strong>
                    <ul>
                        <li><strong>Network Isolation:</strong> Implement firewall rules to block attacker IPs/domains</li>
                        <li><strong>System Quarantine:</strong> Isolate compromised hosts from network (disconnect or VLAN segregation)</li>
                        <li><strong>Account Lockdown:</strong> Disable compromised user accounts, force password resets</li>
                        <li><strong>Service Termination:</strong> Stop malicious processes or services</li>
                        <li><strong>Evidence Preservation:</strong> Take memory dumps, disk images before remediation</li>
                    </ul>
                </div>
                
                <h4>Phase 5: Remediation and Recovery</h4>
                <ol>
                    <li><strong>Malware Removal:</strong> Clean infected systems using EDR tools or reimaging</li>
                    <li><strong>Patch Vulnerabilities:</strong> Apply security updates that were exploited</li>
                    <li><strong>Restore from Backup:</strong> Use clean backups for critical systems if available</li>
                    <li><strong>Credential Reset:</strong> Change all potentially compromised passwords</li>
                    <li><strong>Security Hardening:</strong> Implement additional controls to prevent recurrence</li>
                </ol>
                
                <h4>Phase 6: Post-Incident Activities</h4>
                <ul>
                    <li><strong>Incident Report:</strong> Document timeline, actions taken, and lessons learned</li>
                    <li><strong>IOC Sharing:</strong> Share indicators with security community and update IDS signatures</li>
                    <li><strong>Tuning:</strong> Adjust IDS rules to reduce false positives and improve detection</li>
                    <li><strong>Metrics:</strong> Track MTTD (Mean Time to Detect) and MTTR (Mean Time to Respond)</li>
                </ul>
                
                <h3>Common IDS Evasion Techniques</h3>
                <p>Attackers employ various techniques to bypass IDS detection. Understanding these helps in improving detection capabilities:</p>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Evasion Technique</th>
                                <th>Description</th>
                                <th>Detection/Mitigation</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Fragmentation</td>
                                <td>Split malicious payload across multiple packets</td>
                                <td>Enable packet reassembly in IDS, normalize fragmented traffic</td>
                            </tr>
                            <tr>
                                <td>Encryption</td>
                                <td>Use HTTPS/SSL to hide malicious payloads</td>
                                <td>TLS inspection, certificate pinning, analyze metadata</td>
                            </tr>
                            <tr>
                                <td>Polymorphism</td>
                                <td>Change malware signature with each iteration</td>
                                <td>Behavioral analysis, sandboxing, anomaly detection</td>
                            </tr>
                            <tr>
                                <td>Protocol Abuse</td>
                                <td>Hide data in legitimate protocol fields (DNS tunneling, ICMP covert channels)</td>
                                <td>Protocol anomaly detection, baseline traffic analysis</td>
                            </tr>
                            <tr>
                                <td>Timing Attacks</td>
                                <td>Slow, low-volume attacks to avoid thresholds</td>
                                <td>Long-term behavioral analysis, correlate events over time</td>
                            </tr>
                            <tr>
                                <td>Obfuscation</td>
                                <td>Encode payloads (Base64, XOR, custom encoding)</td>
                                <td>Multi-layer decoding, entropy analysis, deobfuscation tools</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>IDS Deployment Best Practices</h3>
                <ul>
                    <li><strong>Strategic Placement:</strong> Deploy NIDS at network perimeter, internal segments, and DMZ</li>
                    <li><strong>Signature Updates:</strong> Regularly update IDS rules and signatures (daily or automated)</li>
                    <li><strong>Tuning:</strong> Continuously refine rules to reduce false positives without missing threats</li>
                    <li><strong>Integration:</strong> Forward IDS alerts to SIEM for correlation with other security events</li>
                    <li><strong>Redundancy:</strong> Use multiple detection methods (signature + anomaly + protocol analysis)</li>
                    <li><strong>Testing:</strong> Regularly test IDS with penetration tests and red team exercises</li>
                    <li><strong>Resource Allocation:</strong> Ensure adequate CPU, memory, and storage for packet capture</li>
                    <li><strong>Alert Management:</strong> Implement alert aggregation to prevent analyst fatigue</li>
                </ul>
                
                <div class="tip">
                    <strong>üí° Performance Tip:</strong> In high-traffic environments, consider:
                    <ul>
                        <li>Using hardware-accelerated NICs for packet capture</li>
                        <li>Load balancing across multiple IDS sensors</li>
                        <li>Focusing deep inspection on critical assets only</li>
                        <li>Sampling traffic if full inspection isn't feasible</li>
                    </ul>
                </div>
                
                <h3>MITRE ATT&CK Framework in IDS Context</h3>
                <p>Map IDS detections to MITRE ATT&CK tactics and techniques for better threat understanding:</p>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Tactic</th>
                                <th>Common Techniques</th>
                                <th>IDS Detection Opportunities</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Initial Access</td>
                                <td>Phishing, Exploit Public-Facing Application</td>
                                <td>Suspicious email attachments, exploit signatures, unusual inbound connections</td>
                            </tr>
                            <tr>
                                <td>Execution</td>
                                <td>PowerShell, Command Shell, Scripting</td>
                                <td>Process creation logs, encoded commands, suspicious parent-child relationships</td>
                            </tr>
                            <tr>
                                <td>Persistence</td>
                                <td>Registry Run Keys, Scheduled Tasks, Services</td>
                                <td>Registry modifications, task scheduler activity, new service creation</td>
                            </tr>
                            <tr>
                                <td>Privilege Escalation</td>
                                <td>Exploitation, Token Manipulation</td>
                                <td>Privilege changes, exploitation attempts, SUID binaries</td>
                            </tr>
                            <tr>
                                <td>Defense Evasion</td>
                                <td>Obfuscation, Process Injection, Log Clearing</td>
                                <td>Encoded commands, process anomalies, log tampering indicators</td>
                            </tr>
                            <tr>
                                <td>Credential Access</td>
                                <td>Brute Force, Credential Dumping</td>
                                <td>Multiple failed logins, LSASS access, mimikatz signatures</td>
                            </tr>
                            <tr>
                                <td>Discovery</td>
                                <td>Network Scanning, Account Discovery</td>
                                <td>Port scans, reconnaissance traffic, enumeration activity</td>
                            </tr>
                            <tr>
                                <td>Lateral Movement</td>
                                <td>Remote Services, SMB/Windows Admin Shares</td>
                                <td>Unusual internal connections, admin share access, remote execution</td>
                            </tr>
                            <tr>
                                <td>Collection</td>
                                <td>Data Staged, Archive Collection</td>
                                <td>Large file transfers, compression activity, unusual data access</td>
                            </tr>
                            <tr>
                                <td>Command and Control</td>
                                <td>Web Protocols, DNS, Encrypted Channels</td>
                                <td>Beaconing patterns, DNS tunneling, connections to known C2 IPs</td>
                            </tr>
                            <tr>
                                <td>Exfiltration</td>
                                <td>Exfiltration Over C2, Alternative Protocols</td>
                                <td>Unusual outbound traffic, large data transfers, protocol violations</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Remember:</strong> IDS is a detective control, not preventive. It alerts you to attacks but doesn't block them. 
                    Consider pairing IDS with IPS (Intrusion Prevention System) for automated blocking, but be cautious of false positives 
                    potentially disrupting legitimate traffic.
                </div>
            </div>

            <!-- Detection Engineering Section -->
            <div id="detection-engineering" class="section">
                <h2>üîß Detection Engineering: Building Effective Security Controls</h2>
                
                <h3>What is Detection Engineering?</h3>
                <p>Detection engineering is the discipline of designing, implementing, and maintaining security detection logic that identifies malicious activity while minimizing false positives. It bridges the gap between security theory and operational reality, converting threat intelligence and attack patterns into actionable alerts.</p>
                
                <h3>The Detection Engineering Lifecycle</h3>
                
                <h4>Phase 1: Research & Requirements</h4>
                <ul>
                    <li><strong>Threat Intelligence Gathering:</strong> Subscribe to threat feeds (MISP, AlienVault OTX, SANS ISC), monitor vendor advisories, track CVEs</li>
                    <li><strong>Attack Research:</strong> Study MITRE ATT&CK techniques relevant to your environment, analyze recent breaches in your industry</li>
                    <li><strong>Data Source Identification:</strong> Determine which logs contain relevant signals (Windows Security Event Log, firewall, proxy, EDR)</li>
                    <li><strong>Detection Gap Analysis:</strong> Use ATT&CK Navigator to visualize coverage; prioritize high-risk, low-coverage techniques</li>
                </ul>
                
                <h4>Phase 2: Detection Logic Development</h4>
                <p>Develop detection query that identifies the adversary behavior while accounting for legitimate use cases:</p>
                <div class="query-box">
                    <code># Example: Detecting Mimikatz Credential Dumping
# Splunk SPL
index=windows EventCode=10 
TargetImage="*\\lsass.exe" 
| search CallTrace="*UNKNOWN*" OR GrantedAccess="0x1010" OR GrantedAccess="0x1410"
| stats count by ComputerName, SourceImage, TargetImage, GrantedAccess
| where count > 1

# Detection Logic Explanation:
# - EventCode=10: Sysmon process access event
# - TargetImage=lsass.exe: Targeting credential store
# - CallTrace=UNKNOWN: Unsigned/injected code accessing LSASS
# - GrantedAccess: Specific memory permissions used by credential dumpers</code>
                </div>
                
                <h4>Phase 3: Testing & Validation</h4>
                <ul>
                    <li><strong>Historical Data Testing:</strong> Run query against last 30-90 days of logs to identify baseline false positive rate</li>
                    <li><strong>Attack Simulation:</strong> Use tools (Atomic Red Team, Red Canary) to verify detection fires on actual attack</li>
                    <li><strong>False Positive Analysis:</strong> Investigate each alert; categorize causes (legitimate admin tools, service accounts, business processes)</li>
                    <li><strong>Performance Testing:</strong> Measure query execution time; optimize if exceeds platform timeout (Splunk: 10 min, Sentinel: 10 min)</li>
                </ul>
                
                <h4>Phase 4: Tuning & Optimization</h4>
                <div class="query-box">
                    <code># Refined Detection with Exclusions
index=windows EventCode=10 
TargetImage="*\\lsass.exe" 
| search CallTrace="*UNKNOWN*" OR GrantedAccess="0x1010" OR GrantedAccess="0x1410"
# Exclude known legitimate processes
| search NOT SourceImage="C:\\Windows\\System32\\wbem\\wmiprvse.exe"
| search NOT SourceImage="C:\\Program Files\\Microsoft Monitoring Agent\\*"
| search NOT SourceImage="C:\\Program Files\\CrowdStrike\\*"
# Exclude service accounts
| search NOT user="NT AUTHORITY\\SYSTEM"
| stats count by ComputerName, SourceImage, user, TargetImage, GrantedAccess
| where count > 1</code>
                </div>
                
                <h4>Phase 5: Deployment & Monitoring</h4>
                <ul>
                    <li><strong>Staging Deployment:</strong> Deploy in test mode (audit only) for 1-2 weeks to validate tuning</li>
                    <li><strong>Documentation:</strong> Document detection purpose, MITRE ATT&CK mapping, expected false positives, escalation procedures</li>
                    <li><strong>Alert Enrichment:</strong> Add context fields (user risk score, asset criticality, historical behavior)</li>
                    <li><strong>Response Automation:</strong> Create SOAR playbooks for enrichment (VirusTotal lookup, user context) and containment (disable account, isolate host)</li>
                </ul>
                
                <h4>Phase 6: Continuous Improvement</h4>
                <ul>
                    <li><strong>Monthly Metrics Review:</strong> Track alert volume, true positive rate, MTTR (Mean Time to Respond)</li>
                    <li><strong>Quarterly Tuning:</strong> Analyze false positives; update exclusions; adjust thresholds based on environmental changes</li>
                    <li><strong>Annual Validation:</strong> Re-test detection against current attack tools; verify data sources still available</li>
                    <li><strong>Threat Landscape Updates:</strong> Adapt detections as attacker TTPs evolve</li>
                </ul>
                
                <h3>Detection Logic Patterns</h3>
                
                <h4>Threshold-Based Detection</h4>
                <p>Triggers when activity exceeds normal baseline:</p>
                <div class="query-box">
                    <code># Failed Login Threshold (Brute Force)
index=security EventCode=4625
| stats count by src_ip, user
| where count > 10
| eval severity="High"</code>
                </div>
                <p><strong>Best For:</strong> Brute force, data exfiltration, scanning activity<br><strong>Tuning:</strong> Adjust threshold based on environment (dev servers may have legitimate failures)</p>
                
                <h4>Sequence-Based Detection</h4>
                <p>Detects specific sequence of events indicating attack chain:</p>
                <div class="query-box">
                    <code># Successful Login After Multiple Failures
index=security (EventCode=4625 OR EventCode=4624)
| transaction user maxspan=30m
| search EventCode=4625 EventCode=4624
| stats count by user, src_ip, ComputerName</code>
                </div>
                <p><strong>Best For:</strong> Multi-stage attacks, account takeover, privilege escalation<br><strong>Tuning:</strong> Adjust time window based on typical user behavior</p>
                
                <h4>Anomaly-Based Detection</h4>
                <p>Identifies deviations from established baseline:</p>
                <div class="query-box">
                    <code># Unusual Login Location (Impossible Travel)
index=security EventCode=4624
| iplocation src_ip
| stats values(Country) as countries by user
| eval country_count=mvcount(countries)
| where country_count > 1 AND Country!="United States"</code>
                </div>
                <p><strong>Best For:</strong> Account compromise, insider threats, data exfiltration<br><strong>Tuning:</strong> Requires baseline period (30+ days); adjust for remote workforce</p>
                
                <h4>Correlation-Based Detection</h4>
                <p>Combines multiple data sources to detect complex attacks:</p>
                <div class="query-box">
                    <code># Lateral Movement Detection
index=windows EventCode=4624 LogonType=3
| join user [search index=network action=allowed dest_port=445]
| join src_ip [search index=edr process_name="psexec.exe"]
| stats count by user, src_ip, dest_ip, process_name
| where count > 3</code>
                </div>
                <p><strong>Best For:</strong> Advanced persistent threats, multi-vector attacks<br><strong>Tuning:</strong> Computationally expensive; use sparingly</p>
                
                <h3>Detection Engineering Best Practices</h3>
                
                <h4>The Pyramid of Pain in Detection Context</h4>
                <p>Prioritize detections that force attackers to change costly elements:</p>
                <ol>
                    <li><strong>TTPs (Most Effective):</strong> Detect behaviors (credential dumping, lateral movement) rather than specific tools</li>
                    <li><strong>Tools:</strong> Detect common attack tools (Mimikatz, Cobalt Strike), but expect evasion</li>
                    <li><strong>Network/Host Artifacts:</strong> Registry keys, HTTP headers, user agents - require more attacker effort to change</li>
                    <li><strong>Domain Names:</strong> C2 domains are moderately easy to change</li>
                    <li><strong>IP Addresses:</strong> Easily changed by attackers</li>
                    <li><strong>Hash Values (Least Effective):</strong> Trivially changed; use only for high-confidence IOCs</li>
                </ol>
                
                <h4>MITRE D3FEND Framework</h4>
                <p>Knowledge base of defensive cybersecurity techniques mapped to ATT&CK:</p>
                <ul>
                    <li><strong>Model:</strong> Understand system architecture and attack surface</li>
                    <li><strong>Harden:</strong> Implement preventive controls (least privilege, segmentation)</li>
                    <li><strong>Detect:</strong> Monitor for indicators of compromise and adversary behavior</li>
                    <li><strong>Isolate:</strong> Contain threats through network segmentation and quarantine</li>
                    <li><strong>Deceive:</strong> Deploy deception technology (honeypots, decoy credentials)</li>
                    <li><strong>Evict:</strong> Remove attacker presence through remediation</li>
                </ul>
                
                <h4>Common Detection Pitfalls</h4>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Pitfall</th>
                                <th>Impact</th>
                                <th>Solution</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Overly Broad Query</td>
                                <td>Excessive false positives, alert fatigue</td>
                                <td>Add exclusions for known good; increase threshold</td>
                            </tr>
                            <tr>
                                <td>Overly Narrow Query</td>
                                <td>Misses attack variations (false negatives)</td>
                                <td>Use wildcards, regex; detect behavior not tool</td>
                            </tr>
                            <tr>
                                <td>Fragile Data Dependencies</td>
                                <td>Detection breaks when log source changes</td>
                                <td>Use multiple data sources; monitor data health</td>
                            </tr>
                            <tr>
                                <td>No Baseline Understanding</td>
                                <td>Unable to distinguish normal from malicious</td>
                                <td>Run queries over 30+ days; analyze patterns</td>
                            </tr>
                            <tr>
                                <td>Ignoring Attack Evolution</td>
                                <td>Detection becomes obsolete as tactics change</td>
                                <td>Regular testing with updated attack tools</td>
                            </tr>
                            <tr>
                                <td>Lack of Documentation</td>
                                <td>Analysts don't understand detection purpose</td>
                                <td>Document detection logic, expected alerts, response</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>Detection as Code</h3>
                <p>Modern SOC engineering treats detection rules as code, applying software development best practices:</p>
                <ul>
                    <li><strong>Version Control:</strong> Store detection rules in Git; track changes, enable rollback</li>
                    <li><strong>Code Review:</strong> Peer review detection logic before deployment</li>
                    <li><strong>Testing Framework:</strong> Automated testing with known-good and known-bad datasets</li>
                    <li><strong>CI/CD Pipeline:</strong> Automate deployment to SIEM after passing tests</li>
                    <li><strong>Sigma Rules:</strong> Write detections in platform-agnostic Sigma format; convert to Splunk/Elastic/Sentinel</li>
                </ul>
                
                <div class="query-box">
                    <code># Example Sigma Rule
title: Mimikatz Use
id: 0f06a3a5-6a09-413f-8743-e6cf35561297
status: stable
description: Detects use of Mimikatz credential dumper
references:
    - https://attack.mitre.org/software/S0002/
author: SOC Team
date: 2026/01/29
logsource:
    product: windows
    service: sysmon
detection:
    selection:
        EventID: 10
        TargetImage|endswith: '\lsass.exe'
    filter:
        SourceImage:
            - 'C:\Windows\System32\wbem\wmiprvse.exe'
            - 'C:\Program Files\Microsoft Monitoring Agent\*'
    condition: selection and not filter
falsepositives:
    - Legitimate security tools
level: high
tags:
    - attack.credential_access
    - attack.t1003.001</code>
                </div>
                
                <div class="tip">
                    <strong>üí° Detection Engineering Career Tip:</strong> Detection engineers are highly sought after with salaries ranging $100k-$150k. Develop skills in: SIEM query languages (SPL, KQL), scripting (Python, PowerShell), threat intelligence analysis, and attack simulation tools (Atomic Red Team, Caldera). Contribute to open-source projects like Sigma rules repository to build your portfolio.
                </div>
            </div>

            <!-- Incident Response Section -->
            <div id="incident-response" class="section">
                <h2>üö® Incident Response: Comprehensive Methodology</h2>
                
                <h3>The Incident Response Lifecycle (NIST 800-61)</h3>
                <p>Incident response is a structured approach to managing security breaches, minimizing damage, and recovering normal operations.</p>
                
                <h3>Phase 1: Preparation</h3>
                
                <h4>Pre-Incident Activities</h4>
                <ul>
                    <li><strong>Incident Response Plan:</strong> Document roles, responsibilities, escalation paths, communication procedures</li>
                    <li><strong>Contact Lists:</strong> Maintain updated list of IR team, management, legal, PR, vendors, law enforcement</li>
                    <li><strong>IR Toolkit:</strong> Assemble forensic tools (FTK, Volatility, Wireshark), clean OS images, write blockers</li>
                    <li><strong>Training:</strong> Conduct tabletop exercises quarterly; simulate ransomware, data breach, DDoS scenarios</li>
                    <li><strong>Legal Preparation:</strong> Engage external counsel; understand reporting requirements (GDPR 72hr, state breach notification laws)</li>
                    <li><strong>Baseline Documentation:</strong> Network diagrams, asset inventory, critical business processes, data classification</li>
                </ul>
                
                <h4>Detection Capabilities</h4>
                <ul>
                    <li><strong>SIEM Deployment:</strong> Centralized logging from all critical systems (success and failures)</li>
                    <li><strong>EDR/XDR:</strong> Endpoint visibility for process execution, file operations, network connections</li>
                    <li><strong>Network Monitoring:</strong> IDS/IPS, NetFlow, full packet capture for critical segments</li>
                    <li><strong>Threat Intelligence:</strong> IOC feeds integrated with SIEM; threat hunting program</li>
                </ul>
                
                <h3>Phase 2: Detection & Analysis</h3>
                
                <h4>Initial Detection</h4>
                <p>Incidents typically detected through:</p>
                <ul>
                    <li><strong>SIEM Alerts:</strong> Automated detection rules trigger high-severity alerts</li>
                    <li><strong>User Reports:</strong> Employees report suspicious emails, performance issues, unexpected behavior</li>
                    <li><strong>Threat Hunting:</strong> Proactive searches discover evidence of compromise</li>
                    <li><strong>Third-Party Notification:</strong> Vendor, partner, law enforcement, or researcher reports breach</li>
                </ul>
                
                <h4>Incident Confirmation</h4>
                <p>Validate that alert represents genuine security incident:</p>
                <ol>
                    <li><strong>Initial Triage:</strong> Review alert context; determine if behavior is malicious or benign</li>
                    <li><strong>Evidence Collection:</strong> Gather initial artifacts (logs, screenshots, packet captures)</li>
                    <li><strong>Severity Assessment:</strong> Use incident severity matrix to classify (Critical, High, Medium, Low)</li>
                    <li><strong>Scope Determination:</strong> Identify affected systems, users, data; estimate compromise timeframe</li>
                </ol>
                
                <h4>Incident Severity Matrix</h4>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Severity</th>
                                <th>Criteria</th>
                                <th>Response Time</th>
                                <th>Escalation</th>
                                <th>Examples</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Critical (P0)</strong></td>
                                <td>Active breach, data loss in progress, business-critical system compromised</td>
                                <td>Immediate (< 15 min)</td>
                                <td>CISO, Executive Leadership, Legal, PR</td>
                                <td>Ransomware encryption, active data exfiltration, payment system breach</td>
                            </tr>
                            <tr>
                                <td><strong>High (P1)</strong></td>
                                <td>Confirmed compromise, sensitive data access, privilege escalation</td>
                                <td>< 1 hour</td>
                                <td>IR Team, CISO, Business Unit Lead</td>
                                <td>Malware infection, account takeover, successful exploitation</td>
                            </tr>
                            <tr>
                                <td><strong>Medium (P2)</strong></td>
                                <td>Suspicious activity requiring investigation, policy violations</td>
                                <td>< 4 hours</td>
                                <td>SOC Manager, Asset Owner</td>
                                <td>Brute force attempts, malicious email received, vulnerability scan</td>
                            </tr>
                            <tr>
                                <td><strong>Low (P3)</strong></td>
                                <td>Minor security events, informational alerts</td>
                                <td>< 24 hours</td>
                                <td>Tier 1 Analyst handles</td>
                                <td>Single failed login, expired certificate, non-critical policy violation</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h4>Deep Analysis</h4>
                <p>Conduct thorough investigation to understand full scope:</p>
                <ul>
                    <li><strong>Timeline Construction:</strong> Build chronological event sequence from initial access to detection</li>
                    <li><strong>Lateral Movement Analysis:</strong> Identify all systems accessed by attacker using authentication logs, network flows</li>
                    <li><strong>Data Impact Assessment:</strong> Determine what data was accessed, modified, or exfiltrated</li>
                    <li><strong>Attacker Attribution:</strong> Analyze TTPs, malware artifacts, infrastructure to identify threat actor (if possible)</li>
                    <li><strong>Root Cause Analysis:</strong> Identify vulnerability or weakness exploited (unpatched system, phishing, stolen credentials)</li>
                </ul>
                
                <h3>Phase 3: Containment</h3>
                
                <h4>Short-Term Containment</h4>
                <p>Immediate actions to limit damage while maintaining evidence:</p>
                <ul>
                    <li><strong>Network Isolation:</strong> Disconnect compromised systems from network (physical cable removal if necessary)</li>
                    <li><strong>Account Disablement:</strong> Disable compromised user accounts, revoke tokens, reset passwords</li>
                    <li><strong>Firewall Rules:</strong> Block C2 IP addresses/domains at perimeter and internal firewalls</li>
                    <li><strong>EDR Isolation:</strong> Use EDR platform to isolate hosts while maintaining forensic access</li>
                    <li><strong>Email Quarantine:</strong> Purge malicious emails from all inboxes if phishing campaign</li>
                </ul>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Containment Trade-offs:</strong>
                    <ul>
                        <li><strong>Evidence Preservation:</strong> Don't shut down systems immediately - running processes and memory contain critical evidence</li>
                        <li><strong>Business Continuity:</strong> Balance containment with operational needs; coordinate with business stakeholders</li>
                        <li><strong>Attacker Awareness:</strong> Aggressive containment may alert sophisticated attackers before full scope identified</li>
                        <li><strong>Legal Considerations:</strong> Consult legal counsel before containment actions that might impact evidence admissibility</li>
                    </ul>
                </div>
                
                <h4>Long-Term Containment</h4>
                <p>Sustained actions while eradication is prepared:</p>
                <ul>
                    <li><strong>System Imaging:</strong> Create forensic images of compromised systems before remediation</li>
                    <li><strong>Segmentation:</strong> Place affected segments in quarantine VLAN with restricted access</li>
                    <li><strong>Credential Rotation:</strong> Force password reset for all potentially compromised accounts</li>
                    <li><strong>Enhanced Monitoring:</strong> Deploy additional sensors/logging around affected areas</li>
                    <li><strong>Backup Verification:</strong> Verify integrity and cleanliness of backups before potential restoration</li>
                </ul>
                
                <h3>Phase 4: Eradication</h3>
                
                <h4>Threat Removal</h4>
                <ul>
                    <li><strong>Malware Removal:</strong> Delete malicious files, registry keys, scheduled tasks identified during analysis</li>
                    <li><strong>Account Cleanup:</strong> Remove unauthorized accounts, permissions, backdoor SSH keys</li>
                    <li><strong>Vulnerability Remediation:</strong> Patch exploited vulnerabilities, apply security configurations</li>
                    <li><strong>Persistence Mechanism Removal:</strong> Eliminate scheduled tasks, services, registry run keys, DLL hijacking</li>
                    <li><strong>Rootkit Detection:</strong> Use rootkit scanners (GMER, Rootkit Revealer) for stealthy persistence</li>
                </ul>
                
                <h4>Validation</h4>
                <ul>
                    <li><strong>Clean System Verification:</strong> Scan with multiple AV engines, compare against known-good baseline</li>
                    <li><strong>IOC Hunting:</strong> Search across environment for same IOCs to identify other compromised systems</li>
                    <li><strong>Log Review:</strong> Verify no malicious activity since containment began</li>
                </ul>
                
                <h3>Phase 5: Recovery</h3>
                
                <h4>System Restoration</h4>
                <ul>
                    <li><strong>Decision: Rebuild vs Remediate:</strong> 
                        <ul>
                            <li><strong>Rebuild (Recommended):</strong> Reimage systems from clean gold images; highest assurance of cleanliness</li>
                            <li><strong>Remediate:</strong> Remove malware in-place; faster but risk of persistent compromise</li>
                        </ul>
                    </li>
                    <li><strong>Restore from Backup:</strong> If rebuilding, restore data from last known clean backup (pre-incident)</li>
                    <li><strong>System Hardening:</strong> Apply security baselines, remove unnecessary services, implement least privilege</li>
                    <li><strong>Monitoring Enhancement:</strong> Deploy additional detection coverage, create incident-specific alerts</li>
                </ul>
                
                <h4>Phased Return to Production</h4>
                <ol>
                    <li><strong>Pilot Phase (Week 1):</strong> Return limited systems with intense monitoring</li>
                    <li><strong>Validation Phase (Week 2):</strong> Confirm no reinfection; expand system count</li>
                    <li><strong>Full Production (Week 3+):</strong> All systems restored; maintain enhanced monitoring for 30 days</li>
                </ol>
                
                <h3>Phase 6: Post-Incident Activity</h3>
                
                <h4>Lessons Learned Meeting</h4>
                <p>Conducted within 2 weeks of incident closure:</p>
                <ul>
                    <li><strong>Participants:</strong> IR team, affected business units, management, external consultants (if used)</li>
                    <li><strong>Agenda:</strong>
                        <ul>
                            <li>What happened? (timeline review)</li>
                            <li>What went well? (identify effective practices)</li>
                            <li>What needs improvement? (gaps in detection, response, communication)</li>
                            <li>Action items with owners and due dates</li>
                        </ul>
                    </li>
                    <li><strong>No-Blame Culture:</strong> Focus on process improvement, not individual fault</li>
                </ul>
                
                <h4>Documentation Deliverables</h4>
                <ul>
                    <li><strong>Executive Summary:</strong> High-level incident overview, business impact, remediation status (1-2 pages)</li>
                    <li><strong>Technical Report:</strong> Detailed timeline, IOCs, attack vectors, forensic findings (10-50 pages)</li>
                    <li><strong>Regulatory Notifications:</strong> Breach notifications if required (GDPR, CCPA, HIPAA, PCI-DSS)</li>
                    <li><strong>Insurance Claims:</strong> Documentation for cyber insurance claim if applicable</li>
                    <li><strong>Threat Intelligence Sharing:</strong> Share sanitized IOCs with ISACs, threat intelligence platforms</li>
                </ul>
                
                <h4>Process Improvements</h4>
                <ul>
                    <li><strong>Detection Gaps:</strong> Create new SIEM rules to detect similar attacks</li>
                    <li><strong>Playbook Updates:</strong> Document incident-specific procedures for future reference</li>
                    <li><strong>Technology Investment:</strong> Justify budget for security tools that would have prevented/detected incident</li>
                    <li><strong>Training:</strong> Conduct organization-wide security awareness if social engineering was involved</li>
                    <li><strong>Policy Updates:</strong> Revise security policies addressing identified weaknesses</li>
                </ul>
                
                <div class="tip">
                    <strong>üí° Incident Response Career Tip:</strong> Incident responders earn $100k-$140k with experience. Differentiate yourself by: obtaining GCIH or GCFA certifications, practicing with hands-on incident simulation labs, learning forensics tools (FTK, EnCase, Volatility), and understanding legal aspects of incident handling. Maintain a "war stories" document of incidents handled for interview discussions.
                </div>
            </div>

            <!-- Threat Hunting Section -->
            <div id="threat-hunting" class="section">
                <h2>üéØ Threat Hunting: Proactive Defense</h2>
                
                <h3>What is Threat Hunting?</h3>
                <p>Threat hunting is the proactive search for cyber threats that evade existing security solutions. Unlike reactive alert-driven analysis, hunting assumes breach and seeks evidence of compromise through hypothesis-driven investigation.</p>
                
                <h3>The Threat Hunting Loop</h3>
                <ol>
                    <li><strong>Hypothesis Generation:</strong> Develop theory about potential threat based on intelligence, observations, or risk assessment</li>
                    <li><strong>Investigation:</strong> Search for evidence using SIEM queries, EDR telemetry, network traffic analysis</li>
                    <li><strong>Pattern Discovery:</strong> Identify suspicious patterns, anomalies, or indicators</li>
                    <li><strong>Response:</strong> If threat confirmed, escalate to incident response; if benign, document findings</li>
                    <li><strong>Detection Engineering:</strong> Convert successful hunt to automated detection rule</li>
                </ol>
                
                <h3>Threat Hunting Methodologies</h3>
                
                <h4>1. Intelligence-Driven Hunting</h4>
                <p>Start with specific IOC or TTP from threat intelligence:</p>
                <div class="query-box">
                    <code># Example: Hunt for specific malware hash reported in threat intel
index=edr EventType=FileCreation
| search MD5="a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6"
| stats count by ComputerName, FilePath, User
| sort -count

# Pivot to related indicators
| search ComputerName="INFECTED-HOST"
| stats values(Process), values(NetworkConnection) by ComputerName</code>
                </div>
                <p><strong>Advantages:</strong> High-confidence leads, clear success criteria<br><strong>Limitations:</strong> Only finds known threats, requires quality intelligence</p>
                
                <h4>2. Hypothesis-Driven Hunting</h4>
                <p>Develop theory based on attacker behavior or emerging threats:</p>
                <div class="query-box">
                    <code># Hypothesis: Attackers using Living-off-the-Land Binaries (LOLBins) for persistence
# Hunt for unusual scheduled tasks created by suspicious processes
index=windows EventCode=4698  # Task created
| rex field=Task_Name "(?<task_name>.*)"
| search Command IN ("*powershell*", "*cmd.exe*", "*wscript*", "*cscript*", "*regsvr32*")
| eval suspicious_score=0
| eval suspicious_score=if(like(Command,"%bypass%"),suspicious_score+2,suspicious_score)
| eval suspicious_score=if(like(Command,"%encoded%"),suspicious_score+2,suspicious_score)
| eval suspicious_score=if(like(Author,"%SYSTEM%"),suspicious_score-1,suspicious_score)
| where suspicious_score > 2
| table _time, ComputerName, Task_Name, Command, Author, suspicious_score
| sort -suspicious_score</code>
                </div>
                <p><strong>Advantages:</strong> Discovers novel threats, adaptable to environment<br><strong>Limitations:</strong> Requires deep expertise, time-intensive</p>
                
                <h4>3. Situational Awareness Hunting (Baseline Deviation)</h4>
                <p>Establish normal behavior baseline; hunt for anomalies:</p>
                <div class="query-box">
                    <code># Hunt for users logging in from unusual locations
index=security EventCode=4624
| iplocation src_ip
| stats dc(Country) as country_count, values(Country) as countries by user
| where country_count > 1
| join user [search index=security EventCode=4624 earliest=-30d | iplocation src_ip | stats values(Country) as baseline_countries by user]
| eval new_countries=mvfilter(NOT match(countries, baseline_countries))
| where isnotnull(new_countries)
| table user, countries, new_countries, country_count</code>
                </div>
                <p><strong>Advantages:</strong> Finds insider threats and account compromise<br><strong>Limitations:</strong> Requires accurate baseline, high false positive potential</p>
                
                <h3>Threat Hunting Maturity Model</h3>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Level</th>
                                <th>Capability</th>
                                <th>Characteristics</th>
                                <th>Effort Required</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>HM0 - Initial</strong></td>
                                <td>No hunting program; purely reactive</td>
                                <td>Rely on alerts; no proactive searches</td>
                                <td>N/A</td>
                            </tr>
                            <tr>
                                <td><strong>HM1 - Minimal</strong></td>
                                <td>Ad-hoc hunting based on intelligence</td>
                                <td>Hunt after major industry breach; IOC searches</td>
                                <td>< 5% of SOC time</td>
                            </tr>
                            <tr>
                                <td><strong>HM2 - Procedural</strong></td>
                                <td>Regular hunting following defined procedures</td>
                                <td>Monthly/quarterly hunts; documented methodology</td>
                                <td>10-20% of SOC time</td>
                            </tr>
                            <tr>
                                <td><strong>HM3 - Innovative</strong></td>
                                <td>Data-driven hunting with analytics</td>
                                <td>Behavioral analysis; machine learning-assisted; dedicated hunters</td>
                                <td>20-40% dedicated team time</td>
                            </tr>
                            <tr>
                                <td><strong>HM4 - Leading</strong></td>
                                <td>Automated hunting with human oversight</td>
                                <td>AI-driven hypothesis generation; autonomous investigation</td>
                                <td>Continuous, automated</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>Essential Threat Hunting Tools</h3>
                
                <h4>Data Sources</h4>
                <ul>
                    <li><strong>EDR Telemetry:</strong> Process execution, file operations, registry modifications, network connections</li>
                    <li><strong>Network Data:</strong> NetFlow, full packet capture (PCAP), DNS logs, proxy logs</li>
                    <li><strong>Authentication Logs:</strong> Windows Security Event Log, VPN, cloud service sign-ins</li>
                    <li><strong>Cloud Logs:</strong> AWS CloudTrail, Azure Activity Logs, Google Cloud Audit Logs</li>
                </ul>
                
                <h4>Analysis Tools</h4>
                <ul>
                    <li><strong>SIEM Platforms:</strong> Splunk, Elastic, Azure Sentinel for large-scale log analysis</li>
                    <li><strong>EDR Platforms:</strong> CrowdStrike, Microsoft Defender, Carbon Black for endpoint visibility</li>
                    <li><strong>Network Analysis:</strong> Wireshark, Zeek, NetworkMiner for traffic inspection</li>
                    <li><strong>Threat Intelligence Platforms:</strong> MISP, OpenCTI, ThreatConnect for IOC management</li>
                    <li><strong>Visualization:</strong> Kibana, Grafana for pattern identification</li>
                </ul>
                
                <h3>Practical Hunting Scenarios</h3>
                
                <h4>Hunt 1: Credential Dumping Activity</h4>
                <p><strong>Hypothesis:</strong> Attackers are using Mimikatz or similar tools to dump credentials</p>
                <div class="query-box">
                    <code># Hunt for LSASS access patterns
index=windows EventCode=10 TargetImage="*\\lsass.exe"
| stats count, values(SourceImage) as processes by ComputerName
| where count > 5
| search NOT processes="C:\\Windows\\System32\\*"</code>
                </div>
                <p><strong>Indicators:</strong> Unsigned processes accessing LSASS, memory dumping tools, suspicious CallTrace</p>
                
                <h4>Hunt 2: Command and Control Communication</h4>
                <p><strong>Hypothesis:</strong> Malware is beaconing to C2 infrastructure</p>
                <div class="query-box">
                    <code># Hunt for beaconing behavior (regular time intervals)
index=proxy
| bin _time span=1m
| stats count by _time, src_ip, dest_ip, dest_port
| eventstats stdev(count) as count_stdev, avg(count) as count_avg by src_ip, dest_ip
| where count_stdev < 2 AND count_avg > 2
| stats count as beacon_count by src_ip, dest_ip, dest_port
| where beacon_count > 60</code>
                </div>
                <p><strong>Indicators:</strong> Consistent intervals (every 60s, 5min), small data transfers, unusual ports</p>
                
                <h4>Hunt 3: Lateral Movement</h4>
                <p><strong>Hypothesis:</strong> Compromised account being used for lateral movement</p>
                <div class="query-box">
                    <code># Hunt for rapid authentication across multiple systems
index=security EventCode=4624 LogonType=3
| bucket _time span=5m
| stats dc(ComputerName) as host_count, values(ComputerName) as hosts by _time, user
| where host_count > 5
| table _time, user, host_count, hosts</code>
                </div>
                <p><strong>Indicators:</strong> Same account logging into many systems, admin shares access (C$, ADMIN$), remote execution</p>
                
                <div class="tip">
                    <strong>üí° Threat Hunting Career Tip:</strong> Threat hunters are among the highest-paid SOC roles ($100k-$145k) due to required expertise. Build hunting skills by: studying ATT&CK techniques deeply, practicing with open datasets (BOTS, Mordor), learning advanced analytics (statistics, machine learning basics), and documenting your hunt hypotheses and findings in a blog or GitHub repository.
                </div>
            </div>

            <!-- Tools and Techniques Section -->
            <div id="tools-techniques" class="section">
                <h2>üõ†Ô∏è Essential Tools and Techniques</h2>
                
                <h3>Blue Team Essential Tools</h3>
                
                <h4>SIEM Platforms</h4>
                <ul>
                    <li><strong>Splunk Enterprise Security:</strong> Industry-leading SIEM with extensive app ecosystem; uses SPL query language</li>
                    <li><strong>Elastic Stack (ELK):</strong> Open-source alternative; uses Lucene query syntax and KQL</li>
                    <li><strong>Microsoft Sentinel:</strong> Cloud-native SIEM; uses Kusto Query Language (KQL); tight Azure integration</li>
                    <li><strong>IBM QRadar:</strong> Enterprise SIEM with strong correlation engine; AQL query language</li>
                </ul>
                
                <h4>Endpoint Detection and Response (EDR)</h4>
                <ul>
                    <li><strong>CrowdStrike Falcon:</strong> Cloud-delivered EDR with strong threat intelligence; Real-Time Response (RTR) capabilities</li>
                    <li><strong>Microsoft Defender for Endpoint:</strong> Native Windows integration; advanced hunting with KQL</li>
                    <li><strong>Carbon Black:</strong> VMware-owned EDR; strong behavioral detection and prevention</li>
                    <li><strong>SentinelOne:</strong> AI-driven autonomous response; strong MacOS/Linux support</li>
                </ul>
                
                <h4>Network Security Monitoring</h4>
                <ul>
                    <li><strong>Security Onion:</strong> Free Linux distribution with Suricata IDS, Zeek, Elasticsearch</li>
                    <li><strong>Wireshark:</strong> Industry-standard packet analyzer; essential for deep packet inspection</li>
                    <li><strong>Zeek (Bro):</strong> Network analysis framework; generates high-level logs from traffic</li>
                    <li><strong>Suricata:</strong> Open-source IDS/IPS; supports Snort rules plus advanced features</li>
                </ul>
                
                <h4>Forensics and Malware Analysis</h4>
                <ul>
                    <li><strong>FTK (Forensic Toolkit):</strong> Comprehensive disk forensics; file carving, registry analysis</li>
                    <li><strong>Volatility:</strong> Advanced memory forensics framework; analyze memory dumps</li>
                    <li><strong>Autopsy:</strong> Open-source digital forensics platform; GUI for The Sleuth Kit</li>
                    <li><strong>YARA:</strong> Pattern matching for malware; create signatures based on binary/textual patterns</li>
                    <li><strong>Cuckoo Sandbox:</strong> Automated malware analysis; executes samples in isolated environment</li>
                </ul>
                
                <h4>Threat Intelligence Platforms</h4>
                <ul>
                    <li><strong>MISP (Malware Information Sharing Platform):</strong> Open-source threat intel platform</li>
                    <li><strong>AlienVault OTX:</strong> Free threat intelligence community</li>
                    <li><strong>VirusTotal:</strong> Multi-engine file/URL scanning; extensive file reputation database</li>
                    <li><strong>abuse.ch:</strong> Free threat intel feeds (URLhaus, MalwareBazaar, ThreatFox)</li>
                </ul>
                
                <h3>Red Team Tools (Know Your Adversary)</h3>
                
                <h4>Reconnaissance</h4>
                <ul>
                    <li><strong>Nmap:</strong> Network scanner; port discovery, service enumeration, OS fingerprinting</li>
                    <li><strong>Shodan:</strong> Search engine for Internet-connected devices; find exposed services</li>
                    <li><strong>theHarvester:</strong> OSINT gathering; email addresses, subdomains, IPs from public sources</li>
                    <li><strong>Amass:</strong> In-depth DNS enumeration and network mapping</li>
                </ul>
                
                <h4>Exploitation</h4>
                <ul>
                    <li><strong>Metasploit:</strong> Comprehensive exploitation framework; thousands of exploits and payloads</li>
                    <li><strong>Cobalt Strike:</strong> Commercial post-exploitation tool; popular with red teams and threat actors</li>
                    <li><strong>Burp Suite:</strong> Web application security testing; intercept and modify HTTP requests</li>
                    <li><strong>SQLMap:</strong> Automated SQL injection and database takeover tool</li>
                </ul>
                
                <h4>Post-Exploitation</h4>
                <ul>
                    <li><strong>Mimikatz:</strong> Credential dumping from Windows memory; golden ticket attacks</li>
                    <li><strong>BloodHound:</strong> Active Directory attack path analysis; visualizes privilege escalation paths</li>
                    <li><strong>CrackMapExec:</strong> Swiss army knife for pentesting Windows networks</li>
                    <li><strong>Impacket:</strong> Python classes for working with network protocols; SMB, Kerberos exploitation</li>
                </ul>
                
                <h3>CTF and Training Platforms</h3>
                
                <h4>Blue Team Training</h4>
                <ul>
                    <li><strong>Boss of the SOC (BOTS):</strong> Splunk-based CTF datasets simulating real breaches</li>
                    <li><strong>CyberDefenders:</strong> Blue team CTF challenges; analyze artifacts, hunt threats</li>
                    <li><strong>LetsDefend:</strong> SOC analyst training with realistic incident scenarios</li>
                    <li><strong>Blue Team Labs Online:</strong> Hands-on defensive security challenges</li>
                </ul>
                
                <h4>General Security Skills</h4>
                <ul>
                    <li><strong>TryHackMe:</strong> Beginner-friendly; guided learning paths for security fundamentals</li>
                    <li><strong>HackTheBox:</strong> Advanced penetration testing challenges; active machines and retired walkthroughs</li>
                    <li><strong>PicoCTF:</strong> Beginner CTF from Carnegie Mellon; great for learning basics</li>
                    <li><strong>OverTheWire:</strong> War games teaching security concepts through challenges</li>
                </ul>
                
                <h3>Home Lab Setup Guide</h3>
                
                <h4>Virtualization Platform</h4>
                <ul>
                    <li><strong>VMware Workstation Pro:</strong> Powerful features; snapshots, cloning, network simulation ($200 license)</li>
                    <li><strong>VirtualBox:</strong> Free alternative; sufficient for most labs</li>
                    <li><strong>Proxmox:</strong> Enterprise-grade; install on dedicated hardware; manage VMs through web interface</li>
                </ul>
                
                <h4>Essential Lab VMs</h4>
                <ul>
                    <li><strong>Windows Domain Controller:</strong> Windows Server 2019/2022; Active Directory setup</li>
                    <li><strong>Windows 10/11 Workstations:</strong> 2-3 domain-joined endpoints for testing</li>
                    <li><strong>Linux Server:</strong> Ubuntu Server; practice log analysis, SSH hardening</li>
                    <li><strong>Security Onion:</strong> NIDS/SIEM platform for detection practice</li>
                    <li><strong>Kali Linux:</strong> Attacker machine for simulating attacks</li>
                    <li><strong>Metasploitable/DVWA:</strong> Intentionally vulnerable machines for testing</li>
                </ul>
                
                <h4>Lab Network Architecture</h4>
                <div class="query-box">
                    <code># Recommended Network Segmentation
Management Network: 192.168.1.0/24
  - Your host machine
  - Access to all networks
  
Corporate Network: 10.0.0.0/24
  - Domain Controller: 10.0.0.10
  - Windows Workstations: 10.0.0.20-30
  - Linux Server: 10.0.0.40
  
Security Tools Network: 10.1.0.0/24
  - Security Onion: 10.1.0.10
  - Splunk: 10.1.0.20
  - SIEM receives logs from Corporate Network
  
Attacker Network: 192.168.100.0/24
  - Kali Linux: 192.168.100.10
  - Isolated except for attacks into Corporate Network</code>
                </div>
                
                <h4>Lab Exercises</h4>
                <ol>
                    <li><strong>Week 1-2:</strong> Setup infrastructure; configure logging to Security Onion or Splunk</li>
                    <li><strong>Week 3-4:</strong> Practice SIEM queries; create detection rules for common attacks</li>
                    <li><strong>Week 5-6:</strong> Simulate attacks from Kali; detect and respond in SIEM</li>
                    <li><strong>Week 7-8:</strong> Practice incident response; contain and remediate simulated breaches</li>
                    <li><strong>Week 9-10:</strong> Threat hunting exercises; search for compromises without alerts</li>
                    <li><strong>Week 11-12:</strong> Automation; create SOAR playbooks for common response actions</li>
                </ol>
                
                <div class="tip">
                    <strong>üí° Lab Building Tip:</strong> Start small - don't try to build everything at once. Begin with 1 Windows DC, 1 workstation, Security Onion, and Kali. Add complexity as you gain comfort. Document your builds - you'll need to rebuild systems frequently. Use snapshots liberally before making changes.
                </div>
            </div>

            <!-- Career Development Section -->
            <div id="career-development" class="section">
                <h2>üìà Professional Career Development</h2>
                
                <h3>Continuous Learning and Skill Development</h3>
                
                <h4>Technical Skills Prioritization</h4>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Skill Category</th>
                                <th>Essential Skills</th>
                                <th>Learning Resources</th>
                                <th>Time Investment</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Networking</strong></td>
                                <td>TCP/IP, DNS, HTTP/HTTPS, routing, firewalls</td>
                                <td>CompTIA Network+, Cisco CCNA, Professor Messer videos</td>
                                <td>3-6 months</td>
                            </tr>
                            <tr>
                                <td><strong>Operating Systems</strong></td>
                                <td>Windows (Event Logs, PowerShell), Linux (syslog, bash)</td>
                                <td>Windows Server Admin course, Linux Academy, OverTheWire</td>
                                <td>3-6 months</td>
                            </tr>
                            <tr>
                                <td><strong>SIEM Platforms</strong></td>
                                <td>SPL (Splunk), KQL (Sentinel), Lucene (Elastic)</td>
                                <td>Splunk Fundamentals, Microsoft Learn, Elastic training</td>
                                <td>2-4 months</td>
                            </tr>
                            <tr>
                                <td><strong>Scripting</strong></td>
                                <td>Python, PowerShell, Bash</td>
                                <td>Automate the Boring Stuff, PowerShell in a Month of Lunches</td>
                                <td>3-6 months</td>
                            </tr>
                            <tr>
                                <td><strong>Threat Intelligence</strong></td>
                                <td>MITRE ATT&CK, threat actor TTPs, IOC analysis</td>
                                <td>ATT&CK training, threat intel feeds, security blogs</td>
                                <td>Ongoing</td>
                            </tr>
                            <tr>
                                <td><strong>Incident Response</strong></td>
                                <td>Containment, forensics, malware analysis</td>
                                <td>SANS FOR508, GCIH certification, IR playbooks</td>
                                <td>6-12 months</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>Building Your Professional Brand</h3>
                
                <h4>Online Presence</h4>
                <ul>
                    <li><strong>LinkedIn Optimization:</strong>
                        <ul>
                            <li>Professional headshot and banner</li>
                            <li>Detailed work experience with quantified achievements</li>
                            <li>Skills endorsed by colleagues and managers</li>
                            <li>Regular posts sharing security insights (weekly target)</li>
                            <li>Engage with security community content</li>
                        </ul>
                    </li>
                    <li><strong>GitHub Portfolio:</strong>
                        <ul>
                            <li>SIEM detection rules you've created (Sigma format)</li>
                            <li>Automation scripts (Python, PowerShell)</li>
                            <li>CTF writeups and solutions</li>
                            <li>Home lab documentation</li>
                            <li>Contribute to open-source security projects</li>
                        </ul>
                    </li>
                    <li><strong>Personal Website/Blog:</strong>
                        <ul>
                            <li>Technical blog posts (monthly target)</li>
                            <li>Writeups of interesting investigations (sanitized)</li>
                            <li>Tutorial content for aspiring analysts</li>
                            <li>Portfolio of projects and certifications</li>
                        </ul>
                    </li>
                </ul>
                
                <h4>Community Engagement</h4>
                <ul>
                    <li><strong>Conferences:</strong> Attend BSides, SANS, RSA, Black Hat (or watch talks online)</li>
                    <li><strong>Local Meetups:</strong> Join OWASP chapter, security meetup groups, industry-specific ISACs</li>
                    <li><strong>Online Communities:</strong> Active participation in Reddit (r/cybersecurity), Discord servers, Twitter infosec community</li>
                    <li><strong>Mentorship:</strong> Both seek mentors (more experienced professionals) and mentor others (newer analysts)</li>
                </ul>
                
                <h3>Job Search Strategies</h3>
                
                <h4>Resume Optimization for SOC Roles</h4>
                <ul>
                    <li><strong>Format:</strong> ATS-friendly (avoid tables, graphics); clean, professional design</li>
                    <li><strong>Keywords:</strong> Extract keywords from job description; incorporate naturally throughout resume</li>
                    <li><strong>Experience Section:</strong>
                        <ul>
                            <li>Use action verbs (Analyzed, Detected, Investigated, Automated, Implemented)</li>
                            <li>Quantify achievements (Reduced MTTR by 30%, Analyzed 500+ alerts weekly, Automated 15+ manual processes)</li>
                            <li>Include relevant tools (Splunk, CrowdStrike, Wireshark, Python)</li>
                        </ul>
                    </li>
                    <li><strong>Projects Section:</strong> Include home lab projects, CTF achievements, open-source contributions</li>
                    <li><strong>Certifications:</strong> List prominently; include expected completion dates for in-progress certs</li>
                </ul>
                
                <h4>Interview Preparation</h4>
                
                <p><strong>Technical Questions:</strong></p>
                <ul>
                    <li>"Walk me through your incident response process for a ransomware infection"</li>
                    <li>"How would you detect lateral movement in a Windows environment?"</li>
                    <li>"Explain the difference between IDS and IPS"</li>
                    <li>"What SIEM queries would you write to detect brute force attacks?"</li>
                    <li>"How do you prioritize alerts when multiple high-severity incidents occur simultaneously?"</li>
                </ul>
                
                <p><strong>Behavioral Questions (STAR Method):</strong></p>
                <ul>
                    <li>"Tell me about a time you identified a security threat that others missed"</li>
                    <li>"Describe a situation where you had to work under pressure during an active incident"</li>
                    <li>"Give an example of how you handled a disagreement with a team member"</li>
                    <li>"Tell me about a time you made a mistake and how you handled it"</li>
                </ul>
                
                <p><strong>Questions to Ask Interviewer:</strong></p>
                <ul>
                    <li>"What does a typical day look like for someone in this role?"</li>
                    <li>"What SIEM and security tools does your SOC use?"</li>
                    <li>"How does the team handle on-call rotations and shift work?"</li>
                    <li>"What opportunities exist for professional development and training?"</li>
                    <li>"Can you describe a recent interesting incident the team handled?"</li>
                    <li>"What are the biggest challenges facing the SOC currently?"</li>
                </ul>
                
                <h3>Workplace Excellence</h3>
                
                <h4>First 90 Days in New SOC Role</h4>
                <ol>
                    <li><strong>Days 1-30 (Learning):</strong>
                        <ul>
                            <li>Shadow experienced analysts; observe alert triage process</li>
                            <li>Study internal documentation, playbooks, escalation procedures</li>
                            <li>Learn SIEM platform specifics; practice query writing</li>
                            <li>Understand team dynamics, communication channels, reporting structure</li>
                        </ul>
                    </li>
                    <li><strong>Days 31-60 (Contributing):</strong>
                        <ul>
                            <li>Handle alerts independently with supervision</li>
                            <li>Ask questions; clarify uncertainties; document learnings</li>
                            <li>Identify process improvement opportunities</li>
                            <li>Build relationships with team members across shifts</li>
                        </ul>
                    </li>
                    <li><strong>Days 61-90 (Excelling):</strong>
                        <ul>
                            <li>Fully independent alert handling</li>
                            <li>Propose detection rule improvements</li>
                            <li>Volunteer for projects (automation, detection engineering)</li>
                            <li>Begin mentoring newer team members</li>
                        </ul>
                    </li>
                </ol>
                
                <h4>Standing Out for Promotion</h4>
                <ul>
                    <li><strong>Documentation Excellence:</strong> Maintain high-quality ticket documentation; create runbooks</li>
                    <li><strong>Continuous Learning:</strong> Pursue certifications; share learnings with team</li>
                    <li><strong>Initiative:</strong> Volunteer for challenging incidents; propose automation projects</li>
                    <li><strong>Collaboration:</strong> Help colleagues; participate in lessons learned; mentor new hires</li>
                    <li><strong>Metrics Awareness:</strong> Understand and improve personal metrics (MTTR, ticket quality, escalation rate)</li>
                </ul>
                
                <h3>Handling Burnout and Work-Life Balance</h3>
                
                <h4>Recognizing Burnout Signs</h4>
                <ul>
                    <li>Decreased motivation and enthusiasm for work</li>
                    <li>Cynicism about alerts and security incidents</li>
                    <li>Physical symptoms (headaches, insomnia, fatigue)</li>
                    <li>Reduced performance and increased errors</li>
                    <li>Social withdrawal from team and isolation</li>
                </ul>
                
                <h4>Burnout Prevention Strategies</h4>
                <ul>
                    <li><strong>Clear Boundaries:</strong> Don't check work communications during off hours (unless on-call)</li>
                    <li><strong>Use PTO:</strong> Take vacations; disconnect completely during time off</li>
                    <li><strong>Shift Rotation:</strong> Request day shift after extended night shift periods</li>
                    <li><strong>Physical Health:</strong> Exercise, sleep hygiene, healthy eating during night shifts</li>
                    <li><strong>Professional Support:</strong> Talk to manager about workload; use employee assistance programs</li>
                    <li><strong>Outside Interests:</strong> Maintain hobbies and relationships outside of cybersecurity</li>
                </ul>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Career Reality Check:</strong> SOC work can be stressful and repetitive. Not everyone enjoys it long-term. Consider SOC as a stepping stone (2-3 years) to specialized roles (detection engineering, threat hunting, incident response, management) rather than a 20-year career path. It's okay to pivot if SOC operations aren't fulfilling.
                </div>
                
                <div class="tip">
                    <strong>üí° Career Progression Tip:</strong> Most successful SOC professionals follow this path: Tier 1 Analyst (1-2 years) ‚Üí Tier 2 Analyst (2-3 years) ‚Üí Specialization (Detection Engineer, Threat Hunter, Incident Responder, or SOC Manager). Total time to senior role: 4-6 years with continuous learning and certification acquisition. Fastest progression occurs when you demonstrate initiative, document well, and solve problems proactively.
                </div>
            </div>

            <!-- Best Practices Section -->
            <div id="best-practices" class="section">
                <h2>‚úÖ Best Practices and Investigation Frameworks</h2>
                
                <h3>Governance, Risk, and Compliance (GRC) in the SOC</h3>
                <p>SOC operations exist at the intersection of technical security and regulatory compliance. Understanding GRC requirements is essential for SOC analysts, particularly when handling incidents involving regulated data.</p>
                
                <h4>Why GRC Matters to SOC Analysts</h4>
                <ul>
                    <li><strong>Incident Classification:</strong> Regulatory requirements determine incident severity, notification timelines, and reporting obligations</li>
                    <li><strong>Evidence Handling:</strong> Legal and regulatory standards dictate proper evidence collection, chain of custody, and retention</li>
                    <li><strong>Log Retention:</strong> Compliance frameworks specify minimum log retention periods (90 days to 7 years depending on regulation)</li>
                    <li><strong>Breach Notification:</strong> Understanding when and how to report breaches to regulators, customers, and affected individuals</li>
                    <li><strong>Audit Support:</strong> SIEM logs serve as primary evidence during compliance audits</li>
                </ul>
                
                <h4>Major Compliance Frameworks</h4>
                
                <h5>1. PCI DSS (Payment Card Industry Data Security Standard)</h5>
                <p><strong>Scope:</strong> Organizations that store, process, or transmit credit card information</p>
                <ul>
                    <li><strong>Requirement 10:</strong> Track and monitor all access to network resources and cardholder data
                        <ul>
                            <li>10.1: Implement audit trails</li>
                            <li>10.2: Log all user activities, exceptions, and security events</li>
                            <li>10.3: Record minimum: user ID, event type, timestamp, success/failure, origination, identity of affected data</li>
                            <li>10.5.1: Limit log viewing to authorized personnel</li>
                            <li>10.6: Review logs daily for anomalies</li>
                            <li>10.7: Retain audit trail history at least 1 year, with minimum of 3 months immediately available</li>
                        </ul>
                    </li>
                    <li><strong>Requirement 11:</strong> Test security systems and processes regularly
                        <ul>
                            <li>11.5: Deploy intrusion detection/prevention systems</li>
                            <li>11.6: Deploy file integrity monitoring</li>
                        </ul>
                    </li>
                </ul>
                <p><strong>SOC Impact:</strong> Must monitor payment processing systems with heightened scrutiny; incidents involving cardholder data trigger breach notification requirements (notify acquiring bank within 72 hours)</p>
                
                <h5>2. HIPAA (Health Insurance Portability and Accountability Act)</h5>
                <p><strong>Scope:</strong> Healthcare providers, health plans, healthcare clearinghouses, and business associates handling Protected Health Information (PHI)</p>
                <ul>
                    <li><strong>Security Rule ¬ß164.312(b):</strong> Implement hardware, software, and procedural mechanisms that record and examine activity in information systems containing ePHI</li>
                    <li><strong>Audit Controls:</strong> Mechanisms to record and examine access and activity in systems containing ePHI</li>
                    <li><strong>Breach Notification Rule:</strong> 
                        <ul>
                            <li>Notify affected individuals within 60 days</li>
                            <li>Notify HHS (Department of Health and Human Services): immediately if affecting 500+ individuals; annually for smaller breaches</li>
                            <li>Notify media if breach affects 500+ residents of a state/jurisdiction</li>
                        </ul>
                    </li>
                    <li><strong>Log Retention:</strong> Minimum 6 years from date of creation or last effective date</li>
                </ul>
                <p><strong>SOC Impact:</strong> PHI breaches require complex notification process; forensic evidence must determine if PHI was accessed/exfiltrated; encryption and access logs critical for breach determination</p>
                
                <h5>3. SOX (Sarbanes-Oxley Act)</h5>
                <p><strong>Scope:</strong> All publicly traded companies in the United States</p>
                <ul>
                    <li><strong>Section 302:</strong> Corporate responsibility for financial reports; CEOs/CFOs certify accuracy of financial statements</li>
                    <li><strong>Section 404:</strong> Management assessment of internal controls; requires IT controls audit for systems supporting financial reporting</li>
                    <li><strong>Section 802:</strong> Criminal penalties for altering documents; mandates record retention for 7 years</li>
                </ul>
                <p><strong>SOC Requirements:</strong></p>
                <ul>
                    <li>Monitor access to financial systems (ERP, accounting software, databases)</li>
                    <li>Detect unauthorized changes to financial data</li>
                    <li>Maintain audit logs for financial systems for 7 years</li>
                    <li>Alert on privilege escalation or administrative changes to financial applications</li>
                </ul>
                
                <h5>4. GDPR (General Data Protection Regulation)</h5>
                <p><strong>Scope:</strong> Organizations processing personal data of EU residents, regardless of organization location</p>
                <ul>
                    <li><strong>Article 33:</strong> Breach notification to supervisory authority within 72 hours of becoming aware</li>
                    <li><strong>Article 34:</strong> Notify affected individuals "without undue delay" if breach poses high risk to rights and freedoms</li>
                    <li><strong>Article 32:</strong> Implement appropriate technical and organizational measures (encryption, access controls, monitoring)</li>
                    <li><strong>Fines:</strong> Up to ‚Ç¨20 million or 4% of global annual revenue (whichever is higher) for non-compliance</li>
                </ul>
                <p><strong>SOC Impact:</strong> 72-hour notification clock starts when organization "becomes aware" of breach; SOC detection timestamp may determine compliance; detailed forensic report required</p>
                
                <h5>5. FISMA (Federal Information Security Management Act)</h5>
                <p><strong>Scope:</strong> U.S. federal agencies and contractors handling federal information systems</p>
                <ul>
                    <li><strong>NIST 800-53 Controls:</strong> Comprehensive set of security and privacy controls
                        <ul>
                            <li>AU-2: Audit Events (what to log)</li>
                            <li>AU-3: Content of Audit Records (what details to capture)</li>
                            <li>AU-6: Audit Review, Analysis, and Reporting (SIEM function)</li>
                            <li>IR-4: Incident Handling (incident response procedures)</li>
                            <li>IR-6: Incident Reporting (reporting to US-CERT within 1 hour for major incidents)</li>
                        </ul>
                    </li>
                    <li><strong>Continuous Monitoring:</strong> Ongoing assessment of security controls; SIEM provides evidence of control effectiveness</li>
                </ul>
                
                <h4>SOC Compliance Responsibilities</h4>
                
                <h5>Pre-Incident Compliance Activities</h5>
                <ul>
                    <li><strong>Log Collection Validation:</strong> Verify all required systems sending logs to SIEM per compliance requirements</li>
                    <li><strong>Retention Policy Enforcement:</strong> Ensure log retention meets most stringent applicable regulation (typically 7 years for SOX)</li>
                    <li><strong>Access Control Monitoring:</strong> Alert on privileged access to systems containing regulated data</li>
                    <li><strong>Detection Rule Mapping:</strong> Map detection rules to compliance requirements (PCI DSS 11.5, HIPAA ¬ß164.312(b))</li>
                    <li><strong>Regular Audit Support:</strong> Provide SIEM logs and reports to auditors; demonstrate alert review and incident response</li>
                </ul>
                
                <h5>Incident Response Compliance Considerations</h5>
                <ul>
                    <li><strong>Data Classification:</strong> Immediately determine if incident involves regulated data (PII, PHI, PCI, financial)</li>
                    <li><strong>Notification Triggers:</strong> Understand when breach notification is required:
                        <ul>
                            <li>Was regulated data accessed? (not just "potentially accessible")</li>
                            <li>Was data exfiltrated or copied?</li>
                            <li>Is data encrypted? (may exempt from notification)</li>
                            <li>How many records affected? (determines notification scope)</li>
                        </ul>
                    </li>
                    <li><strong>Legal Coordination:</strong> Engage legal counsel immediately for potential breaches; attorney-client privilege may protect communications</li>
                    <li><strong>Evidence Preservation:</strong> Forensic evidence must meet legal standards:
                        <ul>
                            <li>Chain of custody documentation</li>
                            <li>Write-blocked forensic imaging</li>
                            <li>Hash verification of evidence integrity</li>
                            <li>Timestamped audit trail of who accessed evidence</li>
                        </ul>
                    </li>
                </ul>
                
                <h5>Post-Incident Compliance Requirements</h5>
                <ul>
                    <li><strong>Regulatory Notifications:</strong> File required breach notifications with specific regulatory bodies:
                        <ul>
                            <li>PCI DSS: Acquiring bank, card brands</li>
                            <li>HIPAA: HHS Office for Civil Rights</li>
                            <li>GDPR: Relevant EU Data Protection Authority</li>
                            <li>State Laws: Attorneys General, affected residents</li>
                        </ul>
                    </li>
                    <li><strong>Detailed Reporting:</strong> Regulatory reports must include:
                        <ul>
                            <li>Nature of breach (attack vector, compromised data types)</li>
                            <li>Approximate number of records affected</li>
                            <li>Date of breach and date discovered</li>
                            <li>Remediation steps taken</li>
                            <li>Contact information for affected individuals to inquire</li>
                        </ul>
                    </li>
                    <li><strong>Audit Trail:</strong> Maintain complete investigation documentation for potential regulatory examination</li>
                </ul>
                
                <h4>Common Compliance Pitfalls</h4>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Pitfall</th>
                                <th>Impact</th>
                                <th>Prevention</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Insufficient Log Retention</strong></td>
                                <td>Cannot investigate historical incidents; audit failures; regulatory fines</td>
                                <td>Implement automated lifecycle management; archive to cold storage</td>
                            </tr>
                            <tr>
                                <td><strong>Delayed Breach Notification</strong></td>
                                <td>Regulatory penalties (GDPR 72-hour deadline); reputational damage</td>
                                <td>Clear escalation procedures; legal pre-engaged; notification templates ready</td>
                            </tr>
                            <tr>
                                <td><strong>Inadequate Evidence Preservation</strong></td>
                                <td>Evidence inadmissible in legal proceedings; cannot determine breach scope</td>
                                <td>Forensic imaging before remediation; chain of custody procedures; write-blockers</td>
                            </tr>
                            <tr>
                                <td><strong>Missing Log Sources</strong></td>
                                <td>Cannot prove/disprove data access; breach notification uncertainty</td>
                                <td>Regular log source validation; automated health checks; compliance mapping</td>
                            </tr>
                            <tr>
                                <td><strong>Poor Incident Documentation</strong></td>
                                <td>Regulatory questions unanswered; inconsistent reporting; audit failures</td>
                                <td>Standardized incident templates; real-time documentation; post-incident review</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Legal Privilege Consideration:</strong> Early legal engagement can protect incident response communications under attorney-client privilege. Consult legal counsel before declaring an incident a "breach" in written communications. Use "security incident under investigation" language until legal assessment complete. Never speculate about breach scope in writing without legal review.
                </div>
                
                <h3>Academic and Industry Frameworks</h3>
                <p>Effective SOC operations rely on structured frameworks that provide standardized methodologies for incident handling, security controls, and continuous improvement.</p>
                
                <h4>NIST Cybersecurity Framework</h4>
                <p>The National Institute of Standards and Technology (NIST) Cybersecurity Framework provides a risk-based approach to managing cybersecurity:</p>
                <ul>
                    <li><strong>Identify:</strong> Asset inventory, risk assessment, threat intelligence integration. <em>SOC Application:</em> Maintain asset database; correlate logs with asset criticality</li>
                    <li><strong>Protect:</strong> Access control, awareness training, data security. <em>SOC Application:</em> Monitor authentication logs; detect privilege escalation</li>
                    <li><strong>Detect:</strong> Anomaly detection, continuous monitoring, detection processes. <em>SOC Application:</em> SIEM deployment; analytics rule development; threat hunting</li>
                    <li><strong>Respond:</strong> Response planning, communications, analysis, mitigation. <em>SOC Application:</em> Incident playbooks; SOAR automation; stakeholder notifications</li>
                    <li><strong>Recover:</strong> Recovery planning, improvements, communications. <em>SOC Application:</em> Post-incident reviews; detection gap analysis; lessons learned</li>
                </ul>
                
                <h4>NIST SP 800-61: Incident Response Lifecycle</h4>
                <p>NIST Special Publication 800-61 defines the incident response lifecycle adopted by SOC teams globally:</p>
                <ol>
                    <li><strong>Preparation:</strong> Develop IR plan, train staff, deploy monitoring tools, establish communication channels</li>
                    <li><strong>Detection & Analysis:</strong> Monitor alerts, analyze indicators, determine incident scope and severity, document findings</li>
                    <li><strong>Containment, Eradication & Recovery:</strong> Isolate affected systems, remove malicious artifacts, restore operations, validate remediation</li>
                    <li><strong>Post-Incident Activity:</strong> Lessons learned meeting, update detection rules, improve processes, update documentation</li>
                </ol>
                
                <h4>ISO/IEC 27001: Information Security Management</h4>
                <p>ISO 27001 provides requirements for establishing, implementing, and maintaining an Information Security Management System (ISMS):</p>
                <ul>
                    <li><strong>Control A.12.4:</strong> Logging and monitoring - requires security event logging and protection of log information</li>
                    <li><strong>Control A.16:</strong> Information security incident management - defines incident reporting, assessment, and response procedures</li>
                    <li><strong>Control A.18:</strong> Compliance - mandates log retention for legal and regulatory requirements</li>
                </ul>
                <p><strong>SOC Alignment:</strong> SIEM systems support ISO 27001 compliance by providing centralized logging, tamper-evident storage, and audit trail capabilities.</p>
                
                <h4>MITRE ATT&CK Framework</h4>
                <p>A globally-accessible knowledge base of adversary tactics and techniques based on real-world observations:</p>
                <ul>
                    <li><strong>14 Tactics:</strong> Reconnaissance, Resource Development, Initial Access, Execution, Persistence, Privilege Escalation, Defense Evasion, Credential Access, Discovery, Lateral Movement, Collection, Command & Control, Exfiltration, Impact</li>
                    <li><strong>Detection Coverage:</strong> Map SIEM detection rules to ATT&CK techniques; identify coverage gaps using ATT&CK Navigator</li>
                    <li><strong>Threat Intelligence:</strong> Correlate incident findings with known threat actor TTPs (Tactics, Techniques, Procedures)</li>
                    <li><strong>Hypothesis Generation:</strong> Use ATT&CK to develop threat hunting hypotheses</li>
                </ul>
                
                <h3>Investigation Methodology</h3>
                <p>Systematic investigation methodology ensures consistency, thoroughness, and defensibility of findings.</p>
                
                <h4>Structured Investigation Process</h4>
                <ol>
                    <li><strong>Initial Triage (5-15 minutes):</strong> 
                        <ul>
                            <li>Review alert details: severity, affected assets, indicators of compromise (IOCs)</li>
                            <li>Assess alert fidelity: Is this a true positive, false positive, or benign positive?</li>
                            <li>Determine urgency: Is the threat active? Is data at risk? Are critical assets affected?</li>
                            <li>Assign incident owner and set initial severity based on CVSS or organizational matrix</li>
                        </ul>
                    </li>
                    <li><strong>Data Collection (15-30 minutes):</strong>
                        <ul>
                            <li>Identify relevant log sources: Firewall, proxy, EDR, authentication, application logs</li>
                            <li>Define investigation timeframe: Alert timestamp ¬± appropriate window (1h for targeted attack, 24h for data exfiltration)</li>
                            <li>Gather endpoint data: Process trees, network connections, file system changes, registry modifications (Windows)</li>
                            <li>Collect threat intelligence: IP/domain/hash reputation, known malware families, related campaigns</li>
                        </ul>
                    </li>
                    <li><strong>Timeline Creation (20-40 minutes):</strong>
                        <ul>
                            <li>Build chronological event sequence using SIEM correlation or manual analysis</li>
                            <li>Identify initial access vector: Phishing email, exploit, stolen credentials, insider threat</li>
                            <li>Map attacker progression: Execution ‚Üí Persistence ‚Üí Privilege Escalation ‚Üí Lateral Movement ‚Üí Objective</li>
                            <li>Note key timestamps: First observed activity, privilege escalation, data access, exfiltration</li>
                        </ul>
                    </li>
                    <li><strong>Correlation Analysis (30-60 minutes):</strong>
                        <ul>
                            <li>Correlate events across data sources: Match authentication logs with network connections with process execution</li>
                            <li>Identify affected systems: Search for IOCs (IP addresses, file hashes, domains) across all log sources</li>
                            <li>Determine scope: How many users? How many systems? What data was accessed?</li>
                            <li>Assess lateral movement: Did attacker pivot to additional systems? Which accounts were used?</li>
                        </ul>
                    </li>
                    <li><strong>Root Cause Analysis (30-60 minutes):</strong>
                        <ul>
                            <li>Identify vulnerability exploited: Unpatched software, weak password, misconfiguration, social engineering</li>
                            <li>Determine why detection was delayed: Detection gap, tuning issue, alert fatigue</li>
                            <li>Assess control failures: Which security controls failed to prevent or detect? Why?</li>
                            <li>Document lessons learned: What should have detected this earlier? What processes failed?</li>
                        </ul>
                    </li>
                    <li><strong>Containment (Variable - immediate to hours):</strong>
                        <ul>
                            <li>Short-term containment: Isolate infected systems, disable compromised accounts, block malicious IPs/domains</li>
                            <li>Long-term containment: Patch vulnerabilities, strengthen authentication, update firewall rules</li>
                            <li>Evidence preservation: Create forensic images before remediation; preserve logs and memory dumps</li>
                            <li>Business continuity: Coordinate with business units to minimize operational impact</li>
                        </ul>
                    </li>
                    <li><strong>Documentation (Ongoing throughout investigation):</strong>
                        <ul>
                            <li>Maintain detailed incident log: All queries executed, findings, actions taken, timestamps</li>
                            <li>Screenshot critical evidence: Alert details, query results, investigation graph</li>
                            <li>Record communications: Stakeholder notifications, approvals for containment actions</li>
                            <li>Document chain of custody: Who accessed what evidence, when, and why</li>
                        </ul>
                    </li>
                    <li><strong>Post-Incident Review (1-2 hours, scheduled within 1 week):</strong>
                        <ul>
                            <li>Conduct lessons learned meeting with SOC team and stakeholders</li>
                            <li>Review timeline: What happened, when, how was it detected, how was it contained</li>
                            <li>Identify improvements: Detection rules, playbooks, training, technical controls</li>
                            <li>Update documentation: Runbooks, detection logic, IOC lists, threat intelligence</li>
                            <li>Implement preventive measures: Deploy missing controls, patch systems, update policies</li>
                        </ul>
                    </li>
                </ol>
                
                <div class="important">
                    <strong>‚ö†Ô∏è Investigation Priorities:</strong> Prioritize incidents using a risk matrix combining:
                    <ul>
                        <li><strong>Asset Criticality:</strong> Production systems > Development systems > Test systems</li>
                        <li><strong>Data Sensitivity:</strong> Customer PII > Internal confidential > Public information</li>
                        <li><strong>Attack Stage:</strong> Active C2 > Persistence established > Initial reconnaissance</li>
                        <li><strong>Potential Impact:</strong> Ransomware > Data exfiltration > Defacement > Scanning</li>
                    </ul>
                    <strong>Critical incidents (High severity + Critical asset):</strong> Immediate escalation to incident commander; executive notification within 1 hour.
                </div>


                <h4>Universal Query Optimization Principles</h4>
                <ul>
                    <li><strong>Time Filtering First:</strong> Always start with time range filters; indexed timestamp fields are the fastest search criteria. Place time filters at beginning of query (Splunk earliest=/latest=, Elastic range query, KQL TimeGenerated filter)</li>
                    <li><strong>Use Indexed Fields:</strong> Search on indexed fields (Splunk: source, sourcetype, host; Elastic: .keyword fields; Sentinel: specific columns). Avoid full-text search when structured field search is available</li>
                    <li><strong>Limit Result Sets:</strong> Use head/limit commands during query development to test logic without processing millions of events. Expand limits only after validating query logic</li>
                    <li><strong>Minimize Subsearches:</strong> Subsearches are expensive; use joins or lookups instead. If subsearch is necessary, ensure it returns minimal results (< 10,000 records)</li>
                    <li><strong>Statistical Commands Over Raw Data:</strong> Use stats, chart, timechart (Splunk); aggregations (Elastic); summarize (KQL) instead of returning raw events. Aggregated data is exponentially smaller</li>
                    <li><strong>Field Extraction Efficiency:</strong> Extract fields once using | eval or | extend, then reuse. Avoid redundant rex/parse operations</li>
                    <li><strong>Filter Before Aggregation:</strong> Apply where clauses before summarize/stats operations to reduce dataset size</li>
                    <li><strong>Lookup Tables for Enrichment:</strong> Pre-load threat intelligence, asset inventory into lookup tables rather than querying external sources repeatedly</li>
                </ul>
                
                <h4>Platform-Specific Optimization</h4>
                <ul>
                    <li><strong>Splunk:</strong> Use tstats for accelerated data models (100x faster); leverage summary indexing for frequent historical queries; disable auto-finalization in searches with transforming commands</li>
                    <li><strong>Elasticsearch:</strong> Use filter context (cached) vs query context; specify .keyword suffix for aggregations; implement index lifecycle management (hot-warm-cold); use _routing for multi-tenant environments</li>
                    <li><strong>Sentinel/KQL:</strong> Place TimeGenerated filter first; use "has" instead of "contains"; project before summarize; leverage materialized views for frequently accessed aggregations</li>
                </ul>

                <h3>Alert Creation and Management</h3>
                <p>High-quality alerts minimize false positives while ensuring true threats are detected and escalated appropriately.</p>
                
                <h4>Alert Design Principles</h4>
                <div class="important">
                    <strong>‚ö†Ô∏è The Alert Fatigue Problem:</strong> Poorly configured alerts lead to desensitization where analysts ignore or dismiss alerts without proper investigation. Industry studies show SOC teams with >50 alerts/day per analyst experience 30-50% false positive rates and increased incident response times. Focus on high-fidelity detections over alert volume.
                </div>
                
                <h4>SMART Alert Criteria</h4>
                <ul>
                    <li><strong>Specific:</strong> Alert describes precise behavior (e.g., "5 failed logins from same IP in 10 minutes" vs "authentication failure"). Include relevant context: username, source IP, affected system</li>
                    <li><strong>Measurable:</strong> Use quantifiable thresholds based on baseline (e.g., "outbound traffic > 1GB in 1 hour" requires baseline establishment)</li>
                    <li><strong>Achievable:</strong> Set thresholds that are realistic to investigate; avoid alerts triggering thousands of times per day</li>
                    <li><strong>Relevant:</strong> Align detections to organizational threat model and risk appetite; prioritize critical assets and sensitive data</li>
                    <li><strong>Time-bound:</strong> Include appropriate time windows for correlation (too short misses campaigns; too long creates noise)</li>
                </ul>
                
                <h4>Alert Lifecycle Management</h4>
                <ol>
                    <li><strong>Development Phase:</strong>
                        <ul>
                            <li>Research attack technique using MITRE ATT&CK; understand detection logic and evasion possibilities</li>
                            <li>Develop query in SIEM search interface; test against historical data (last 30 days)</li>
                            <li>Identify false positives: Legitimate processes that trigger detection; document exclusion criteria</li>
                            <li>Set initial threshold conservatively (high confidence, lower sensitivity); adjust after monitoring</li>
                        </ul>
                    </li>
                    <li><strong>Testing Phase:</strong>
                        <ul>
                            <li>Deploy in "test" or "audit" mode without generating incidents; monitor for 1-2 weeks</li>
                            <li>Review all triggered alerts: Calculate true positive rate (TP / (TP + FP)); aim for >80%</li>
                            <li>Tune thresholds and exclusions: Add whitelists for service accounts, maintenance windows, approved tools</li>
                            <li>Validate alert enrichment: Ensure entity mapping, context fields, and alert descriptions are accurate</li>
                        </ul>
                    </li>
                    <li><strong>Production Phase:</strong>
                        <ul>
                            <li>Enable alert with appropriate severity and priority</li>
                            <li>Configure suppression/grouping: Prevent duplicate alerts for same incident</li>
                            <li>Set up automated response: SOAR playbooks for enrichment or containment</li>
                            <li>Define escalation path: When to escalate to Tier 2, incident commander, or management</li>
                        </ul>
                    </li>
                    <li><strong>Maintenance Phase:</strong>
                        <ul>
                            <li>Monthly review: Analyze alert volume, true positive rate, mean time to respond (MTTR)</li>
                            <li>Quarterly tuning: Adjust thresholds based on environmental changes, new applications, business initiatives</li>
                            <li>Annual validation: Verify detection logic still aligns with current threat landscape and organizational risks</li>
                            <li>Deprecation: Disable alerts with consistently <20% true positive rate or no longer relevant threats</li>
                        </ul>
                    </li>
                </ol>
                
                <h4>Alert Severity Classification</h4>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Severity</th>
                                <th>Definition</th>
                                <th>Response Time</th>
                                <th>Examples</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Critical</strong></td>
                                <td>Active breach with data loss or system compromise</td>
                                <td>Immediate (< 15 min)</td>
                                <td>Ransomware encryption, active C2, data exfiltration in progress</td>
                            </tr>
                            <tr>
                                <td><strong>High</strong></td>
                                <td>Successful compromise or high-confidence malicious activity</td>
                                <td>< 1 hour</td>
                                <td>Confirmed malware, privilege escalation, lateral movement</td>
                            </tr>
                            <tr>
                                <td><strong>Medium</strong></td>
                                <td>Suspicious activity requiring investigation</td>
                                <td>< 4 hours</td>
                                <td>Brute force attempts, policy violations, reconnaissance</td>
                            </tr>
                            <tr>
                                <td><strong>Low</strong></td>
                                <td>Informational or low-risk events</td>
                                <td>< 24 hours</td>
                                <td>Scanning activity, failed login single occurrence, certificate expiration</td>
                            </tr>
                            <tr>
                                <td><strong>Informational</strong></td>
                                <td>Notable events without immediate security impact</td>
                                <td>Periodic review</td>
                                <td>New user creation, configuration changes, audit events</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>Log Retention and Compliance</h3>
                <p>Balancing compliance requirements, investigative needs, and storage costs.</p>
                
                <h4>Regulatory Retention Requirements</h4>
                <ul>
                    <li><strong>PCI DSS:</strong> 3 months online, 1 year archived (for systems processing cardholder data)</li>
                    <li><strong>HIPAA:</strong> 6 years minimum (healthcare data access logs)</li>
                    <li><strong>SOX:</strong> 7 years (financial systems audit trails)</li>
                    <li><strong>GDPR:</strong> No specific requirement; must be "appropriate" based on risk and justified by legitimate purpose</li>
                    <li><strong>FISMA:</strong> Varies by system classification; typically 3-7 years</li>
                </ul>
                
                <h4>Tiered Storage Strategy</h4>
                <ol>
                    <li><strong>Hot Storage (Online, searchable):</strong> 30-90 days
                        <ul>
                            <li>Fast SSD/NVMe storage; full indexing; real-time search capability</li>
                            <li>Most expensive; use for active investigations and recent alerts</li>
                        </ul>
                    </li>
                    <li><strong>Warm Storage (Online, slower search):</strong> 90 days - 1 year
                        <ul>
                            <li>HDD storage; reduced indexing; acceptable query performance</li>
                            <li>Medium cost; sufficient for most investigations and historical analysis</li>
                        </ul>
                    </li>
                    <li><strong>Cold Storage (Archived, restore required):</strong> 1-7 years
                        <ul>
                            <li>Object storage (S3, Azure Blob); compressed; requires restore to search</li>
                            <li>Low cost; compliance-driven retention; rarely accessed</li>
                        </ul>
                    </li>
                </ol>
                
                <h4>Data Management Best Practices</h4>
                <ul>
                    <li><strong>Index Lifecycle Management:</strong> Automate data movement between hot/warm/cold tiers based on age</li>
                    <li><strong>Selective Retention:</strong> Retain critical logs (authentication, privileged access, data access) longer than verbose logs (debug, informational)</li>
                    <li><strong>Compression:</strong> Compress archived logs (gzip, ZSTD) for 70-90% space savings</li>
                    <li><strong>Restore Testing:</strong> Quarterly test log restoration from cold storage to verify integrity and accessibility</li>
                    <li><strong>Legal Hold:</strong> Implement legal hold procedures to preserve logs beyond standard retention for litigation or investigations</li>
                    <li><strong>Pipeline Monitoring:</strong> Alert on ingestion failures, parsing errors, and connector outages</li>
                </ul>

                <h3>Continuous Improvement and Professional Development</h3>
                <p>SOC excellence requires ongoing learning, adaptation to evolving threats, and process refinement.</p>
                
                <h4>Threat Intelligence Integration</h4>
                <ul>
                    <li><strong>Open Source Intelligence (OSINT):</strong> Subscribe to threat feeds (AlienVault OTX, MISP, abuse.ch); automate IOC ingestion into SIEM</li>
                    <li><strong>Commercial Intelligence:</strong> Evaluate vendors (Recorded Future, Mandiant, CrowdStrike Intelligence) for industry-specific threat reporting</li>
                    <li><strong>Information Sharing:</strong> Participate in ISACs (Information Sharing and Analysis Centers) relevant to your sector</li>
                    <li><strong>Threat Hunting:</strong> Proactively search for threats using intelligence-driven hypotheses; dedicate 20% of SOC time to hunting</li>
                </ul>
                
                <h4>Detection Engineering Maturity</h4>
                <ol>
                    <li><strong>Level 1 - Reactive:</strong> Rely on vendor-provided rules; minimal customization; high false positive rates</li>
                    <li><strong>Level 2 - Proactive:</strong> Tuning vendor rules; creating custom detections for organization-specific threats</li>
                    <li><strong>Level 3 - Advanced:</strong> Behavior-based analytics; UEBA deployment; correlation rules across multiple data sources</li>
                    <li><strong>Level 4 - Predictive:</strong> Machine learning for anomaly detection; automated threat hunting; predictive risk scoring</li>
                    <li><strong>Level 5 - Autonomous:</strong> AI-driven detection; autonomous response; continuous learning from analyst feedback</li>
                </ol>
                
                <h4>SOC Metrics and KPIs</h4>
                <ul>
                    <li><strong>Mean Time to Detect (MTTD):</strong> Time from attack initiation to alert generation; goal <1 hour for critical threats</li>
                    <li><strong>Mean Time to Respond (MTTR):</strong> Time from alert to containment; goal <1 hour for critical incidents</li>
                    <li><strong>True Positive Rate:</strong> Percentage of alerts representing actual threats; goal >80%</li>
                    <li><strong>Alert Volume:</strong> Total alerts per day; monitor trends to identify tuning needs</li>
                    <li><strong>Coverage Percentage:</strong> MITRE ATT&CK techniques with active detection; goal >70% of applicable techniques</li>
                    <li><strong>Escalation Rate:</strong> Percentage of Tier 1 alerts escalated to Tier 2; indicates appropriate triaging</li>
                    <li><strong>Incident Closure Rate:</strong> Percentage of incidents fully remediated within SLA; goal >95%</li>
                </ul>
                
                <h4>Training and Skills Development</h4>
                <ul>
                    <li><strong>Certifications:</strong> GIAC GCIA (Intrusion Analyst), GCIH (Incident Handler), SEC555 (SIEM), SANS FOR508 (Forensics)</li>
                    <li><strong>Hands-On Labs:</strong> BOTS (Boss of the SOC), CTF competitions, TryHackMe, HackTheBox, CyberDefenders</li>
                    <li><strong>Purple Team Exercises:</strong> Collaborate with red team to validate detection coverage; identify blind spots</li>
                    <li><strong>Tabletop Exercises:</strong> Simulate incident scenarios (ransomware, data breach) to practice response procedures</li>
                    <li><strong>Knowledge Sharing:</strong> Weekly team case reviews; internal wiki for runbooks and lessons learned; mentorship programs</li>
                    <li><strong>Vendor Training:</strong> Deep-dive training on SIEM platform features, EDR capabilities, SOAR playbook development</li>
                    <li><strong>Community Engagement:</strong> Attend conferences (RSA, Black Hat, BSides); participate in forums (r/AskNetsec, SANS Internet Storm Center)</li>
                </ul>

                <h3>Essential Tools and Resources</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Tool/Resource</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>MITRE ATT&amp;CK Framework</td>
                                <td>Threat intelligence and attack patterns</td>
                            </tr>
                            <tr>
                                <td>Sigma Rules</td>
                                <td>Generic signature format for SIEM systems</td>
                            </tr>
                            <tr>
                                <td>CyberChef</td>
                                <td>Data decoding and analysis</td>
                            </tr>
                            <tr>
                                <td>VirusTotal</td>
                                <td>File and URL reputation checking</td>
                            </tr>
                            <tr>
                                <td>AbuseIPDB</td>
                                <td>IP reputation database</td>
                            </tr>
                            <tr>
                                <td>AlienVault OTX</td>
                                <td>Open threat intelligence platform</td>
                            </tr>
                            <tr>
                                <td>Regex101</td>
                                <td>Regular expression testing and debugging</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>Common Indicators of Compromise (IOCs)</h3>
                <ul>
                    <li><strong>Authentication:</strong> Multiple failed logins, logins from unusual locations, logins outside business hours</li>
                    <li><strong>Network:</strong> Unusual outbound traffic, connections to known malicious IPs, DNS tunneling</li>
                    <li><strong>Process:</strong> Suspicious process names, encoded PowerShell commands, privilege escalation</li>
                    <li><strong>File System:</strong> Unauthorized file modifications, creation of suspicious files, changes to system files</li>
                    <li><strong>Web:</strong> SQL injection attempts, directory traversal, unusual user agents, brute force attacks</li>
                </ul>

                <div class="tip">
                    <strong>üí° Pro Tip:</strong> Create a personal cheatsheet with queries specific to your environment and 
                    regularly used commands. This will significantly speed up your investigation process.
                </div>
            </div>
            </div>
        </div>

        <div class="footer">
            <p>&copy; 2026 SOC Analyst Guide | Transport and Telecommunication Institute - Riga, Latvia</p>
            <p>Created by: st93642@students.tsi.lv | <a href="https://tsi.lv" style="color: #3498db;">https://tsi.lv</a></p>
        </div>
    </div>

    <script>
        // Scroll Spy - Highlight active section in navigation
        function updateActiveNavigation() {
            const sections = document.querySelectorAll('.section[id]');
            const navLinks = document.querySelectorAll('.nav-btn');
            
            let currentSection = '';
            const scrollPosition = window.scrollY + 100; // Offset for better UX
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.offsetHeight;
                
                if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                    currentSection = section.getAttribute('id');
                }
            });
            
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + currentSection) {
                    link.classList.add('active');
                }
            });
        }

        // Mobile menu auto-close on link click
        function setupMobileMenuClose() {
            const navLinks = document.querySelectorAll('.nav-btn');
            const sidebar = document.querySelector('.sidebar');
            
            navLinks.forEach(link => {
                link.addEventListener('click', () => {
                    // On mobile, close the menu after clicking a link
                    if (window.innerWidth <= 768) {
                        sidebar.classList.remove('open');
                    }
                });
            });
        }

        // Smooth scroll with offset for sections under header
        function setupSmoothScroll() {
            const navLinks = document.querySelectorAll('.nav-btn');
            
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    const targetId = this.getAttribute('href');
                    if (targetId && targetId.startsWith('#')) {
                        const targetSection = document.querySelector(targetId);
                        if (targetSection) {
                            e.preventDefault();
                            const offsetTop = targetSection.offsetTop - 20; // Small offset from top
                            window.scrollTo({
                                top: offsetTop,
                                behavior: 'smooth'
                            });
                            // Update URL without jumping
                            history.pushState(null, null, targetId);
                        }
                    }
                });
            });
        }

        // Initialize all functionality
        document.addEventListener('DOMContentLoaded', function() {
            updateActiveNavigation();
            setupMobileMenuClose();
            setupSmoothScroll();
            
            // Update active navigation on scroll
            let scrollTimeout;
            window.addEventListener('scroll', function() {
                if (scrollTimeout) {
                    clearTimeout(scrollTimeout);
                }
                scrollTimeout = setTimeout(updateActiveNavigation, 50); // Throttle for performance
            });
            
            // Set initial active state based on URL hash
            if (window.location.hash) {
                const targetLink = document.querySelector(`.nav-btn[href="${window.location.hash}"]`);
                if (targetLink) {
                    targetLink.classList.add('active');
                }
            }
        });
    </script>
</body>
</html>
